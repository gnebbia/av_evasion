<!DOCTYPE html>
<html class="v2" dir="ltr" lang="en"><head>
<link href="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/3416767676-css_bundle_v2.css" rel="stylesheet" type="text/css">
<meta content="width=1100" name="viewport">
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<meta content="blogger" name="generator">
<link href="http://304geeks.blogspot.com/favicon.ico" rel="icon" type="image/x-icon">
<link href="http://304geeks.blogspot.com/2013/01/dns-scraping-for-corporate-av-detection.html" rel="canonical">
<link rel="alternate" type="application/atom+xml" title="The 304Geeks - Atom" href="http://304geeks.blogspot.com/feeds/posts/default">
<link rel="alternate" type="application/rss+xml" title="The 304Geeks - RSS" href="http://304geeks.blogspot.com/feeds/posts/default?alt=rss">
<link rel="service.post" type="application/atom+xml" title="The 304Geeks - Atom" href="https://www.blogger.com/feeds/8471498366300003116/posts/default">

<link rel="alternate" type="application/atom+xml" title="The 304Geeks - Atom" href="http://304geeks.blogspot.com/feeds/3369908487569789446/comments/default">
<!--[if IE]><script type="text/javascript" src="https://www.blogger.com/static/v1/jsbin/4244862144-ieretrofit.js"></script>
<![endif]-->
<link href="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/update_list.png" rel="image_src">
<meta content="http://304geeks.blogspot.com/2013/01/dns-scraping-for-corporate-av-detection.html" property="og:url">
<meta content="[UPDATED] DNS Scraping for Corporate AV Detection - &quot;Admins, stop sharing your cache with everyone!&quot;" property="og:title">
<meta content="NEW TOOL: Scrape-DNS   **Since this was first posted the technique has been implemented into&nbsp; Metasploit &nbsp;(which means it's on Kali Linux),&nbsp;..." property="og:description">
<meta content="http://2.bp.blogspot.com/-vpC9XhWXFJ8/UPRxJPtuklI/AAAAAAAAAeA/ZTCSeA6fQ5w/w1200-h630-p-k-no-nu/update_list.png" property="og:image">
<!--[if IE]> <script> (function() { var html5 = ("abbr,article,aside,audio,canvas,datalist,details," + "figure,footer,header,hgroup,mark,menu,meter,nav,output," + "progress,section,time,video").split(','); for (var i = 0; i < html5.length; i++) { document.createElement(html5[i]); } try { document.execCommand('BackgroundImageCache', false, true); } catch(e) {} })(); </script> <![endif]-->
<title>The 304Geeks: [UPDATED] DNS Scraping for Corporate AV Detection - "Admins, stop sharing your cache with everyone!"</title>
<style id="page-skin-1" type="text/css"><!--
/*
-----------------------------------------------
Blogger Template Style
Name:     Simple
Designer: Blogger
URL:      www.blogger.com
----------------------------------------------- */
/* Content
----------------------------------------------- */
body {
font: normal normal 12px 'Trebuchet MS', Trebuchet, Verdana, sans-serif;
color: #666666;
background: #ffffff none repeat scroll top left;
padding: 0 0 0 0;
}
html body .region-inner {
min-width: 0;
max-width: 100%;
width: auto;
}
h2 {
font-size: 22px;
}
a:link {
text-decoration:none;
color: #2288bb;
}
a:visited {
text-decoration:none;
color: #888888;
}
a:hover {
text-decoration:underline;
color: #33aaff;
}
.body-fauxcolumn-outer .fauxcolumn-inner {
background: transparent none repeat scroll top left;
_background-image: none;
}
.body-fauxcolumn-outer .cap-top {
position: absolute;
z-index: 1;
height: 400px;
width: 100%;
}
.body-fauxcolumn-outer .cap-top .cap-left {
width: 100%;
background: transparent none repeat-x scroll top left;
_background-image: none;
}
.content-outer {
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .15);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .15);
-goog-ms-box-shadow: 0 0 0 #333333;
box-shadow: 0 0 0 rgba(0, 0, 0, .15);
margin-bottom: 1px;
}
.content-inner {
padding: 10px 40px;
}
.content-inner {
background-color: #ffffff;
}
/* Header
----------------------------------------------- */
.header-outer {
background: transparent none repeat-x scroll 0 -400px;
_background-image: none;
}
.Header h1 {
font: normal normal 40px 'Trebuchet MS',Trebuchet,Verdana,sans-serif;
color: #000000;
text-shadow: 0 0 0 rgba(0, 0, 0, .2);
}
.Header h1 a {
color: #000000;
}
.Header .description {
font-size: 18px;
color: #000000;
}
.header-inner .Header .titlewrapper {
padding: 22px 0;
}
.header-inner .Header .descriptionwrapper {
padding: 0 0;
}
/* Tabs
----------------------------------------------- */
.tabs-inner .section:first-child {
border-top: 0 solid #dddddd;
}
.tabs-inner .section:first-child ul {
margin-top: -1px;
border-top: 1px solid #dddddd;
border-left: 1px solid #dddddd;
border-right: 1px solid #dddddd;
}
.tabs-inner .widget ul {
background: transparent none repeat-x scroll 0 -800px;
_background-image: none;
border-bottom: 1px solid #dddddd;
margin-top: 0;
margin-left: -30px;
margin-right: -30px;
}
.tabs-inner .widget li a {
display: inline-block;
padding: .6em 1em;
font: normal normal 12px 'Trebuchet MS', Trebuchet, Verdana, sans-serif;
color: #000000;
border-left: 1px solid #ffffff;
border-right: 1px solid #dddddd;
}
.tabs-inner .widget li:first-child a {
border-left: none;
}
.tabs-inner .widget li.selected a, .tabs-inner .widget li a:hover {
color: #000000;
background-color: #eeeeee;
text-decoration: none;
}
/* Columns
----------------------------------------------- */
.main-outer {
border-top: 0 solid transparent;
}
.fauxcolumn-left-outer .fauxcolumn-inner {
border-right: 1px solid transparent;
}
.fauxcolumn-right-outer .fauxcolumn-inner {
border-left: 1px solid transparent;
}
/* Headings
----------------------------------------------- */
div.widget > h2,
div.widget h2.title {
margin: 0 0 1em 0;
font: normal bold 11px 'Trebuchet MS',Trebuchet,Verdana,sans-serif;
color: #000000;
}
/* Widgets
----------------------------------------------- */
.widget .zippy {
color: #999999;
text-shadow: 2px 2px 1px rgba(0, 0, 0, .1);
}
.widget .popular-posts ul {
list-style: none;
}
/* Posts
----------------------------------------------- */
h2.date-header {
font: normal bold 11px Arial, Tahoma, Helvetica, FreeSans, sans-serif;
}
.date-header span {
background-color: #bbbbbb;
color: #ffffff;
padding: 0.4em;
letter-spacing: 3px;
margin: inherit;
}
.main-inner {
padding-top: 35px;
padding-bottom: 65px;
}
.main-inner .column-center-inner {
padding: 0 0;
}
.main-inner .column-center-inner .section {
margin: 0 1em;
}
.post {
margin: 0 0 45px 0;
}
h3.post-title, .comments h4 {
font: normal normal 22px 'Trebuchet MS',Trebuchet,Verdana,sans-serif;
margin: .75em 0 0;
}
.post-body {
font-size: 110%;
line-height: 1.4;
position: relative;
}
.post-body img, .post-body .tr-caption-container, .Profile img, .Image img,
.BlogList .item-thumbnail img {
padding: 2px;
background: #ffffff;
border: 1px solid #eeeeee;
-moz-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
-webkit-box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
box-shadow: 1px 1px 5px rgba(0, 0, 0, .1);
}
.post-body img, .post-body .tr-caption-container {
padding: 5px;
}
.post-body .tr-caption-container {
color: #666666;
}
.post-body .tr-caption-container img {
padding: 0;
background: transparent;
border: none;
-moz-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
-webkit-box-shadow: 0 0 0 rgba(0, 0, 0, .1);
box-shadow: 0 0 0 rgba(0, 0, 0, .1);
}
.post-header {
margin: 0 0 1.5em;
line-height: 1.6;
font-size: 90%;
}
.post-footer {
margin: 20px -2px 0;
padding: 5px 10px;
color: #666666;
background-color: #eeeeee;
border-bottom: 1px solid #eeeeee;
line-height: 1.6;
font-size: 90%;
}
#comments .comment-author {
padding-top: 1.5em;
border-top: 1px solid transparent;
background-position: 0 1.5em;
}
#comments .comment-author:first-child {
padding-top: 0;
border-top: none;
}
.avatar-image-container {
margin: .2em 0 0;
}
#comments .avatar-image-container img {
border: 1px solid #eeeeee;
}
/* Comments
----------------------------------------------- */
.comments .comments-content .icon.blog-author {
background-repeat: no-repeat;
background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEgAACxIB0t1+/AAAAAd0SU1FB9sLFwMeCjjhcOMAAAD+SURBVDjLtZSvTgNBEIe/WRRnm3U8RC1neQdsm1zSBIU9VVF1FkUguQQsD9ITmD7ECZIJSE4OZo9stoVjC/zc7ky+zH9hXwVwDpTAWWLrgS3QAe8AZgaAJI5zYAmc8r0G4AHYHQKVwII8PZrZFsBFkeRCABYiMh9BRUhnSkPTNCtVXYXURi1FpBDgArj8QU1eVXUzfnjv7yP7kwu1mYrkWlU33vs1QNu2qU8pwN0UpKoqokjWwCztrMuBhEhmh8bD5UDqur75asbcX0BGUB9/HAMB+r32hznJgXy2v0sGLBcyAJ1EK3LFcbo1s91JeLwAbwGYu7TP/3ZGfnXYPgAVNngtqatUNgAAAABJRU5ErkJggg==);
}
.comments .comments-content .loadmore a {
border-top: 1px solid #999999;
border-bottom: 1px solid #999999;
}
.comments .comment-thread.inline-thread {
background-color: #eeeeee;
}
.comments .continue {
border-top: 2px solid #999999;
}
/* Accents
---------------------------------------------- */
.section-columns td.columns-cell {
border-left: 1px solid transparent;
}
.blog-pager {
background: transparent url(//www.blogblog.com/1kt/simple/paging_dot.png) repeat-x scroll top center;
}
.blog-pager-older-link, .home-link,
.blog-pager-newer-link {
background-color: #ffffff;
padding: 5px;
}
.footer-outer {
border-top: 1px dashed #bbbbbb;
}
/* Mobile
----------------------------------------------- */
body.mobile  {
background-size: auto;
}
.mobile .body-fauxcolumn-outer {
background: transparent none repeat scroll top left;
}
.mobile .body-fauxcolumn-outer .cap-top {
background-size: 100% auto;
}
.mobile .content-outer {
-webkit-box-shadow: 0 0 3px rgba(0, 0, 0, .15);
box-shadow: 0 0 3px rgba(0, 0, 0, .15);
}
.mobile .tabs-inner .widget ul {
margin-left: 0;
margin-right: 0;
}
.mobile .post {
margin: 0;
}
.mobile .main-inner .column-center-inner .section {
margin: 0;
}
.mobile .date-header span {
padding: 0.1em 10px;
margin: 0 -10px;
}
.mobile h3.post-title {
margin: 0;
}
.mobile .blog-pager {
background: transparent none no-repeat scroll top center;
}
.mobile .footer-outer {
border-top: none;
}
.mobile .main-inner, .mobile .footer-inner {
background-color: #ffffff;
}
.mobile-index-contents {
color: #666666;
}
.mobile-link-button {
background-color: #2288bb;
}
.mobile-link-button a:link, .mobile-link-button a:visited {
color: #ffffff;
}
.mobile .tabs-inner .section:first-child {
border-top: none;
}
.mobile .tabs-inner .PageList .widget-content {
background-color: #eeeeee;
color: #000000;
border-top: 1px solid #dddddd;
border-bottom: 1px solid #dddddd;
}
.mobile .tabs-inner .PageList .widget-content .pagelist-arrow {
border-left: 1px solid #dddddd;
}

--></style>
<style id="template-skin-1" type="text/css"><!--
body {
min-width: 960px;
}
.content-outer, .content-fauxcolumn-outer, .region-inner {
min-width: 960px;
max-width: 960px;
_width: 960px;
}
.main-inner .columns {
padding-left: 0;
padding-right: 310px;
}
.main-inner .fauxcolumn-center-outer {
left: 0;
right: 310px;
/* IE6 does not respect left and right together */
_width: expression(this.parentNode.offsetWidth -
parseInt("0") -
parseInt("310px") + 'px');
}
.main-inner .fauxcolumn-left-outer {
width: 0;
}
.main-inner .fauxcolumn-right-outer {
width: 310px;
}
.main-inner .column-left-outer {
width: 0;
right: 100%;
margin-left: -0;
}
.main-inner .column-right-outer {
width: 310px;
margin-right: -310px;
}
#layout {
min-width: 0;
}
#layout .content-outer {
min-width: 0;
width: 800px;
}
#layout .region-inner {
min-width: 0;
width: auto;
}
body#layout div.add_widget {
padding: 8px;
}
body#layout div.add_widget a {
margin-left: 32px;
}
--></style>
<link href="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/authorization.css" media="all" onload="if(media!='all')media='all'" rel="stylesheet"><noscript><link href='https://www.blogger.com/dyn-css/authorization.css?targetBlogID=8471498366300003116&amp;zx=dd9d7523-0f18-45d4-8111-4d9e3d5a7601' rel='stylesheet'/></noscript>

<script src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/cbgapi.loaded_3" async=""></script><script src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/cbgapi.loaded_2" async=""></script><script src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/cbgapi.loaded_1" async=""></script><script src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/cbgapi.loaded_0" async=""></script><script type="text/javascript" language="javascript">
  // Supply ads personalization default for EEA readers
  // See https://www.blogger.com/go/adspersonalization
  adsbygoogle = window.adsbygoogle || [];
  if (typeof adsbygoogle.requestNonPersonalizedAds === 'undefined') {
    adsbygoogle.requestNonPersonalizedAds = 1;
  }
</script>


<script type="text/javascript" src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/google_top_exp.js"></script><style>.gc-bubbleDefault{table-layout:auto!important}.gc-bubbleDefault,.gc-reset{background-color:transparent!important;text-align:left;padding:0!important;margin:0!important;border:0!important}.pls-bubbleTop{border-bottom:1px solid #ccc!important}.pls-contentLeft,.pls-topTail,.pls-vertShimLeft{background-image:url(//ssl.gstatic.com/s2/oz/images/stars/po/bubblev1/border_3.gif)!important}.pls-topTail{background-repeat:repeat-x!important;background-position:bottom!important}.pls-vertShim{background-color:#fff!important;text-align:right}.tbl-grey .pls-vertShim{background-color:#f5f5f5!important}.pls-vertShimLeft{background-repeat:repeat-y!important;background-position:100%!important;height:4px}.pls-vertShimRight{height:4px}.pls-confirm-container .pls-vertShim{background-color:#fff3c2!important}.pls-contentWrap{background-color:#fff!important;position:relative!important;vertical-align:top}.pls-contentLeft{background-repeat:repeat-y;background-position:100%;vertical-align:top}.pls-dropRight{background-image:url(//ssl.gstatic.com/s2/oz/images/stars/po/bubblev1/bubbleDropR_3.png)!important;background-repeat:repeat-y!important}.pls-dropBL,.pls-dropBottom,.pls-dropRight,.pls-dropTR .pls-dropBR,.pls-tailleft,.pls-vert,.pls-vert img{vertical-align:top}.pls-dropBottom{background-image:url(//ssl.gstatic.com/s2/oz/images/stars/po/bubblev1/bubbleDropB_3.png)!important;background-repeat:repeat-x!important;width:100%}.pls-topLeft{text-align:right}.pls-topLeft,.pls-topRight{background:inherit!important;vertical-align:bottom}.pls-topRight{text-align:left}.pls-bottomLeft{background:inherit!important;text-align:right}.pls-bottomRight{background:inherit!important;text-align:left;vertical-align:top}.pls-tailbottom,.pls-tailleft,.pls-tailright,.pls-tailtop{display:none;position:relative}.pls-dropBL,.pls-dropBR,.pls-dropTR,.pls-tailbottom,.pls-tailleft,.pls-tailright,.pls-tailtop{background-image:url(//ssl.gstatic.com/s2/oz/images/stars/po/bubblev1/bubbleSprite_3.png)!important;background-repeat:no-repeat}.tbl-grey .pls-dropBL,.tbl-grey .pls-dropBR,.tbl-grey .pls-dropTR,.tbl-grey .pls-tailbottom,.tbl-grey .pls-tailleft,.tbl-grey .pls-tailright,.tbl-grey .pls-tailtop{background-image:url(//ssl.gstatic.com/s2/oz/images/stars/po/bubblev1/bubbleSprite-grey.png)!important}.pls-tailbottom{background-position:-23px 0}.pls-confirm-container .pls-tailbottom{background-position:-23px -10px}.pls-tailtop{background-position:-19px -20px}.pls-tailright{background-position:0 0}.pls-tailleft{background-position:-10px 0}.pls-tailtop{vertical-align:top}.gc-bubbleDefault td{line-height:0;font-size:0}.pls-tailbottom,.pls-topLeft img,.pls-topRight img{vertical-align:bottom}.bubbleDropTR,.pls-bottomLeft,.pls-bottomLeft img,.pls-dropBottom img,.pls-dropBottomL img,.pls-dropBottomR img{vertical-align:top}.pls-dropTR{background-position:0 -22px}.pls-dropBR{background-position:0 -27px}.pls-dropBL{background-position:0 -16px}.pls-spacerbottom,.pls-spacerleft,.pls-spacerright,.pls-spacertop{position:static!important}.pls-spinner{bottom:0;position:absolute;left:0;margin:auto;right:0;top:0}</style><script async="" src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/lazy.js"></script><style class="singleton-element" type="text/css">.cookie-choices-info { position:fixed;width:100%;background-color:#666;margin:0;left:0;top:0;padding:0;z-index:4000;text-align:center;color:#fff;line-height:140%;padding:10px 0;font-family:roboto,Arial; } .cookie-choices-info .cookie-choices-inner { position:relative;width:initial;margin:0;left:0;top:0; } .cookie-choices-info .cookie-choices-text { display:inline-block;vertical-align:middle;font-size:16px;margin:10px 20px;color:#ccc;max-width:800px;text-align:left; }.cookie-choices-info .cookie-choices-buttons { display:inline-block;vertical-align:middle;white-space:nowrap;margin:0 10px; } .cookie-choices-info .cookie-choices-button:hover {  color: #fff; } .cookie-choices-info .cookie-choices-button { font-weight:bold;text-transform:UPPERCASE;white-space:nowrap;color:#eee;margin-left:8px;padding:0 6px; text-decoration:none; }</style><style></style></head>
<body class=" variant-simplysimple">
<div class="navbar section" id="navbar" name="Navbar"><div class="widget Navbar" data-version="1" id="Navbar1"><script type="text/javascript">
    function setAttributeOnload(object, attribute, val) {
      if(window.addEventListener) {
        window.addEventListener('load',
          function(){ object[attribute] = val; }, false);
      } else {
        window.attachEvent('onload', function(){ object[attribute] = val; });
      }
    }
  </script>
<div id="navbar-iframe-container"><iframe ng-non-bindable="" hspace="0" marginheight="0" marginwidth="0" scrolling="no" style="" tabindex="0" vspace="0" id="navbar-iframe" name="navbar-iframe" src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/navbar.html" width="100%" frameborder="0"></iframe></div>
<script type="text/javascript" src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/plusone.js" gapi_processed="true"></script>
<script type="text/javascript">
      gapi.load("gapi.iframes:gapi.iframes.style.bubble", function() {
        if (gapi.iframes && gapi.iframes.getContext) {
          gapi.iframes.getContext().openChild({
              url: 'https://www.blogger.com/navbar.g?targetBlogID\x3d8471498366300003116\x26blogName\x3dThe+304Geeks\x26publishMode\x3dPUBLISH_MODE_BLOGSPOT\x26navbarType\x3dLIGHT\x26layoutType\x3dLAYOUTS\x26searchRoot\x3dhttps://304geeks.blogspot.com/search\x26blogLocale\x3den\x26v\x3d2\x26homepageUrl\x3dhttp://304geeks.blogspot.com/\x26targetPostID\x3d3369908487569789446\x26blogPostOrPageUrl\x3dhttp://304geeks.blogspot.com/2013/01/dns-scraping-for-corporate-av-detection.html\x26vt\x3d-5971189688171522819',
              where: document.getElementById("navbar-iframe-container"),
              id: "navbar-iframe"
          });
        }
      });
    </script><script type="text/javascript">
(function() {
var script = document.createElement('script');
script.type = 'text/javascript';
script.src = '//pagead2.googlesyndication.com/pagead/js/google_top_exp.js';
var head = document.getElementsByTagName('head')[0];
if (head) {
head.appendChild(script);
}})();
</script>
</div></div>
<div class="body-fauxcolumns">
<div class="fauxcolumn-outer body-fauxcolumn-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</div>
<div class="content">
<div class="content-fauxcolumns">
<div class="fauxcolumn-outer content-fauxcolumn-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</div>
<div class="content-outer">
<div class="content-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left content-fauxborder-left">
<div class="fauxborder-right content-fauxborder-right"></div>
<div class="content-inner">
<header>
<div class="header-outer">
<div class="header-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left header-fauxborder-left">
<div class="fauxborder-right header-fauxborder-right"></div>
<div class="region-inner header-inner">
<div class="header section" id="header" name="Header"><div class="widget Header" data-version="1" id="Header1">
<div id="header-inner">
<a href="http://304geeks.blogspot.com/" style="display: block">
<img alt="The 304Geeks" id="Header1_headerimg" src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/evolution-man-computer.gif" style="display: block" width="600px; " height="214px; ">
</a>
<div class="descriptionwrapper">
<p class="description"><span>
</span></p>
</div>
</div>
</div></div>
</div>
</div>
<div class="header-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</header>
<div class="tabs-outer">
<div class="tabs-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left tabs-fauxborder-left">
<div class="fauxborder-right tabs-fauxborder-right"></div>
<div class="region-inner tabs-inner">
<div class="tabs no-items section" id="crosscol" name="Cross-Column"></div>
<div class="tabs no-items section" id="crosscol-overflow" name="Cross-Column 2"></div>
</div>
</div>
<div class="tabs-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<div class="main-outer">
<div class="main-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left main-fauxborder-left">
<div class="fauxborder-right main-fauxborder-right"></div>
<div class="region-inner main-inner">
<div class="columns fauxcolumns">
<div class="fauxcolumn-outer fauxcolumn-center-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<div class="fauxcolumn-outer fauxcolumn-left-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<div class="fauxcolumn-outer fauxcolumn-right-outer">
<div class="cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left">
<div class="fauxborder-right"></div>
<div class="fauxcolumn-inner">
</div>
</div>
<div class="cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<!-- corrects IE6 width calculation -->
<div class="columns-inner">
<div class="column-center-outer">
<div class="column-center-inner">
<div class="main section" id="main" name="Main"><div class="widget Blog" data-version="1" id="Blog1">
<div class="blog-posts hfeed">

          <div class="date-outer">
        
<h2 class="date-header"><span>Monday, January 14, 2013</span></h2>

          <div class="date-posts">
        
<div class="post-outer">
<div class="post hentry uncustomized-post-template" itemprop="blogPost" itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
<meta content="http://2.bp.blogspot.com/-vpC9XhWXFJ8/UPRxJPtuklI/AAAAAAAAAeA/ZTCSeA6fQ5w/s400/update_list.png" itemprop="image_url">
<meta content="8471498366300003116" itemprop="blogId">
<meta content="3369908487569789446" itemprop="postId">
<a name="3369908487569789446"></a>
<h3 class="post-title entry-title" itemprop="name">
[UPDATED] DNS Scraping for Corporate AV Detection - "Admins, stop sharing your cache with everyone!"
</h3>
<div class="post-header">
<div class="post-header-line-1"></div>
</div>
<div class="post-body entry-content" id="post-body-3369908487569789446" itemprop="description articleBody">
<a href="https://www.blogger.com/blogger.g?blogID=8471498366300003116" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"></a><a href="https://www.blogger.com/blogger.g?blogID=8471498366300003116" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"></a><a href="https://www.blogger.com/blogger.g?blogID=8471498366300003116" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"></a><a href="https://www.blogger.com/blogger.g?blogID=8471498366300003116" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"></a><a href="https://www.blogger.com/blogger.g?blogID=8471498366300003116" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"></a><span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">NEW TOOL: <a href="https://github.com/304GEEK/Scrape-DNS">Scrape-DNS</a></span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">**Since this was first posted the technique has been implemented into&nbsp;<a href="http://www.rapid7.com/db/modules/auxiliary/gather/dns_cache_scraper">Metasploit</a>&nbsp;(which means it's on Kali Linux),&nbsp;<a href="https://bitbucket.org/LaNMaSteR53/recon-ng">Recon-ng</a>&nbsp;and&nbsp;<a href="https://archassault.org/packages/?q=scrape-dns-git">ArchAssault Project</a>.</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span>
<a href="https://www.blogger.com/blogger.g?blogID=8471498366300003116" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"></a><a href="https://www.blogger.com/blogger.g?blogID=8471498366300003116" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"></a><span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">Back
 at my old job, we used cache snooping techniques (Scraping) to check 
for evidence of client systems that were attempting to resolve known 
malware sites.</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">We would use the list at&nbsp;<a href="https://secure.mayhemiclabs.com/malhosts/malhosts.txt">Mayhemiclabs.com</a>&nbsp;and compare it to our cached DNS entries.</span><br>
<a href="https://www.blogger.com/blogger.g?blogID=8471498366300003116" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"></a><a href="https://www.blogger.com/blogger.g?blogID=8471498366300003116" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"></a><span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">So, why don't we do something badass like that, but to support the penetration test or red team mission?</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">Using standard cache snooping techniques you can determine what anti-virus vendors might be in use on a clients network.</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">HOW? Simple. By making non-recursive queries to the client's DNS servers for known AV update site domains.</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">Yes, it is that simple.</span><br>
<div style="font: 11.0px Helvetica; margin: 0.0px 0.0px 0.0px 0.0px; min-height: 13.0px;">
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif; font-size: small;"><br></span></div>
<div style="font: 11.0px Helvetica; margin: 0.0px 0.0px 0.0px 0.0px;">
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif; font-size: small;">To query cached DNS entries, you need only to make a NON-recursive request a target DNS server. &nbsp;</span></div>
<div style="font: 11.0px Helvetica; margin: 0.0px 0.0px 0.0px 0.0px;">
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif; font-size: small;"><br></span></div>
<div style="font: 11.0px Helvetica; margin: 0.0px 0.0px 0.0px 0.0px;">
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif; font-size: small;"></span></div>
<div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">
<a href="https://www.blogger.com/blogger.g?blogID=8471498366300003116" imageanchor="1" style="clear: right; float: right; margin-bottom: 1em; margin-left: 1em;"></a><span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif; font-size: small;">Dig seems to yield the most reliable results.</span></div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span></div>
<div style="font: 11.0px Helvetica; margin: 0.0px 0.0px 0.0px 0.0px;">
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif; font-size: small;">First we need to create a list of sites to check for.&nbsp;</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif; font-size: small;"><br></span>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif; font-size: small;">Let's put the list of sites in updates.list:</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><span class="Apple-style-span" style="font-size: small;"><br></span>
</span><br>
<div class="separator" style="clear: both; text-align: center;">
<a href="http://2.bp.blogspot.com/-vpC9XhWXFJ8/UPRxJPtuklI/AAAAAAAAAeA/ZTCSeA6fQ5w/s1600/update_list.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><img src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/update_list.png" width="325" height="400" border="0"></span></a></div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif; font-size: small;"><br></span></div>
<div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">As you can see, I have added “www.” to each entry as a modified duplicate.&nbsp;</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">You can simply run the following command:</span></div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">dig @129.71.1.1 -f updates.list +norecurse | grep -A 2 "ANSWER SECTION" | sort -u | sed '/^$/d'| sed 's/^/[+] Success - /g'</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span>
<br>
<div class="separator" style="clear: both; text-align: center;">
</div>
<div class="separator" style="clear: both; text-align: center;">
<a href="http://4.bp.blogspot.com/-rJHZU8VlJQg/UPR468RadlI/AAAAAAAAAeQ/qHvavwiDlhg/s1600/update_dig.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><img src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/update_dig.png" width="640" height="150" border="0"></span></a></div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span>
<br>
<div class="separator" style="clear: both; text-align: center;">
</div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span>
<br>
<div>
</div>
</div>
<div>
</div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">Lookie there. Symantec, Sophos, Forefront, etc. Jackpot!</span></div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span></div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">Looks ghetto, but it works and you can get a decent screenshot for your report.</span></div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span></div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">VERY
 IMPORTANT! If you forget to use the +norecurse option, you will have 
just poisoned the DNS cache with your list of sites. You will now have 
to wait for the entries to expire before proceeding.</span></div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span></div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">So,
 after learning this lesson and playing with various and hilarious 
website lists, I opted to just write a simple script. One that has 
pre-populated site lists and won’t let me forget the +norecurse option 
:D</span></div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span></div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">I call it <a href="https://github.com/304GEEK/Scrape-DNS">Scrape-DNS</a>.</span></div>
<div>
</div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span></div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">This
 script leverages Dig to perform non-recursive lookups against 
vulnerable DNS servers in order to determine if certain domains are 
stored in the DNS server’s cache.&nbsp;</span></div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">Usage:</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span></div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">Check DNS servers for interesting cached entries</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">Examples:</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">./scrape.sh -t 8.8.8.8 -a</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">./scrape.sh&nbsp;-t 8.8.8.8 -o</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">./scrape.sh&nbsp;-t 8.8.8.8 -u</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">./scrape.sh&nbsp;-t 8.8.8.8 -i custom_sites.list</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">OPTIONS:</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">&nbsp; &nbsp;-h &nbsp; &nbsp; Show this message</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">&nbsp; &nbsp;-a &nbsp; &nbsp; All Mode&nbsp;</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">&nbsp; &nbsp;-i &nbsp; &nbsp; &nbsp;Import Mode&nbsp;</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">&nbsp; &nbsp;-u &nbsp; &nbsp; Common AV Mode</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">&nbsp; &nbsp;-o &nbsp; &nbsp; Obscene Mode</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">&nbsp; &nbsp;-t <span class="Apple-tab-span" style="white-space: pre;"> </span> &nbsp; Target DNS Server</span></div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">Some results are funnier than others.</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">Using Free Porn Mode, er.. Obscene Mode :</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span></div>
<div>
<div class="separator" style="clear: both; text-align: center;">
<a href="http://3.bp.blogspot.com/-FD-ScMjvYjI/UPRvggttyBI/AAAAAAAAAdQ/1LP55Qen9yY/s1600/porn_list.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><img src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/porn_list.png" width="640" height="244" border="0"></span></a></div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span></div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">So,
 next time you need to demonstrate this vulnerability (DNS Cache 
Snooping Enabled) or need / want to perform recon before crafting your 
payloads, you can try this technique with Dig, or you can <a href="https://github.com/304GEEK/Scrape-DNS">Scrape-DNS</a>.</span></div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span></div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">Alternate mehod: If non-recurse is not available, we can try the ‘timing method’.</span></div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span></div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">The
 idea here is, if I request a domain 5 times; the first time the 
response takes 130ms, the second 51ms, the third 50ms, then 53ms, 52ms. 
We can infer that the requested domain was NOT in the server’s cache the
 first time we requested it. But, obviously it would be the second, 
third, etc. Assuming this test was conducted before the entry 
expired.&nbsp;</span></div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span></div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">Here is what that might look like;</span></div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span></div>
<div>
<div class="separator" style="clear: both; text-align: center;">
<a href="http://4.bp.blogspot.com/-HL1uoXuASTI/UPRvhm7hvWI/AAAAAAAAAdk/CX3CfRRfY-c/s1600/update_symantec.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><img src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/update_symantec.png" width="640" height="180" border="0"></span></a></div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">Let’s check for update.symantec.com: dig @dns-server-ip update.symantec.com | grep -A 5 "Query time:"</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span></div>
<div>
</div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">Looks like update.symantec.com IS in the server’s cache. They might have Symantec Av running in the environment?</span></div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span></div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">Let’s try Avast:&nbsp;dig @dns-server-ip download797.avast.com | grep -A 5 "Query time:"</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span>
<br>
<div class="separator" style="clear: both; text-align: center;">
<a href="http://4.bp.blogspot.com/-Mm_fHm1BN2E/UPRvg0LexCI/AAAAAAAAAdU/YxFYmMJv3w4/s1600/update_avast.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><img src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/update_avast.png" width="640" height="178" border="0"></span></a></div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">And it looks like download797.avast.com was NOT in the servers cache when we first checked. They MAY not be running Avast.</span></div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span></div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">You
 can also run continuous checks to interrogate the DNS server. I won’t 
get into it here, but I just used a for loop and SLEEP(s) to pull that 
off.</span></div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><a href="https://github.com/304GEEK/Scrape-DNS">Scrape-DNS</a> v2 with include the option for continuous collection. Assuming anyone cares enough to use v1 and gives any feedback :)</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">[UPDATED]</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">I found a cool blog entry "<a href="http://novemberochtend.blogspot.com/2008/12/poor-mans-bar-graph-in-bash.html">Poor man's bar graphs in bash</a>" by Ger-Jan. He wrote a cool portable bash loop that will build out bar graphs in bash.&nbsp;</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">So,
 I quickly incorporated it into the scraping routine, so that I can 
visually compare the DNS response times in an effort to make better 
judgement when using the timing method to find cached DNS entries.</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">Here is s a screenshot:</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span>
<br>
<div class="separator" style="clear: both; text-align: center;">
<a href="http://2.bp.blogspot.com/-P7A1mCBqC9g/UPWO8MO9uXI/AAAAAAAAAeg/_IAvmbxs_bI/s1600/timing+graphs.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/timinggraphs.png" width="640" height="484" border="0"></a></div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span><span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">Looks like Sophos is NOT is use on this network. OR, they never update o.O !!</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">I will add this feature to Scrape-DNS in the next version or so.&nbsp;</span></div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span></div>
<div>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;">Enjoy,</span><br>
<span class="Apple-style-span" style="font-family: Arial, Helvetica, sans-serif;"><br></span></div>
</div>
<div>
<div class="separator" style="clear: both; text-align: center;">
</div>
@304geek</div>
<div style="clear: both;"></div>
</div>
<div class="post-footer">
<div class="post-footer-line post-footer-line-1">
<span class="post-author vcard">
Posted by
<span class="fn" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person">
<meta content="https://www.blogger.com/profile/05635344046064284650" itemprop="url">
<a class="g-profile" href="https://www.blogger.com/profile/05635344046064284650" rel="author" title="author profile" data-gapiscan="true" data-onload="true" data-gapiattached="true">
<span itemprop="name">304geek</span>
</a>
</span>
</span>
<span class="post-timestamp">
at
<meta content="http://304geeks.blogspot.com/2013/01/dns-scraping-for-corporate-av-detection.html" itemprop="url">
<a class="timestamp-link" href="http://304geeks.blogspot.com/2013/01/dns-scraping-for-corporate-av-detection.html" rel="bookmark" title="permanent link"><abbr class="published" itemprop="datePublished" title="2013-01-14T12:23:00-08:00">12:23 PM</abbr></a>
</span>
<span class="reaction-buttons">
</span>
<span class="post-comment-link">
</span>
<span class="post-icons">
<span class="item-control blog-admin pid-1020303684">
<a href="https://www.blogger.com/post-edit.g?blogID=8471498366300003116&amp;postID=3369908487569789446&amp;from=pencil" title="Edit Post">
<img alt="" class="icon-action" src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/icon18_edit_allbkg.gif" width="18" height="18">
</a>
</span>
</span>
<div class="post-share-buttons goog-inline-block">
<a class="goog-inline-block share-button sb-email" href="https://www.blogger.com/share-post.g?blogID=8471498366300003116&amp;postID=3369908487569789446&amp;target=email" target="_blank" title="Email This"><span class="share-button-link-text">Email This</span></a><a class="goog-inline-block share-button sb-blog" href="https://www.blogger.com/share-post.g?blogID=8471498366300003116&amp;postID=3369908487569789446&amp;target=blog" onclick='window.open(this.href, "_blank", "height=270,width=475"); return false;' target="_blank" title="BlogThis!"><span class="share-button-link-text">BlogThis!</span></a><a class="goog-inline-block share-button sb-twitter" href="https://www.blogger.com/share-post.g?blogID=8471498366300003116&amp;postID=3369908487569789446&amp;target=twitter" target="_blank" title="Share to Twitter"><span class="share-button-link-text">Share to Twitter</span></a><a class="goog-inline-block share-button sb-facebook" href="https://www.blogger.com/share-post.g?blogID=8471498366300003116&amp;postID=3369908487569789446&amp;target=facebook" onclick='window.open(this.href, "_blank", "height=430,width=640"); return false;' target="_blank" title="Share to Facebook"><span class="share-button-link-text">Share to Facebook</span></a><a class="goog-inline-block share-button sb-pinterest" href="https://www.blogger.com/share-post.g?blogID=8471498366300003116&amp;postID=3369908487569789446&amp;target=pinterest" target="_blank" title="Share to Pinterest"><span class="share-button-link-text">Share to Pinterest</span></a>
</div>
</div>
<div class="post-footer-line post-footer-line-2">
<span class="post-labels">
</span>
</div>
<div class="post-footer-line post-footer-line-3">
<span class="post-location">
</span>
</div>
</div>
</div>
<div class="comments" id="comments">
<a name="comments"></a>
</div>
</div>

        </div></div>
      
</div>
<div class="blog-pager" id="blog-pager">
<span id="blog-pager-newer-link">
<a class="blog-pager-newer-link" href="http://304geeks.blogspot.com/2013/11/create-your-own-raspberry-pi-hackstation.html" id="Blog1_blog-pager-newer-link" title="Newer Post">Newer Post</a>
</span>
<span id="blog-pager-older-link">
<a class="blog-pager-older-link" href="http://304geeks.blogspot.com/2012/10/hack3rcon3-doomsday-eve.html" id="Blog1_blog-pager-older-link" title="Older Post">Older Post</a>
</span>
<a class="home-link" href="http://304geeks.blogspot.com/">Home</a>
</div>
<div class="clear"></div>
<div class="post-feeds">
</div>
</div></div>
</div>
</div>
<div class="column-left-outer">
<div class="column-left-inner">
<aside>
</aside>
</div>
</div>
<div class="column-right-outer">
<div class="column-right-inner">
<aside>
<div class="sidebar section" id="sidebar-right-1"><div class="widget LinkList" data-version="1" id="LinkList1">
<h2>304Stuffs</h2>
<div class="widget-content">
<ul>
<li><a href="https://github.com/304GEEK/Scrape-DNS">Scrape-DNS Repo</a></li>
<li><a href="http://hack3rcon.org/">Hack3rCon News</a></li>
<li><a href="http://groups.google.com/group/304geeks?hl=en">Join 304Geeks</a></li>
</ul>
<div class="clear"></div>
<span class="widget-item-control">
<span class="item-control blog-admin">
<a class="quickedit" href="http://www.blogger.com/rearrange?blogID=8471498366300003116&amp;widgetType=LinkList&amp;widgetId=LinkList1&amp;action=editWidget&amp;sectionId=sidebar-right-1" onclick='return _WidgetManager._PopupConfig(document.getElementById("LinkList1"));' rel="nofollow" target="configLinkList1" title="Edit">
<img alt="" src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/icon18_wrench_allbkg.png" width="18" height="18">
</a>
</span>
</span>
<div class="clear"></div>
</div>
</div><div class="widget Subscribe" data-version="1" id="Subscribe1">
<div style="white-space:nowrap">
<h2 class="title">Subscribe</h2>
<div class="widget-content">
<div class="subscribe-wrapper subscribe-type-POST">
<div class="subscribe expanded subscribe-type-POST" id="SW_READER_LIST_Subscribe1POST" style="display:none;">
<div class="top">
<span class="inner" onclick='return(_SW_toggleReaderList(event, "Subscribe1POST"));'>
<img class="subscribe-dropdown-arrow" src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/arrow_dropdown.gif">
<img alt="" class="feed-icon" src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/icon_feed12.png" border="0" align="absmiddle">
Posts
</span>
<div class="feed-reader-links">
<a class="feed-reader-link" href="https://www.netvibes.com/subscribe.php?url=http%3A%2F%2F304geeks.blogspot.com%2Ffeeds%2Fposts%2Fdefault" target="_blank">
<img src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/subscribe-netvibes.png">
</a>
<a class="feed-reader-link" href="https://add.my.yahoo.com/content?url=http%3A%2F%2F304geeks.blogspot.com%2Ffeeds%2Fposts%2Fdefault" target="_blank">
<img src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/subscribe-yahoo.png">
</a>
<a class="feed-reader-link" href="http://304geeks.blogspot.com/feeds/posts/default" target="_blank">
<img class="feed-icon" src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/icon_feed12.png" align="absmiddle">
                  Atom
                </a>
</div>
</div>
<div class="bottom"></div>
</div>
<div class="subscribe" id="SW_READER_LIST_CLOSED_Subscribe1POST" onclick='return(_SW_toggleReaderList(event, "Subscribe1POST"));'>
<div class="top">
<span class="inner">
<img class="subscribe-dropdown-arrow" src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/arrow_dropdown.gif">
<span onclick='return(_SW_toggleReaderList(event, "Subscribe1POST"));'>
<img alt="" class="feed-icon" src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/icon_feed12.png" border="0" align="absmiddle">
Posts
</span>
</span>
</div>
<div class="bottom"></div>
</div>
</div>
<div class="subscribe-wrapper subscribe-type-PER_POST">
<div class="subscribe expanded subscribe-type-PER_POST" id="SW_READER_LIST_Subscribe1PER_POST" style="display:none;">
<div class="top">
<span class="inner" onclick='return(_SW_toggleReaderList(event, "Subscribe1PER_POST"));'>
<img class="subscribe-dropdown-arrow" src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/arrow_dropdown.gif">
<img alt="" class="feed-icon" src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/icon_feed12.png" border="0" align="absmiddle">
Comments
</span>
<div class="feed-reader-links">
<a class="feed-reader-link" href="https://www.netvibes.com/subscribe.php?url=http%3A%2F%2F304geeks.blogspot.com%2Ffeeds%2F3369908487569789446%2Fcomments%2Fdefault" target="_blank">
<img src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/subscribe-netvibes.png">
</a>
<a class="feed-reader-link" href="https://add.my.yahoo.com/content?url=http%3A%2F%2F304geeks.blogspot.com%2Ffeeds%2F3369908487569789446%2Fcomments%2Fdefault" target="_blank">
<img src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/subscribe-yahoo.png">
</a>
<a class="feed-reader-link" href="http://304geeks.blogspot.com/feeds/3369908487569789446/comments/default" target="_blank">
<img class="feed-icon" src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/icon_feed12.png" align="absmiddle">
                  Atom
                </a>
</div>
</div>
<div class="bottom"></div>
</div>
<div class="subscribe" id="SW_READER_LIST_CLOSED_Subscribe1PER_POST" onclick='return(_SW_toggleReaderList(event, "Subscribe1PER_POST"));'>
<div class="top">
<span class="inner">
<img class="subscribe-dropdown-arrow" src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/arrow_dropdown.gif">
<span onclick='return(_SW_toggleReaderList(event, "Subscribe1PER_POST"));'>
<img alt="" class="feed-icon" src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/icon_feed12.png" border="0" align="absmiddle">
Comments
</span>
</span>
</div>
<div class="bottom"></div>
</div>
</div>
<div style="clear:both"></div>
</div>
</div>
<div class="clear"></div>
<span class="widget-item-control">
<span class="item-control blog-admin">
<a class="quickedit" href="http://www.blogger.com/rearrange?blogID=8471498366300003116&amp;widgetType=Subscribe&amp;widgetId=Subscribe1&amp;action=editWidget&amp;sectionId=sidebar-right-1" onclick='return _WidgetManager._PopupConfig(document.getElementById("Subscribe1"));' rel="nofollow" target="configSubscribe1" title="Edit">
<img alt="" src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/icon18_wrench_allbkg.png" width="18" height="18">
</a>
</span>
</span>
<div class="clear"></div>
</div></div>
<table class="section-columns columns-2" cellspacing="0" cellpadding="0" border="0">
<tbody>
<tr>
<td class="first columns-cell">
<div class="sidebar section" id="sidebar-right-2-1"><div class="widget Followers" data-version="1" id="Followers1">
<h2 class="title">Followers</h2>
<div class="widget-content">
<div id="Followers1-wrapper">
<div style="margin-right:2px;">
<div><script type="text/javascript" src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/plusone.js" gapi_processed="true"></script>
<div id="followers-iframe-container"><iframe ng-non-bindable="" hspace="0" marginheight="0" marginwidth="0" scrolling="no" style="" tabindex="0" vspace="0" id="I0_1603727024887" name="I0_1603727024887" src="https://www.blogger.com/followers.g?blogID=8471498366300003116&amp;colors=Cgt0cmFuc3BhcmVudBILdHJhbnNwYXJlbnQaByM2NjY2NjYiByMyMjg4YmIqByNmZmZmZmYyByMwMDAwMDA6ByM2NjY2NjZCByMyMjg4YmJKByM5OTk5OTlSByMyMjg4YmJaC3RyYW5zcGFyZW50&amp;pageSize=21&amp;postID=3369908487569789446&amp;origin=http://304geeks.blogspot.com/&amp;usegapi=1&amp;jsh=m%3B%2F_%2Fscs%2Fapps-static%2F_%2Fjs%2Fk%3Doz.gapi.en_US.2laq3Py8kJk.O%2Fam%3DwQE%2Fd%3D1%2Fct%3Dzgms%2Frs%3DAGLTcCNOVyb6DDYv7xgJGtF_6RiAl0K1Kw%2Fm%3D__features__#id=I0_1603727024887&amp;_gfid=I0_1603727024887&amp;parent=http%3A%2F%2F304geeks.blogspot.com&amp;pfname=&amp;rpctoken=37859483" width="100%" height="417" frameborder="0"></iframe></div>
<script type="text/javascript">
    window.followersIframe = null;
    function followersIframeOpen(url) {
      gapi.load("gapi.iframes", function() {
        if (gapi.iframes && gapi.iframes.getContext) {
          window.followersIframe = gapi.iframes.getContext().openChild({
            url: url,
            where: document.getElementById("followers-iframe-container"),
            messageHandlersFilter: gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER,
            messageHandlers: {
              '_ready': function(obj) {
                window.followersIframe.getIframeEl().height = obj.height;
              },
              'reset': function() {
                window.followersIframe.close();
                followersIframeOpen("https://www.blogger.com/followers.g?blogID\x3d8471498366300003116\x26colors\x3dCgt0cmFuc3BhcmVudBILdHJhbnNwYXJlbnQaByM2NjY2NjYiByMyMjg4YmIqByNmZmZmZmYyByMwMDAwMDA6ByM2NjY2NjZCByMyMjg4YmJKByM5OTk5OTlSByMyMjg4YmJaC3RyYW5zcGFyZW50\x26pageSize\x3d21\x26postID\x3d3369908487569789446\x26origin\x3dhttp://304geeks.blogspot.com/");
              },
              'open': function(url) {
                window.followersIframe.close();
                followersIframeOpen(url);
              },
              'blogger-ping': function() {
              }
            }
          });
        }
      });
    }
    followersIframeOpen("https://www.blogger.com/followers.g?blogID\x3d8471498366300003116\x26colors\x3dCgt0cmFuc3BhcmVudBILdHJhbnNwYXJlbnQaByM2NjY2NjYiByMyMjg4YmIqByNmZmZmZmYyByMwMDAwMDA6ByM2NjY2NjZCByMyMjg4YmJKByM5OTk5OTlSByMyMjg4YmJaC3RyYW5zcGFyZW50\x26pageSize\x3d21\x26postID\x3d3369908487569789446\x26origin\x3dhttp://304geeks.blogspot.com/");
  </script></div>
</div>
</div>
<div class="clear"></div>
<span class="widget-item-control">
<span class="item-control blog-admin">
<a class="quickedit" href="http://www.blogger.com/rearrange?blogID=8471498366300003116&amp;widgetType=Followers&amp;widgetId=Followers1&amp;action=editWidget&amp;sectionId=sidebar-right-2-1" onclick='return _WidgetManager._PopupConfig(document.getElementById("Followers1"));' rel="nofollow" target="configFollowers1" title="Edit">
<img alt="" src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/icon18_wrench_allbkg.png" width="18" height="18">
</a>
</span>
</span>
<div class="clear"></div>
</div>
</div></div>
</td>
<td class="columns-cell">
<div class="sidebar section" id="sidebar-right-2-2"><div class="widget Profile" data-version="1" id="Profile1">
<h2>Contributors</h2>
<div class="widget-content">
<ul>
<li><a class="profile-name-link g-profile" href="https://www.blogger.com/profile/05635344046064284650" style="background-image: url(//www.blogger.com/img/logo-16.png);" data-gapiscan="true" data-onload="true" data-gapiattached="true">304geek</a></li>
<li><a class="profile-name-link g-profile" href="https://www.blogger.com/profile/02934762369047107698" style="background-image: url(//www.blogger.com/img/logo-16.png);" data-gapiscan="true" data-onload="true" data-gapiattached="true">Dustin Yeager</a></li>
<li><a class="profile-name-link g-profile" href="https://www.blogger.com/profile/16285463120369210954" style="background-image: url(//www.blogger.com/img/logo-16.png);" data-gapiscan="true" data-onload="true" data-gapiattached="true">Han L00ph0l3</a></li>
<li><a class="profile-name-link g-profile" href="https://www.blogger.com/profile/10925900524130395367" style="background-image: url(//www.blogger.com/img/logo-16.png);" data-gapiscan="true" data-onload="true" data-gapiattached="true">Kung Fu Walrus</a></li>
<li><a class="profile-name-link g-profile" href="https://www.blogger.com/profile/13147370082689290871" style="background-image: url(//www.blogger.com/img/logo-16.png);" data-gapiscan="true" data-onload="true" data-gapiattached="true">Matt</a></li>
<li><a class="profile-name-link g-profile" href="https://www.blogger.com/profile/17187939837463676916" style="background-image: url(//www.blogger.com/img/logo-16.png);" data-gapiscan="true" data-onload="true" data-gapiattached="true">The Raging Otaku</a></li>
<li><a class="profile-name-link g-profile" href="https://www.blogger.com/profile/05053525869820340340" style="background-image: url(//www.blogger.com/img/logo-16.png);" data-gapiscan="true" data-onload="true" data-gapiattached="true">netinfinity</a></li>
<li><a class="profile-name-link g-profile" href="https://www.blogger.com/profile/15277332209680865565" style="background-image: url(//www.blogger.com/img/logo-16.png);" data-gapiscan="true" data-onload="true" data-gapiattached="true">oncee</a></li>
</ul>
<div class="clear"></div>
<span class="widget-item-control">
<span class="item-control blog-admin">
<a class="quickedit" href="http://www.blogger.com/rearrange?blogID=8471498366300003116&amp;widgetType=Profile&amp;widgetId=Profile1&amp;action=editWidget&amp;sectionId=sidebar-right-2-2" onclick='return _WidgetManager._PopupConfig(document.getElementById("Profile1"));' rel="nofollow" target="configProfile1" title="Edit">
<img alt="" src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/icon18_wrench_allbkg.png" width="18" height="18">
</a>
</span>
</span>
<div class="clear"></div>
</div>
</div></div>
</td>
</tr>
</tbody>
</table>
<div class="sidebar section" id="sidebar-right-3"><div class="widget BlogArchive" data-version="1" id="BlogArchive1">
<h2>Blog Archive</h2>
<div class="widget-content">
<div id="ArchiveList">
<div id="BlogArchive1_ArchiveList">
<ul class="flat">
<li class="archivedate">
<a href="http://304geeks.blogspot.com/2015/05/">May</a> (1)
      </li>
<li class="archivedate">
<a href="http://304geeks.blogspot.com/2014/07/">July</a> (1)
      </li>
<li class="archivedate">
<a href="http://304geeks.blogspot.com/2013/11/">November</a> (1)
      </li>
<li class="archivedate">
<a href="http://304geeks.blogspot.com/2013/01/">January</a> (1)
      </li>
<li class="archivedate">
<a href="http://304geeks.blogspot.com/2012/10/">October</a> (2)
      </li>
<li class="archivedate">
<a href="http://304geeks.blogspot.com/2012/05/">May</a> (2)
      </li>
<li class="archivedate">
<a href="http://304geeks.blogspot.com/2012/03/">March</a> (2)
      </li>
<li class="archivedate">
<a href="http://304geeks.blogspot.com/2012/02/">February</a> (2)
      </li>
<li class="archivedate">
<a href="http://304geeks.blogspot.com/2011/12/">December</a> (1)
      </li>
<li class="archivedate">
<a href="http://304geeks.blogspot.com/2011/10/">October</a> (3)
      </li>
<li class="archivedate">
<a href="http://304geeks.blogspot.com/2011/09/">September</a> (8)
      </li>
<li class="archivedate">
<a href="http://304geeks.blogspot.com/2011/07/">July</a> (1)
      </li>
<li class="archivedate">
<a href="http://304geeks.blogspot.com/2011/04/">April</a> (2)
      </li>
<li class="archivedate">
<a href="http://304geeks.blogspot.com/2011/03/">March</a> (2)
      </li>
<li class="archivedate">
<a href="http://304geeks.blogspot.com/2011/02/">February</a> (8)
      </li>
<li class="archivedate">
<a href="http://304geeks.blogspot.com/2011/01/">January</a> (4)
      </li>
<li class="archivedate">
<a href="http://304geeks.blogspot.com/2010/12/">December</a> (1)
      </li>
<li class="archivedate">
<a href="http://304geeks.blogspot.com/2010/11/">November</a> (2)
      </li>
<li class="archivedate">
<a href="http://304geeks.blogspot.com/2010/10/">October</a> (2)
      </li>
<li class="archivedate">
<a href="http://304geeks.blogspot.com/2010/07/">July</a> (14)
      </li>
<li class="archivedate">
<a href="http://304geeks.blogspot.com/2010/05/">May</a> (6)
      </li>
</ul>
</div>
</div>
<div class="clear"></div>
<span class="widget-item-control">
<span class="item-control blog-admin">
<a class="quickedit" href="http://www.blogger.com/rearrange?blogID=8471498366300003116&amp;widgetType=BlogArchive&amp;widgetId=BlogArchive1&amp;action=editWidget&amp;sectionId=sidebar-right-3" onclick='return _WidgetManager._PopupConfig(document.getElementById("BlogArchive1"));' rel="nofollow" target="configBlogArchive1" title="Edit">
<img alt="" src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/icon18_wrench_allbkg.png" width="18" height="18">
</a>
</span>
</span>
<div class="clear"></div>
</div>
</div></div>
</aside>
</div>
</div>
</div>
<div style="clear: both"></div>
<!-- columns -->
</div>
<!-- main -->
</div>
</div>
<div class="main-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
<footer>
<div class="footer-outer">
<div class="footer-cap-top cap-top">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
<div class="fauxborder-left footer-fauxborder-left">
<div class="fauxborder-right footer-fauxborder-right"></div>
<div class="region-inner footer-inner">
<div class="foot no-items section" id="footer-1"></div>
<table class="section-columns columns-2" cellspacing="0" cellpadding="0" border="0">
<tbody>
<tr>
<td class="first columns-cell">
<div class="foot no-items section" id="footer-2-1"></div>
</td>
<td class="columns-cell">
<div class="foot no-items section" id="footer-2-2"></div>
</td>
</tr>
</tbody>
</table>
<!-- outside of the include in order to lock Attribution widget -->
<div class="foot section" id="footer-3" name="Footer"><div class="widget Attribution" data-version="1" id="Attribution1">
<div class="widget-content" style="text-align: center;">
Simple theme. Powered by <a href="https://www.blogger.com/" target="_blank">Blogger</a>.
</div>
<div class="clear"></div>
<span class="widget-item-control">
<span class="item-control blog-admin">
<a class="quickedit" href="http://www.blogger.com/rearrange?blogID=8471498366300003116&amp;widgetType=Attribution&amp;widgetId=Attribution1&amp;action=editWidget&amp;sectionId=footer-3" onclick='return _WidgetManager._PopupConfig(document.getElementById("Attribution1"));' rel="nofollow" target="configAttribution1" title="Edit">
<img alt="" src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/icon18_wrench_allbkg.png" width="18" height="18">
</a>
</span>
</span>
<div class="clear"></div>
</div></div>
</div>
</div>
<div class="footer-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</footer>
<!-- content -->
</div>
</div>
<div class="content-cap-bottom cap-bottom">
<div class="cap-left"></div>
<div class="cap-right"></div>
</div>
</div>
</div>
<script type="text/javascript">
    window.setTimeout(function() {
        document.body.className = document.body.className.replace('loading', '');
      }, 10);
  </script>
<script src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/plusone.js" type="text/javascript" gapi_processed="true"></script>
<!--\xc8 tua responsabilit\xe0 avvisare i visitatori dei cookie utilizzati e dei dati raccolti sul tuo blog. In Blogger \xe8 disponibile una notifica standard che puoi utilizzare sul tuo blog. Puoi personalizzarla o sostituirla con una notifica preparata da te. Per maggiori dettagli, visita http://www.blogger.com/go/cookiechoices.-->
<script defer="defer" src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/cookienotice.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function(event) {
      window.cookieChoices && cookieChoices.showCookieConsentBar && cookieChoices.showCookieConsentBar(
          (window.cookieOptions && cookieOptions.msg) || 'Questo sito utilizza cookie di Google per erogare i propri servizi e per analizzare il traffico. Il tuo indirizzo IP e il tuo user agent sono condivisi con Google, unitamente alle metriche sulle prestazioni e sulla sicurezza, per garantire la qualit\xe0 del servizio, generare statistiche di utilizzo e rilevare e contrastare eventuali abusi.',
          (window.cookieOptions && cookieOptions.close) || 'OK',
          (window.cookieOptions && cookieOptions.learn) || 'Ulteriori informazioni',
          (window.cookieOptions && cookieOptions.link) || 'https://www.blogger.com/go/blogspot-cookies');
    });
  </script>

<script type="text/javascript" src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/2872693907-widgets.js"></script>
<script type="text/javascript">
window['__wavt'] = 'AOuZoY57517nUEmfO4WQlCkHztWkg9hAAw:1603726872791';_WidgetManager._Init('//www.blogger.com/rearrange?blogID\x3d8471498366300003116','//304geeks.blogspot.com/2013/01/dns-scraping-for-corporate-av-detection.html','8471498366300003116');
_WidgetManager._SetDataContext([{'name': 'blog', 'data': {'blogId': '8471498366300003116', 'title': 'The 304Geeks', 'url': 'http://304geeks.blogspot.com/2013/01/dns-scraping-for-corporate-av-detection.html', 'canonicalUrl': 'http://304geeks.blogspot.com/2013/01/dns-scraping-for-corporate-av-detection.html', 'homepageUrl': 'http://304geeks.blogspot.com/', 'searchUrl': 'http://304geeks.blogspot.com/search', 'canonicalHomepageUrl': 'http://304geeks.blogspot.com/', 'blogspotFaviconUrl': 'http://304geeks.blogspot.com/favicon.ico', 'bloggerUrl': 'https://www.blogger.com', 'hasCustomDomain': false, 'httpsEnabled': true, 'enabledCommentProfileImages': true, 'gPlusViewType': 'FILTERED_POSTMOD', 'adultContent': false, 'analyticsAccountNumber': '', 'encoding': 'UTF-8', 'locale': 'en', 'localeUnderscoreDelimited': 'en', 'languageDirection': 'ltr', 'isPrivate': false, 'isMobile': false, 'isMobileRequest': false, 'mobileClass': '', 'isPrivateBlog': false, 'isDynamicViewsAvailable': true, 'feedLinks': '\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22The 304Geeks - Atom\x22 href\x3d\x22http://304geeks.blogspot.com/feeds/posts/default\x22 /\x3e\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/rss+xml\x22 title\x3d\x22The 304Geeks - RSS\x22 href\x3d\x22http://304geeks.blogspot.com/feeds/posts/default?alt\x3drss\x22 /\x3e\n\x3clink rel\x3d\x22service.post\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22The 304Geeks - Atom\x22 href\x3d\x22https://www.blogger.com/feeds/8471498366300003116/posts/default\x22 /\x3e\n\n\x3clink rel\x3d\x22alternate\x22 type\x3d\x22application/atom+xml\x22 title\x3d\x22The 304Geeks - Atom\x22 href\x3d\x22http://304geeks.blogspot.com/feeds/3369908487569789446/comments/default\x22 /\x3e\n', 'meTag': '', 'adsenseHostId': 'ca-host-pub-1556223355139109', 'adsenseHasAds': false, 'ieCssRetrofitLinks': '\x3c!--[if IE]\x3e\x3cscript type\x3d\x22text/javascript\x22 src\x3d\x22https://www.blogger.com/static/v1/jsbin/4244862144-ieretrofit.js\x22\x3e\x3c/script\x3e\n\x3c![endif]--\x3e', 'view': '', 'dynamicViewsCommentsSrc': '//www.blogblog.com/dynamicviews/4224c15c4e7c9321/js/comments.js', 'dynamicViewsScriptSrc': '//www.blogblog.com/dynamicviews/fa86f393e0db6689', 'plusOneApiSrc': 'https://apis.google.com/js/plusone.js', 'disableGComments': true, 'sharing': {'platforms': [{'name': 'Get link', 'key': 'link', 'shareMessage': 'Get link', 'target': ''}, {'name': 'Facebook', 'key': 'facebook', 'shareMessage': 'Share to Facebook', 'target': 'facebook'}, {'name': 'BlogThis!', 'key': 'blogThis', 'shareMessage': 'BlogThis!', 'target': 'blog'}, {'name': 'Twitter', 'key': 'twitter', 'shareMessage': 'Share to Twitter', 'target': 'twitter'}, {'name': 'Pinterest', 'key': 'pinterest', 'shareMessage': 'Share to Pinterest', 'target': 'pinterest'}, {'name': 'Email', 'key': 'email', 'shareMessage': 'Email', 'target': 'email'}], 'disableGooglePlus': true, 'googlePlusShareButtonWidth': 300, 'googlePlusBootstrap': '\x3cscript type\x3d\x22text/javascript\x22\x3ewindow.___gcfg \x3d {\x27lang\x27: \x27en\x27};\x3c/script\x3e'}, 'hasCustomJumpLinkMessage': false, 'jumpLinkMessage': 'Read more', 'pageType': 'item', 'postId': '3369908487569789446', 'postImageThumbnailUrl': 'http://2.bp.blogspot.com/-vpC9XhWXFJ8/UPRxJPtuklI/AAAAAAAAAeA/ZTCSeA6fQ5w/s72-c/update_list.png', 'postImageUrl': 'http://2.bp.blogspot.com/-vpC9XhWXFJ8/UPRxJPtuklI/AAAAAAAAAeA/ZTCSeA6fQ5w/s400/update_list.png', 'pageName': '[UPDATED] DNS Scraping for Corporate AV Detection - \x22Admins, stop sharing your cache with everyone!\x22', 'pageTitle': 'The 304Geeks: [UPDATED] DNS Scraping for Corporate AV Detection - \x22Admins, stop sharing your cache with everyone!\x22'}}, {'name': 'features', 'data': {'sharing_get_link_dialog': 'true', 'sharing_native': 'false'}}, {'name': 'messages', 'data': {'edit': 'Edit', 'linkCopiedToClipboard': 'Link copied to clipboard!', 'ok': 'Ok', 'postLink': 'Post Link'}}, {'name': 'template', 'data': {'name': 'Simple', 'localizedName': 'Simple', 'isResponsive': false, 'isAlternateRendering': false, 'isCustom': false, 'variant': 'simplysimple', 'variantId': 'simplysimple'}}, {'name': 'view', 'data': {'classic': {'name': 'classic', 'url': '?view\x3dclassic'}, 'flipcard': {'name': 'flipcard', 'url': '?view\x3dflipcard'}, 'magazine': {'name': 'magazine', 'url': '?view\x3dmagazine'}, 'mosaic': {'name': 'mosaic', 'url': '?view\x3dmosaic'}, 'sidebar': {'name': 'sidebar', 'url': '?view\x3dsidebar'}, 'snapshot': {'name': 'snapshot', 'url': '?view\x3dsnapshot'}, 'timeslide': {'name': 'timeslide', 'url': '?view\x3dtimeslide'}, 'isMobile': false, 'title': '[UPDATED] DNS Scraping for Corporate AV Detection - \x22Admins, stop sharing your cache with everyone!\x22', 'description': 'NEW TOOL: Scrape-DNS   **Since this was first posted the technique has been implemented into&#160; Metasploit &#160;(which means it\x27s on Kali Linux),&#160;...', 'featuredImage': 'http://2.bp.blogspot.com/-vpC9XhWXFJ8/UPRxJPtuklI/AAAAAAAAAeA/ZTCSeA6fQ5w/s400/update_list.png', 'url': 'http://304geeks.blogspot.com/2013/01/dns-scraping-for-corporate-av-detection.html', 'type': 'item', 'isSingleItem': true, 'isMultipleItems': false, 'isError': false, 'isPage': false, 'isPost': true, 'isHomepage': false, 'isArchive': false, 'isLabelSearch': false, 'postId': 3369908487569789446}}]);
_WidgetManager._RegisterWidget('_NavbarView', new _WidgetInfo('Navbar1', 'navbar', document.getElementById('Navbar1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_HeaderView', new _WidgetInfo('Header1', 'header', document.getElementById('Header1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogView', new _WidgetInfo('Blog1', 'main', document.getElementById('Blog1'), {'cmtInteractionsEnabled': false, 'lightboxEnabled': true, 'lightboxModuleUrl': 'https://www.blogger.com/static/v1/jsbin/3336188915-lbx.js', 'lightboxCssUrl': 'https://www.blogger.com/static/v1/v-css/368954415-lightbox_bundle.css'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_LinkListView', new _WidgetInfo('LinkList1', 'sidebar-right-1', document.getElementById('LinkList1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_SubscribeView', new _WidgetInfo('Subscribe1', 'sidebar-right-1', document.getElementById('Subscribe1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_FollowersView', new _WidgetInfo('Followers1', 'sidebar-right-2-1', document.getElementById('Followers1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_ProfileView', new _WidgetInfo('Profile1', 'sidebar-right-2-2', document.getElementById('Profile1'), {}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_BlogArchiveView', new _WidgetInfo('BlogArchive1', 'sidebar-right-3', document.getElementById('BlogArchive1'), {'languageDirection': 'ltr', 'loadingMessage': 'Loading\x26hellip;'}, 'displayModeFull'));
_WidgetManager._RegisterWidget('_AttributionView', new _WidgetInfo('Attribution1', 'footer-3', document.getElementById('Attribution1'), {}, 'displayModeFull'));
</script>

<div id="cookieChoiceInfo" class="cookie-choices-info singleton-element"><div class="cookie-choices-inner"><span class="cookie-choices-text">Questo
 sito utilizza cookie di Google per erogare i propri servizi e per 
analizzare il traffico. Il tuo indirizzo IP e il tuo user agent sono 
condivisi con Google, unitamente alle metriche sulle prestazioni e sulla
 sicurezza, per garantire la qualità del servizio, generare statistiche 
di utilizzo e rilevare e contrastare eventuali abusi.</span><span class="cookie-choices-buttons"><a href="https://www.blogger.com/go/blogspot-cookies" target="_blank" class="cookie-choices-button">Ulteriori informazioni</a><a id="cookieChoiceDismiss" href="#" class="cookie-choices-button">OK</a></span></div></div><link type="text/css" rel="stylesheet" href="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/368954415-lightbox_bundle.css"><script type="text/javascript" src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/3336188915-lbx.js"></script><div style="position: absolute; top: -10000px; z-index: 2000000000; border-radius: 4px; overflow: hidden; box-shadow: rgba(0, 0, 0, 0.3) 0px 4px 16px;"><iframe ng-non-bindable="" hspace="0" marginheight="0" marginwidth="0" scrolling="no" style="border: medium none; margin-bottom: -4px;" tabindex="0" vspace="0" id="I1_1603729420119" name="I1_1603729420119" src="The%20304Geeks%20[UPDATED]%20DNS%20Scraping%20for%20Corporate%20AV%20Detection%20-%20%22Admins,%20stop%20sharing%20your%20cache%20with%20everyone!%22_files/card.html" width="100%" frameborder="0"></iframe></div></body></html>