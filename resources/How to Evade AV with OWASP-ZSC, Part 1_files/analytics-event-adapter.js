!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("promote-analytics-adapter",[],n):"object"==typeof exports?exports["promote-analytics-adapter"]=n():e["promote-analytics-adapter"]=n()}("undefined"!=typeof self?self:this,function(){return function(e){var n={};function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(r,o,function(n){return e[n]}.bind(null,o));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="https://static.parastorage.com/services/promote-analytics-adapter/2.517.0/",t.p="undefined"!=typeof window&&window.__STATICS_BASE_URL__||t.p,t(t.s=29)}({1:function(e,n,t){"use strict";t.d(n,"a",function(){return M}),t.d(n,"b",function(){return Y}),t.d(n,"c",function(){return K});var r=function(e,n){var t=Object.keys(e);return 0===t.length?e:t.reduce(function(t,r){var o=n[r];return o&&(e[r]||0===e[r])&&(t[o]=e[r]),t},{})},o=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e};function i(e,n){var t={};for(var r in e)n.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}var c={id:"id",price:"value",value:"value",revenue:"value",name:"content_name",category:"content_category",currency:"currency",content_ids:"content_ids",contents:"contents",type:"content_type",num_items:"num_items",quantity:"quantity",label:"content_name"},a=function(e){var n=e.type,t=void 0===n?"product":n,o=i(e,["type"]),a=Object.assign({},o,{type:t});return a.contents&&(a.contents=a.contents.map(function(e){return e.quantity=e.quantity||1,e.item_price=e.item_price||e.price||0,e}),a.price||a.value||a.revenue||(a.price=function(e){return(Number.parseFloat(e.tax)||0)+(Number.parseFloat(e.shipping)||0)+e.contents.reduce(function(e,n){return e+Number.parseFloat(n.item_price)*n.quantity},0)}(a).toString()),a.currency||(a.currency=function(e){return e.contents&&e.contents[0].currency}(a))),r(a,c)},u=function(e){if(e.contents&&!e.num_items){var n=o({},e);return n.num_items=n.contents.reduce(function(e,n){return e+(n.quantity||1)},0),n}return e},s={ViewContent:function(e){var n=e.id,t=i(e,["id"]);return[["track","ViewContent",o({},a(t),{content_ids:[n],content_type:"product"})]]},AddToCart:function(e){var n=e.id,t=i(e,["id"]);return[["track","AddToCart",o({},a(t),{content_ids:[n],content_type:"product"})]]},InitiateCheckout:function(e){return[["track","InitiateCheckout",o({},a(u(e)),e.contents&&{content_ids:e.contents.map(function(e){return e.id}),content_type:"product"})]]},AddPaymentInfo:function(e){return[["track","AddPaymentInfo",o({},a(u(e)),e.contents&&{content_ids:e.contents.map(function(e){return e.id}),content_type:"product"})]]},Purchase:function(e){return[["track","Purchase",o({},a(u(e)),e.contents&&{content_ids:e.contents.map(function(e){return e.id}),content_type:"product"})]]},Lead:function(e){return[["track","Lead",r(e,c)]]},CustomEvent:function(e){var n=e.event,t=e.eventAction,r=void 0===t?"customEvent":t,o=i(e,["event","eventAction"]);return[["trackCustom",n||r,o]]}},d=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e};var p={price:"price",sku:"id",id:"id",currency:"currency",name:"name",category:"category",brand:"brand",variant:"variant",list:"list",quantity:"quantity",step:"step",option:"option",position:"position",coupon:"coupon",affiliation:"affiliation",revenue:"revenue",tax:"tax",shipping:"shipping"};!function(){for(var e=1;e<=200;e++)p["dimension"+e]="dimension"+e,p["metric"+e]="metric"+e}();var f=function(e){return e?"Enhanced Ecommerce - "+e:"Enhanced Ecommerce"},v={PageView:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.pagePath,t=e.pageTitle;return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).reportToManagedChannels?[["send","pageview",d({page:n},t?{title:t}:{})]]:[]},AddProductImpression:function(e){var n=(e.contents||[]).map(function(e){return["ec:addImpression",r(e,p)]});return[["require","ec"]].concat(n).concat([["send","event",f(e.origin),"Product Impressions",{nonInteraction:!0}]])},ClickProduct:function(e){var n=e.name?e.name:"(not set)",t=e.list?e.list:"(not set)";return[["require","ec"]].concat([["ec:addProduct",r(e,p)]]).concat([["ec:setAction","click",{list:t}]]).concat([["send","event",f(e.origin),"Product Click",n]])},ViewContent:function(e){var n=e.name?e.name:"(not set)";return[["require","ec"]].concat([["ec:addImpression",r(e,p)]]).concat([["ec:setAction","detail"]]).concat([["send","event",f(e.origin),"View Content",n,{nonInteraction:!0}]])},AddToCart:function(e){var n=e.name?e.name:"(not set)";return[["require","ec"]].concat([["ec:addProduct",r(e,p)]]).concat([["ec:setAction","add"]]).concat([["send","event",f(e.origin),"Add to Cart",n]])},RemoveFromCart:function(e){var n=e.name?e.name:"(not set)";return[["require","ec"]].concat([["ec:addProduct",r(e,p)]]).concat([["ec:setAction","remove"]]).concat([["send","event",f(e.origin),"Remove from Cart",n]])},InitiateCheckout:function(e){var n=(e.contents||[]).map(function(e){return["ec:addProduct",r(e,p)]}),t=r({option:e.option},p);return[["require","ec"]].concat(n).concat([["ec:setAction","checkout",t]]).concat([["send","event",f(e.origin),"Initiate Checkout"]])},StartPayment:function(e){var n=r({step:1,option:e.option},p);return[["require","ec"]].concat([["ec:setAction","checkout_option",n]]).concat([["send","event",f(e.origin),"Start Payment"]])},AddPaymentInfo:function(e){var n=r({step:2,option:e.option},p);return[["require","ec"]].concat([["ec:setAction","checkout_option",n]]).concat([["send","event",f(e.origin),"Add Payment Info"]])},CheckoutStep:function(e){var n=r({step:e.step||3,option:e.option},p);return[["require","ec"]].concat([["ec:setAction","checkout_option",n]]).concat([["send","event",f(e.origin),"Checkout Step "+n.step]])},Purchase:function(e){var n=(e.contents||[]).map(function(e){return["ec:addProduct",r(e,p)]}),t={};return["id","affiliation","revenue","tax","shipping","coupon"].forEach(function(n){return e[n]&&(t[n]=e[n])}),[["require","ec"]].concat(n).concat([["ec:setAction","purchase",r(t,p)]]).concat([["send","event",f(e.origin),"Purchase"]])},Lead:function(e){var n=e.category,t=void 0===n?"Leads":n,r=e.action,o=void 0===r?"Submitted":r,i=e.label;return[["send","event",t,o,void 0===i?"New Lead":i]]},CustomEvent:function(e){var n=e.event,t=void 0===n?"customEvent":n,o=e.eventAction,i=function(e,n){var t={};for(var r in e)n.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}(e,["event","eventAction"]);return"pageview"===t.toLowerCase()?[["send","pageview",r(i,p)]]:[["send","event",d({eventAction:o||t},i)]]}},l=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e};function m(e,n){var t={};for(var r in e)n.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}var g={PageView:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.pagePath,t=e.pageTitle;return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).reportToManagedChannels?[[[{event:"Pageview",url:n,title:t}]]]:[]},AddProductImpression:function(e){var n=e.contents,t=e.origin;return[[[l({event:"productImpression"},t&&{origin:t},{ecommerce:{impressions:n}})]]]},ClickProduct:function(e){var n=e.list,t=void 0===n?"(not set)":n,r=e.origin,o=m(e,["list","origin"]);return[[[l({event:"productClick"},r&&{origin:r},{ecommerce:{click:{actionField:{list:t},products:[o]}}})]]]},ViewContent:function(e){var n=e.list,t=void 0===n?"(not set)":n,r=e.origin,o=m(e,["list","origin"]);return[[[l({event:"viewContent"},r&&{origin:r},{ecommerce:{detail:{actionField:{list:t},products:[o]}}})]]]},AddToCart:function(e){var n=e.origin,t=m(e,["origin"]);return[[[l({event:"addToCart"},n&&{origin:n},{ecommerce:{add:{products:[t]}}})]]]},RemoveFromCart:function(e){var n=e.origin,t=m(e,["origin"]);return[[[l({event:"removeFromCart"},n&&{origin:n},{ecommerce:{remove:{products:[t]}}})]]]},InitiateCheckout:function(e){var n=e.contents,t=void 0===n?[]:n,r=e.origin,o=e.option,i=[].concat(t),c=Object.assign({},o&&{option:o});return[[[l({event:"checkout"},r&&{origin:r},{ecommerce:{checkout:{actionField:c,products:i}}})]]]},StartPayment:function(e){var n=e.origin;return[[[l({event:"checkoutOption"},n&&{origin:n},{ecommerce:{checkout_option:{actionField:{step:1}}}})]]]},AddPaymentInfo:function(e){var n=e.origin,t=e.option,r=Object.assign({step:2},t&&{option:t});return[[[l({event:"checkoutOption"},n&&{origin:n},{ecommerce:{checkout_option:{actionField:r}}})]]]},CheckoutStep:function(e){var n=e.step,t=void 0===n?3:n,r=e.origin,o=e.option,i=Object.assign({step:t},o&&{option:o});return[[[l({event:"checkoutOption"},r&&{origin:r},{ecommerce:{checkout_option:{actionField:i}}})]]]},Purchase:function(e){var n=e.contents,t=void 0===n?[]:n,r=e.origin,o=m(e,["contents","origin"]),i=[].concat(t),c={};return["id","affiliation","revenue","tax","shipping","coupon"].forEach(function(e){return o[e]&&(c[e]=o[e])}),[[[l({event:"purchase"},r&&{origin:r},{ecommerce:{purchase:{actionField:c,products:i}}})]]]},Lead:function(){return[[[{event:"lead"}]]]},CustomEvent:function(e){var n=e.event,t=void 0===n?"customEvent":n,r=m(e,["event"]);return[[[l({event:t},r)]]]}},y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return"object"===(void 0===e?"undefined":y(e))&&(e instanceof Number||e instanceof Boolean||e instanceof String?e=e.valueOf():null!==e&&(e=JSON.stringify(e))),e}function A(e){var n=e;return"string"==typeof n&&(n=parseFloat(e)),"number"!=typeof n||isNaN(n)?e:Math.round(1e4*n)}var b={PageView:{table:"page_views",paramsMap:{pageId:"page_id",pageNumber:"page_number"}},AddProductImpression:{},ClickProduct:{},ViewContent:{},AddToCart:{},RemoveFromCart:{},InitiateCheckout:{},AddPaymentInfo:{},Purchase:{},Lead:{name:function(e){return function(e){return e&&(""+e).replace(/\s/g,"")}(e.label)},table:"lead_events"}};function _(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments[4],i={evt:e,evn:n,data:function(e){return Object.keys(e).reduce(function(n,t){return n[t]=h(e[t]),n},{})}(t)};return r.context&&r.context.appDefId&&(i.appId=r.context.appDefId),o&&(i.tbl=o),[[i]]}var C=Object.keys(b).reduce(function(e,n){var t=b[n],r=t.name,o=t.table,i=t.paramsMap;return e[n]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];return"function"==typeof r&&(r=r(e)),i&&(e=Object.keys(i).reduce(function(n,t){return n[i[t]]=e[t],n},{})),function(e,n,t,r){return _("p",e,n,t,r)}(r=r||n,e,t,o)},e},{CustomEvent:function(e,n){var t=e.event,r=e.targetTable;return function(e,n,t,r){return _("c",e,n,t,r)}(t,function(e,n){var t={};for(var r in e)n.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}(e,["event","targetTable"]),n,r)}}),I=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},O={page:["pageId","pageNumber"],product:["id","sku","name","category","price","currency","brand","variant","list","position"],productList:["contents"],payment:["option"],purchase:["id","affiliation","revenue","tax","shipping","coupon","contents"]},P={PageView:{params:{evid:1109},fields:O.page},AddProductImpression:{params:{evid:1100},fields:O.productList},ClickProduct:{params:{evid:1101},fields:O.product},ViewContent:{params:{evid:1102},fields:O.product},AddToCart:{params:{evid:1103},fields:[].concat(O.product,["quantity"])},RemoveFromCart:{params:{evid:1104},fields:[].concat(O.product,["quantity"])},InitiateCheckout:{params:{evid:1105},fields:O.productList},AddPaymentInfo:{params:{evid:1106},fields:O.payment},Purchase:{params:{evid:1107},fields:O.purchase},Lead:{params:{evid:1108},fields:[]}},w={pageId:function(e){return{name:"pid",value:e}},pageNumber:function(e){return{name:"pn",value:e}},price:function(e){return{name:"price",value:A(e)}},revenue:function(e){return{name:"revenue",value:A(e)}},tax:function(e){return{name:"tax",value:A(e)}},shipping:function(e){return{name:"shipping",value:A(e)}}};var k=Object.keys(P).reduce(function(e,n){return e[n]=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=I({src:76},P[n].params,function(e,n){return e.reduce(function(e,t){var r=function(e,n,t){return"function"==typeof e[n]?e[n](t):{name:n,value:t}}(w,t,n[t]),o=r.name,i=r.value;return e[o]=h(i),e},{})}(P[n].fields,e));return t.context&&t.context.appDefId&&(r.appId=t.context.appDefId),[[r]]},e},{});var E={GA_TRACKING_ID:"GA_TRACKING_ID",pagePath:"page_path",pageTitle:"page_title"};!function(){for(var e=1;e<=200;e++)E["dimension"+e]="dimension"+e,E["metric"+e]="metric"+e}();var x,T,j={PageView:function(e,n){var t=n.config,o=e.GA_TRACKING_ID,i=function(e,n){var t={};for(var r in e)n.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}(e,["GA_TRACKING_ID"]);return[["config",o||t.trackingId,r(i,E)]]}},S=[],L={PageView:function(e){var n=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).context;return n&&n.isFirstVisit?S:[[]]}},N={},G=void 0,R=void 0,V=function(e){return{isPremium:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.isPremium,t=e.isPremiumDomain,r=e.isPremiumUser;return n&&n()||t&&t()||r&&r()}(e),userId:e.getUserId(),metaSiteId:e.getMetaSiteId()}},D=function(e,n){(function(e,n){return Object.prototype.hasOwnProperty.call(e,n)})(N,e)||(N[e]=n)},F=function(e,n){Object.keys(N).forEach(function(t){N[t].call(void 0,e,function(e){return Object.assign({},e,R)}(n))})},q=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};G&&G(e,n)};var M={FACEBOOK_PIXEL:"facebookPixel",GOOGLE_ANALYTICS:"googleAnalytics",GOOGLE_TAG_MANAGER:"googleTagManager",WIX_ANALYTICS:"wixAnalytics",BI_ANALYTICS:"biAnalytics",GTAG:"gtag",VK_RETARGETING:"vkRetargeting",YANDEX_METRICA:"yandexMetrica",WIX_DEVELOPERS_ANALYTICS:"wix-developers-analytics"},Y=((x={})[M.FACEBOOK_PIXEL]=s,x[M.GOOGLE_ANALYTICS]=v,x[M.GOOGLE_TAG_MANAGER]=g,x[M.WIX_ANALYTICS]=C,x[M.BI_ANALYTICS]=k,x[M.GTAG]=j,x[M.VK_RETARGETING]={PageView:function(){return[[]]}},x[M.YANDEX_METRICA]=L,x),K=((T={})[M.WIX_DEVELOPERS_ANALYTICS]=function(e,n){if(e){if(window){window.wixDevelopersAnalytics=window.wixDevelopersAnalytics||{register:D,triggerEvent:q},"function"==typeof window.onWixDevelopersAnalyticsReady&&window.onWixDevelopersAnalyticsReady();try{window.dispatchEvent(new Event("wixDevelopersAnalyticsReady"))}catch(e){}}return G=e,R=V(n),F}},T)},29:function(e,n,t){"use strict";t.r(n);var r=t(3);t.d(n,"api",function(){return r});var o=t(1);t.d(n,"channelNames",function(){return o.a}),t.d(n,"listeners",function(){return o.c})},3:function(e,n,t){"use strict";t.r(n),t.d(n,"init",function(){return a}),t.d(n,"addListener",function(){return u}),t.d(n,"trackEvent",function(){return s});var r=function(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments[3],o=t.appDefId,i=function(e,n){var t={};for(var r in e)n.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}(t,["appDefId"]);return n.events?((r=r||{}).config=n.config,r.context=r.context||{},"boolean"==typeof r.context&&(r.context={isFirstVisit:r.context}),r.context.appDefId=r.context.appDefId||o,n.events[e]?n.events[e](i,r):[]):[[e,i].concat(r?[r]:[])]},o=function(e,n,t,o){e.forEach(function(e){r(n,e,t,o).forEach(function(n){return e.report.apply(e,n)})})},i=t(1);var c=new(function(){function e(){var n=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),this._channels=[],this._listeners=[],this.addChannel=function(e){n.isChannelAlreadyInit(e)||(n.isChannelPredefined(e)?n.populateChannelEvents(e):n.registerChannel(e),n.isChannelValid(e)&&n._channels.push(e))},this.addListener=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Array.isArray(e)&&e.forEach(function(e){if(n.isListenerInitializerValid(e)){var r=e(n.trackEvent,t);r&&n._listeners.push(r)}})},this.trackEvent=function(e,t,r){var i=n.getReporters();o(i,e,t,r)},this.getReporters=function(){var e=n._listeners.map(function(e){return{report:e}});return[].concat(e,n._channels)},this.isChannelAlreadyInit=function(e){return n._channels.some(function(n){return n.name===e.name})},this.isListenerInitializerValid=function(e){return e&&e instanceof Function},t.forEach(this.addChannel)}return e.prototype.isChannelPredefined=function(e){return i.b[e.name]},e.prototype.populateChannelEvents=function(e){e.events=i.b[e.name],e.events.publicTracking&&e.events.publicTracking instanceof Function&&e.events.publicTracking()},e.prototype.isChannelValid=function(e){var n=e.name,t=e.report,r=e.events&&Object.values(e.events).every(function(e){return"function"==typeof e});return n&&t&&r},e.prototype.registerChannel=function(e){this.isChannelValid(e)&&(i.b[e.name]=e.events)},e}()),a=function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach(c.addChannel)},u=function(e,n){c.addListener(e,n)},s=function(e,n,t){c.trackEvent(e,n,t)}}})});
//# sourceMappingURL=analytics-event-adapter.bundle.min.js.map